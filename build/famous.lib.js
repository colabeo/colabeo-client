/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/

/* Zepto v1.0-1-ga3cab6c - polyfill zepto detect event ajax form fx - zeptojs.com/license */

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*!

 handlebars v1.1.2

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

/*! peerjs.min.js build:0.3.7, production. Copyright(c) 2013 Michelle Bu <michelle@michellebu.com> */

/*!
 * jQuery OAuth via popup window plugin
 *
 * @author  Nobu Funaki @nobuf
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */

!function(t,e){if("function"==typeof define&&define.amd)define(e);else if("object"==typeof window){var i;window.addEventListener("load",function(){t.Famous=e(),i&&t.Famous(i)}),t.Famous=function(t){i=t}}else t.Famous=e()}(this,function(){var requirejs,require,define;!function(t){function e(t,e){return g.call(t,e)}function i(t,e){var i,n,o,s,r,a,u,c,h,l,p=e&&e.split("/"),f=m.map,d=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),c=0;c<t.length;c+=1)if(l=t[c],"."===l)t.splice(c,1),c-=1;else if(".."===l){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||d)&&f){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),p)for(h=p.length;h>0;h-=1)if(o=f[p.slice(0,h).join("/")],o&&(o=o[n])){s=o,r=c;break}if(s)break;!a&&d&&d[n]&&(a=d[n],u=c)}!s&&a&&(s=a,r=u),s&&(i.splice(0,r,s),t=i.join("/"))}return t}function n(e,i){return function(){return h.apply(t,y.call(arguments,0).concat([e,i]))}}function o(t){return function(e){return i(e,t)}}function s(t){return function(e){f[t]=e}}function r(i){if(e(d,i)){var n=d[i];delete d[i],v[i]=!0,c.apply(t,n)}if(!e(f,i)&&!e(v,i))throw new Error("No "+i);return f[i]}function a(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function u(t){return function(){return m&&m.config&&m.config[t]||{}}}var c,h,l,p,f={},d={},m={},v={},g=Object.prototype.hasOwnProperty,y=[].slice;l=function(t,e){var n,s=a(t),u=s[0];return t=s[1],u&&(u=i(u,e),n=r(u)),u?t=n&&n.normalize?n.normalize(t,o(e)):i(t,e):(t=i(t,e),s=a(t),u=s[0],t=s[1],u&&(n=r(u))),{f:u?u+"!"+t:t,n:t,pr:u,p:n}},p={require:function(t){return n(t)},exports:function(t){var e=f[t];return"undefined"!=typeof e?e:f[t]={}},module:function(t){return{id:t,uri:"",exports:f[t],config:u(t)}}},c=function(i,o,a,u){var c,h,m,g,y,b,w=[];if(u=u||i,"function"==typeof a){for(o=!o.length&&a.length?["require","exports","module"]:o,y=0;y<o.length;y+=1)if(g=l(o[y],u),h=g.f,"require"===h)w[y]=p.require(i);else if("exports"===h)w[y]=p.exports(i),b=!0;else if("module"===h)c=w[y]=p.module(i);else if(e(f,h)||e(d,h)||e(v,h))w[y]=r(h);else{if(!g.p)throw new Error(i+" missing "+h);g.p.load(g.n,n(u,!0),s(h),{}),w[y]=f[h]}m=a.apply(f[i],w),i&&(c&&c.exports!==t&&c.exports!==f[i]?f[i]=c.exports:m===t&&b||(f[i]=m))}else i&&(f[i]=a)},requirejs=require=h=function(e,i,n,o,s){return"string"==typeof e?p[e]?p[e](i):r(l(e,i).f):(e.splice||(m=e,i.splice?(e=i,i=n,n=null):e=t),i=i||function(){},"function"==typeof n&&(n=o,o=s),o?c(t,e,i,n):setTimeout(function(){c(t,e,i,n)},4),h)},h.config=function(t){return m=t,m.deps&&h(m.deps,m.callback),h},requirejs._defined=f,define=function(t,i,n){i.splice||(n=i,i=[]),e(f,t)||e(d,t)||(d[t]=[t,i,n])},define.amd={jQuery:!0}}(),define("lib/almond",function(){}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),define("lib/functionPrototypeBind",function(){}),"undefined"==typeof document||"classList"in document.createElement("a")||!function(t){var e="classList",i="prototype",n=(t.HTMLElement||t.Element)[i],o=Object,s=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array[i].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},u=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(t,e)},c=function(t){for(var e=s.call(t.className),i=e?e.split(/\s+/):[],n=0,o=i.length;o>n;n++)this.push(i[n]);this._updateClassName=function(){t.className=this.toString()}},h=c[i]=[],l=function(){return new c(this)};if(a[i]=Error[i],h.item=function(t){return this[t]||null},h.contains=function(t){return t+="",-1!==u(this,t)},h.add=function(t){t+="",-1===u(this,t)&&(this.push(t),this._updateClassName())},h.remove=function(t){t+="";var e=u(this,t);-1!==e&&(this.splice(e,1),this._updateClassName())},h.toggle=function(t){t+="",-1===u(this,t)?this.add(t):this.remove(t)},h.toString=function(){return this.join(" ")},o.defineProperty){var p={get:l,enumerable:!0,configurable:!0};try{o.defineProperty(n,e,p)}catch(f){-2146823252===f.number&&(p.enumerable=!1,o.defineProperty(n,e,p))}}else o[i].__defineGetter__&&n.__defineGetter__(e,l)}(self),define("lib/classList",function(){}),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t(+new Date)},1e3/60)}),define("lib/requestAnimationFrame",function(){}),function(t){String.prototype.trim===t&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===t&&(Array.prototype.reduce=function(e){if(void 0===this||null===this)throw new TypeError;var i,n=Object(this),o=n.length>>>0,s=0;if("function"!=typeof e)throw new TypeError;if(0==o&&1==arguments.length)throw new TypeError;if(arguments.length>=2)i=arguments[1];else for(;;){if(s in n){i=n[s++];break}if(++s>=o)throw new TypeError}for(;o>s;)s in n&&(i=e.call(t,i,n[s],s,n)),s++;return i})}();var Zepto=function(){function t(t){return null==t?String(t):Y[J.call(t)]||"object"}function e(e){return"function"==t(e)}function i(t){return null!=t&&t==t.window}function n(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function o(e){return"object"==t(e)}function s(t){return o(t)&&!i(t)&&t.__proto__==Object.prototype}function r(t){return t instanceof Array}function a(t){return"number"==typeof t.length}function u(t){return M.call(t,function(t){return null!=t})}function c(t){return t.length>0?C.fn.concat.apply([],t):t}function h(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(t){return t in F?F[t]:F[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function p(t,e){return"number"!=typeof e||R[h(t)]?e:e+"px"}function f(t){var e,i;return A[t]||(e=z.createElement(t),z.body.appendChild(e),i=P(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),A[t]=i),A[t]}function d(t){return"children"in t?I.call(t.children):C.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function m(t,e,i){for(x in e)i&&(s(e[x])||r(e[x]))?(s(e[x])&&!s(t[x])&&(t[x]={}),r(e[x])&&!r(t[x])&&(t[x]=[]),m(t[x],e[x],i)):e[x]!==_&&(t[x]=e[x])}function v(t,e){return e===_?C(t):C(t).filter(e)}function g(t,i,n,o){return e(i)?i.call(t,n,o):i}function y(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function b(t,e){var i=t.className,n=i&&i.baseVal!==_;return e===_?n?i.baseVal:i:(n?i.baseVal=e:t.className=e,void 0)}function w(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:isNaN(e=Number(t))?/^[\[\{]/.test(t)?C.parseJSON(t):t:e):t}catch(i){return t}}function S(t,e){e(t);for(var i in t.childNodes)S(t.childNodes[i],e)}var _,x,C,O,T,k,E=[],I=E.slice,M=E.filter,z=window.document,A={},F={},P=z.defaultView.getComputedStyle,R={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},N=/^\s*<(\w+|!)[^>]*>/,D=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,L=/^(?:body|html)$/i,B=["val","css","html","text","data","width","height","offset"],H=["after","prepend","before","append"],j=z.createElement("table"),V=z.createElement("tr"),U={tr:z.createElement("tbody"),tbody:j,thead:j,tfoot:j,td:V,th:V,"*":z.createElement("div")},q=/complete|loaded|interactive/,W=/^\.([\w-]+)$/,$=/^#([\w-]*)$/,X=/^[\w-]+$/,Y={},J=Y.toString,G={},Z=z.createElement("div");return G.matches=function(t,e){if(!t||1!==t.nodeType)return!1;var i=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var n,o=t.parentNode,s=!o;return s&&(o=Z).appendChild(t),n=~G.qsa(o,e).indexOf(t),s&&Z.removeChild(t),n},T=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},k=function(t){return M.call(t,function(e,i){return t.indexOf(e)==i})},G.fragment=function(t,e,i){t.replace&&(t=t.replace(D,"<$1></$2>")),e===_&&(e=N.test(t)&&RegExp.$1),e in U||(e="*");var n,o,r=U[e];return r.innerHTML=""+t,o=C.each(I.call(r.childNodes),function(){r.removeChild(this)}),s(i)&&(n=C(o),C.each(i,function(t,e){B.indexOf(t)>-1?n[t](e):n.attr(t,e)})),o},G.Z=function(t,e){return t=t||[],t.__proto__=C.fn,t.selector=e||"",t},G.isZ=function(t){return t instanceof G.Z},G.init=function(t,i){if(!t)return G.Z();if(e(t))return C(z).ready(t);if(G.isZ(t))return t;var n;if(r(t))n=u(t);else if(o(t))n=[s(t)?C.extend({},t):t],t=null;else if(N.test(t))n=G.fragment(t.trim(),RegExp.$1,i),t=null;else{if(i!==_)return C(i).find(t);n=G.qsa(z,t)}return G.Z(n,t)},C=function(t,e){return G.init(t,e)},C.extend=function(t){var e,i=I.call(arguments,1);return"boolean"==typeof t&&(e=t,t=i.shift()),i.forEach(function(i){m(t,i,e)}),t},G.qsa=function(t,e){var i;return n(t)&&$.test(e)?(i=t.getElementById(RegExp.$1))?[i]:[]:1!==t.nodeType&&9!==t.nodeType?[]:I.call(W.test(e)?t.getElementsByClassName(RegExp.$1):X.test(e)?t.getElementsByTagName(e):t.querySelectorAll(e))},C.contains=function(t,e){return t!==e&&t.contains(e)},C.type=t,C.isFunction=e,C.isWindow=i,C.isArray=r,C.isPlainObject=s,C.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},C.inArray=function(t,e,i){return E.indexOf.call(e,t,i)},C.camelCase=T,C.trim=function(t){return t.trim()},C.uuid=0,C.support={},C.expr={},C.map=function(t,e){var i,n,o,s=[];if(a(t))for(n=0;n<t.length;n++)i=e(t[n],n),null!=i&&s.push(i);else for(o in t)i=e(t[o],o),null!=i&&s.push(i);return c(s)},C.each=function(t,e){var i,n;if(a(t)){for(i=0;i<t.length;i++)if(e.call(t[i],i,t[i])===!1)return t}else for(n in t)if(e.call(t[n],n,t[n])===!1)return t;return t},C.grep=function(t,e){return M.call(t,e)},window.JSON&&(C.parseJSON=JSON.parse),C.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Y["[object "+e+"]"]=e.toLowerCase()}),C.fn={forEach:E.forEach,reduce:E.reduce,push:E.push,sort:E.sort,indexOf:E.indexOf,concat:E.concat,map:function(t){return C(C.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return C(I.apply(this,arguments))},ready:function(t){return q.test(z.readyState)?t(C):z.addEventListener("DOMContentLoaded",function(){t(C)},!1),this},get:function(t){return t===_?I.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return E.every.call(this,function(e,i){return t.call(e,i,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):C(M.call(this,function(e){return G.matches(e,t)}))},add:function(t,e){return C(k(this.concat(C(t,e))))},is:function(t){return this.length>0&&G.matches(this[0],t)},not:function(t){var i=[];if(e(t)&&t.call!==_)this.each(function(e){t.call(this,e)||i.push(this)});else{var n="string"==typeof t?this.filter(t):a(t)&&e(t.item)?I.call(t):C(t);this.forEach(function(t){n.indexOf(t)<0&&i.push(t)})}return C(i)},has:function(t){return this.filter(function(){return o(t)?C.contains(this,t):C(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!o(t)?t:C(t)},last:function(){var t=this[this.length-1];return t&&!o(t)?t:C(t)},find:function(t){var e,i=this;return e="object"==typeof t?C(t).filter(function(){var t=this;return E.some.call(i,function(e){return C.contains(e,t)})}):1==this.length?C(G.qsa(this[0],t)):this.map(function(){return G.qsa(this,t)})},closest:function(t,e){var i=this[0],o=!1;for("object"==typeof t&&(o=C(t));i&&!(o?o.indexOf(i)>=0:G.matches(i,t));)i=i!==e&&!n(i)&&i.parentNode;return C(i)},parents:function(t){for(var e=[],i=this;i.length>0;)i=C.map(i,function(t){return(t=t.parentNode)&&!n(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return v(e,t)},parent:function(t){return v(k(this.pluck("parentNode")),t)},children:function(t){return v(this.map(function(){return d(this)}),t)},contents:function(){return this.map(function(){return I.call(this.childNodes)})},siblings:function(t){return v(this.map(function(t,e){return M.call(d(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return C.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null),"none"==P(this,"").getPropertyValue("display")&&(this.style.display=f(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var i=e(t);if(this[0]&&!i)var n=C(t).get(0),o=n.parentNode||this.length>1;return this.each(function(e){C(this).wrapAll(i?t.call(this,e):o?n.cloneNode(!0):n)})},wrapAll:function(t){if(this[0]){C(this[0]).before(t=C(t));for(var e;(e=t.children()).length;)t=e.first();C(t).append(this)}return this},wrapInner:function(t){var i=e(t);return this.each(function(e){var n=C(this),o=n.contents(),s=i?t.call(this,e):t;o.length?o.wrapAll(s):n.append(s)})},unwrap:function(){return this.parent().each(function(){C(this).replaceWith(C(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=C(this);(t===_?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return C(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return C(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return t===_?this.length>0?this[0].innerHTML:null:this.each(function(e){var i=this.innerHTML;C(this).empty().append(g(this,t,e,i))})},text:function(t){return t===_?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(t,e){var i;return"string"==typeof t&&e===_?0==this.length||1!==this[0].nodeType?_:"value"==t&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(t))&&t in this[0]?this[0][t]:i:this.each(function(i){if(1===this.nodeType)if(o(t))for(x in t)y(this,x,t[x]);else y(this,t,g(this,e,i,this.getAttribute(t)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&y(this,t)})},prop:function(t,e){return e===_?this[0]&&this[0][t]:this.each(function(i){this[t]=g(this,e,i,this[t])})},data:function(t,e){var i=this.attr("data-"+h(t),e);return null!==i?w(i):_},val:function(t){return t===_?this[0]&&(this[0].multiple?C(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=g(this,t,e,this.value)})},offset:function(t){if(t)return this.each(function(e){var i=C(this),n=g(this,t,e,i.offset()),o=i.offsetParent().offset(),s={top:n.top-o.top,left:n.left-o.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(0==this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,i){if(arguments.length<2&&"string"==typeof e)return this[0]&&(this[0].style[T(e)]||P(this[0],"").getPropertyValue(e));var n="";if("string"==t(e))i||0===i?n=h(e)+":"+p(e,i):this.each(function(){this.style.removeProperty(h(e))});else for(x in e)e[x]||0===e[x]?n+=h(x)+":"+p(x,e[x])+";":this.each(function(){this.style.removeProperty(h(x))});return this.each(function(){this.style.cssText+=";"+n})},index:function(t){return t?this.indexOf(C(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return E.some.call(this,function(t){return this.test(b(t))},l(t))},addClass:function(t){return this.each(function(e){O=[];var i=b(this),n=g(this,t,e,i);n.split(/\s+/g).forEach(function(t){C(this).hasClass(t)||O.push(t)},this),O.length&&b(this,i+(i?" ":"")+O.join(" "))})},removeClass:function(t){return this.each(function(e){return t===_?b(this,""):(O=b(this),g(this,t,e,O).split(/\s+/g).forEach(function(t){O=O.replace(l(t)," ")}),b(this,O.trim()),void 0)})},toggleClass:function(t,e){return this.each(function(i){var n=C(this),o=g(this,t,i,b(this));o.split(/\s+/g).forEach(function(t){(e===_?!n.hasClass(t):e)?n.addClass(t):n.removeClass(t)})})},scrollTop:function(){return this.length?"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY:void 0},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),n=L.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(C(t).css("margin-top"))||0,i.left-=parseFloat(C(t).css("margin-left"))||0,n.top+=parseFloat(C(e[0]).css("border-top-width"))||0,n.left+=parseFloat(C(e[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||z.body;t&&!L.test(t.nodeName)&&"static"==C(t).css("position");)t=t.offsetParent;return t})}},C.fn.detach=C.fn.remove,["width","height"].forEach(function(t){C.fn[t]=function(e){var o,s=this[0],r=t.replace(/./,function(t){return t[0].toUpperCase()});return e===_?i(s)?s["inner"+r]:n(s)?s.documentElement["offset"+r]:(o=this.offset())&&o[t]:this.each(function(i){s=C(this),s.css(t,g(this,e,i,s[t]()))})}}),H.forEach(function(e,i){var n=i%2;C.fn[e]=function(){var e,o,s=C.map(arguments,function(i){return e=t(i),"object"==e||"array"==e||null==i?i:G.fragment(i)}),r=this.length>1;return s.length<1?this:this.each(function(t,e){o=n?e:e.parentNode,e=0==i?e.nextSibling:1==i?e.firstChild:2==i?e:null,s.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!o)return C(t).remove();S(o.insertBefore(t,e),function(t){null!=t.nodeName&&"SCRIPT"===t.nodeName.toUpperCase()&&(!t.type||"text/javascript"===t.type)&&!t.src&&window.eval.call(window,t.innerHTML)})})})},C.fn[n?e+"To":"insert"+(i?"Before":"After")]=function(t){return C(t)[e](this),this}}),G.Z.prototype=C.fn,G.uniq=k,G.deserializeValue=w,C.zepto=G,C}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(t){function e(t){var e=this.os={},i=this.browser={},n=t.match(/WebKit\/([\d.]+)/),o=t.match(/(Android)\s+([\d.]+)/),s=t.match(/(iPad).*OS\s([\d_]+)/),r=!s&&t.match(/(iPhone\sOS)\s([\d_]+)/),a=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),u=a&&t.match(/TouchPad/),c=t.match(/Kindle\/([\d.]+)/),h=t.match(/Silk\/([\d._]+)/),l=t.match(/(BlackBerry).*Version\/([\d.]+)/),p=t.match(/(BB10).*Version\/([\d.]+)/),f=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=t.match(/PlayBook/),m=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),v=t.match(/Firefox\/([\d.]+)/);(i.webkit=!!n)&&(i.version=n[1]),o&&(e.android=!0,e.version=o[2]),r&&(e.ios=e.iphone=!0,e.version=r[2].replace(/_/g,".")),s&&(e.ios=e.ipad=!0,e.version=s[2].replace(/_/g,".")),a&&(e.webos=!0,e.version=a[2]),u&&(e.touchpad=!0),l&&(e.blackberry=!0,e.version=l[2]),p&&(e.bb10=!0,e.version=p[2]),f&&(e.rimtabletos=!0,e.version=f[2]),d&&(i.playbook=!0),c&&(e.kindle=!0,e.version=c[1]),h&&(i.silk=!0,i.version=h[1]),!h&&e.android&&t.match(/Kindle Fire/)&&(i.silk=!0),m&&(i.chrome=!0,i.version=m[1]),v&&(i.firefox=!0,i.version=v[1]),e.tablet=!!(s||d||o&&!t.match(/Mobile/)||v&&t.match(/Tablet/)),e.phone=!e.tablet&&!!(o||r||a||l||p||m&&t.match(/Android/)||m&&t.match(/CriOS\/([\d.]+)/)||v&&t.match(/Mobile/))}e.call(t,navigator.userAgent),t.__detect=e}(Zepto),function(t){function e(t){return t._zid||(t._zid=f++)}function i(t,i,s,r){if(i=n(i),i.ns)var a=o(i.ns);return(p[e(t)]||[]).filter(function(t){return!(!t||i.e&&t.e!=i.e||i.ns&&!a.test(t.ns)||s&&e(t.fn)!==e(s)||r&&t.sel!=r)})}function n(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function o(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function s(e,i,n){"string"!=t.type(e)?t.each(e,n):e.split(/\s/).forEach(function(t){n(t,i)})}function r(t,e){return t.del&&("focus"==t.e||"blur"==t.e)||!!e}function a(t){return m[t]||t}function u(i,o,u,c,h,l){var f=e(i),d=p[f]||(p[f]=[]);s(o,u,function(e,o){var s=n(e);s.fn=o,s.sel=c,s.e in m&&(o=function(e){var i=e.relatedTarget;return!i||i!==this&&!t.contains(this,i)?s.fn.apply(this,arguments):void 0}),s.del=h&&h(o,e);var u=s.del||o;s.proxy=function(t){var e=u.apply(i,[t].concat(t.data));return e===!1&&(t.preventDefault(),t.stopPropagation()),e},s.i=d.length,d.push(s),i.addEventListener(a(s.e),s.proxy,r(s,l))})}function c(t,n,o,u,c){var h=e(t);s(n||"",o,function(e,n){i(t,e,n,u).forEach(function(e){delete p[h][e.i],t.removeEventListener(a(e.e),e.proxy,r(e,c))})})}function h(e){var i,n={originalEvent:e};for(i in e)!y.test(i)&&void 0!==e[i]&&(n[i]=e[i]);return t.each(b,function(t,i){n[t]=function(){return this[i]=v,e[t].apply(e,arguments)},n[i]=g}),n}function l(t){if(!("defaultPrevented"in t)){t.defaultPrevented=!1;var e=t.preventDefault;t.preventDefault=function(){this.defaultPrevented=!0,e.call(this)}}}var p=(t.zepto.qsa,{}),f=1,d={},m={mouseenter:"mouseover",mouseleave:"mouseout"};d.click=d.mousedown=d.mouseup=d.mousemove="MouseEvents",t.event={add:u,remove:c},t.proxy=function(i,n){if(t.isFunction(i)){var o=function(){return i.apply(n,arguments)};return o._zid=e(i),o}if("string"==typeof n)return t.proxy(i[n],i);throw new TypeError("expected function")},t.fn.bind=function(t,e){return this.each(function(){u(this,t,e)})},t.fn.unbind=function(t,e){return this.each(function(){c(this,t,e)})},t.fn.one=function(t,e){return this.each(function(i,n){u(this,t,e,null,function(t,e){return function(){var i=t.apply(n,arguments);return c(n,e,t),i}})})};var v=function(){return!0},g=function(){return!1},y=/^([A-Z]|layer[XY]$)/,b={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,i,n){return this.each(function(o,s){u(s,i,n,e,function(i){return function(n){var o,r=t(n.target).closest(e,s).get(0);return r?(o=t.extend(h(n),{currentTarget:r,liveFired:s}),i.apply(r,[o].concat([].slice.call(arguments,1)))):void 0}})})},t.fn.undelegate=function(t,e,i){return this.each(function(){c(this,e,i,t)})},t.fn.live=function(e,i){return t(document.body).delegate(this.selector,e,i),this},t.fn.die=function(e,i){return t(document.body).undelegate(this.selector,e,i),this},t.fn.on=function(e,i,n){return!i||t.isFunction(i)?this.bind(e,i||n):this.delegate(i,e,n)},t.fn.off=function(e,i,n){return!i||t.isFunction(i)?this.unbind(e,i||n):this.undelegate(i,e,n)},t.fn.trigger=function(e,i){return("string"==typeof e||t.isPlainObject(e))&&(e=t.Event(e)),l(e),e.data=i,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(e)})},t.fn.triggerHandler=function(e,n){var o,s;return this.each(function(r,a){o=h("string"==typeof e?t.Event(e):e),o.data=n,o.target=a,t.each(i(a,e.type||e),function(t,e){return s=e.proxy(o),o.isImmediatePropagationStopped()?!1:void 0})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){"string"!=typeof t&&(e=t,t=e.type);var i=document.createEvent(d[t]||"Events"),n=!0;if(e)for(var o in e)"bubbles"==o?n=!!e[o]:i[o]=e[o];return i.initEvent(t,n,!0,null,null,null,null,null,null,null,null,null,null,null,null),i.isDefaultPrevented=function(){return this.defaultPrevented},i}}(Zepto),function(t){function e(e,i,n){var o=t.Event(i);return t(e).trigger(o,n),!o.defaultPrevented}function i(t,i,n,o){return t.global?e(i||y,n,o):void 0}function n(e){e.global&&0===t.active++&&i(e,null,"ajaxStart")}function o(e){e.global&&!--t.active&&i(e,null,"ajaxStop")}function s(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||i(e,n,"ajaxBeforeSend",[t,e])===!1?!1:(i(e,n,"ajaxSend",[t,e]),void 0)}function r(t,e,n){var o=n.context,s="success";n.success.call(o,t,s,e),i(n,o,"ajaxSuccess",[e,n,t]),u(s,e,n)}function a(t,e,n,o){var s=o.context;o.error.call(s,n,e,t),i(o,s,"ajaxError",[n,o,t]),u(e,n,o)}function u(t,e,n){var s=n.context;n.complete.call(s,e,t),i(n,s,"ajaxComplete",[e,n]),o(n)}function c(){}function h(t){return t&&(t=t.split(";",2)[0]),t&&(t==x?"html":t==_?"json":w.test(t)?"script":S.test(t)&&"xml")||"text"}function l(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function p(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),e.data&&(!e.type||"GET"==e.type.toUpperCase())&&(e.url=l(e.url,e.data))}function f(e,i,n,o){var s=!t.isFunction(i);return{url:e,data:s?i:void 0,success:s?t.isFunction(n)?n:void 0:i,dataType:s?o||n:n}}function d(e,i,n,o){var s,r=t.isArray(i);t.each(i,function(i,a){s=t.type(a),o&&(i=n?o:o+"["+(r?"":i)+"]"),!o&&r?e.add(a.name,a.value):"array"==s||!n&&"object"==s?d(e,a,n,i):e.add(i,a)})}var m,v,g=0,y=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,w=/^(?:text|application)\/javascript/i,S=/^(?:text|application)\/xml/i,_="application/json",x="text/html",C=/^\s*$/;t.active=0,t.ajaxJSONP=function(e){if("type"in e){var i,n="jsonp"+ ++g,o=y.createElement("script"),u=function(){clearTimeout(i),t(o).remove(),delete window[n]},h=function(t){u(),t&&"timeout"!=t||(window[n]=c),a(null,t||"abort",l,e)},l={abort:h};return s(l,e)===!1?(h("abort"),!1):(window[n]=function(t){u(),r(t,l,e)},o.onerror=function(){h("error")},o.src=e.url.replace(/=\?/,"="+n),t("head").append(o),e.timeout>0&&(i=setTimeout(function(){h("timeout")},e.timeout)),l)}return t.ajax(e)},t.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:_,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var i=t.extend({},e||{});for(m in t.ajaxSettings)void 0===i[m]&&(i[m]=t.ajaxSettings[m]);n(i),i.crossDomain||(i.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(i.url)&&RegExp.$2!=window.location.host),i.url||(i.url=window.location.toString()),p(i),i.cache===!1&&(i.url=l(i.url,"_="+Date.now()));var o=i.dataType,u=/=\?/.test(i.url);if("jsonp"==o||u)return u||(i.url=l(i.url,"callback=?")),t.ajaxJSONP(i);var f,d=i.accepts[o],g={},y=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,b=i.xhr();i.crossDomain||(g["X-Requested-With"]="XMLHttpRequest"),d&&(g.Accept=d,d.indexOf(",")>-1&&(d=d.split(",",2)[0]),b.overrideMimeType&&b.overrideMimeType(d)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&(g["Content-Type"]=i.contentType||"application/x-www-form-urlencoded"),i.headers=t.extend(g,i.headers||{}),b.onreadystatechange=function(){if(4==b.readyState){b.onreadystatechange=c,clearTimeout(f);var e,n=!1;if(b.status>=200&&b.status<300||304==b.status||0==b.status&&"file:"==y){o=o||h(b.getResponseHeader("content-type")),e=b.responseText;try{"script"==o?(1,eval)(e):"xml"==o?e=b.responseXML:"json"==o&&(e=C.test(e)?null:t.parseJSON(e))}catch(s){n=s}n?a(n,"parsererror",b,i):r(e,b,i)}else a(null,b.status?"error":"abort",b,i)}};var w="async"in i?i.async:!0;b.open(i.type,i.url,w);for(v in i.headers)b.setRequestHeader(v,i.headers[v]);return s(b,i)===!1?(b.abort(),!1):(i.timeout>0&&(f=setTimeout(function(){b.onreadystatechange=c,b.abort(),a(null,"timeout",b,i)},i.timeout)),b.send(i.data?i.data:null),b)},t.get=function(){return t.ajax(f.apply(null,arguments))},t.post=function(){var e=f.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=f.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,i,n){if(!this.length)return this;var o,s=this,r=e.split(/\s/),a=f(e,i,n),u=a.success;return r.length>1&&(a.url=r[0],o=r[1]),a.success=function(e){s.html(o?t("<div>").html(e.replace(b,"")).find(o):e),u&&u.apply(s,arguments)},t.ajax(a),this};var O=encodeURIComponent;t.param=function(t,e){var i=[];return i.add=function(t,e){this.push(O(t)+"="+O(e))},d(i,t,e),i.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,i=[];return t(Array.prototype.slice.call(this.get(0).elements)).each(function(){e=t(this);var n=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&("radio"!=n&&"checkbox"!=n||this.checked)&&i.push({name:e.attr("name"),value:e.val()})}),i},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(t,e){function i(t){return n(t.replace(/([a-z])([A-Z])/,"$1-$2"))}function n(t){return t.toLowerCase()}function o(t){return s?s+t:n(t)}var s,r,a,u,c,h,l,p,f="",d={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},m=window.document,v=m.createElement("div"),g=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,y={};t.each(d,function(t,i){return v.style[t+"TransitionProperty"]!==e?(f="-"+n(t)+"-",s=i,!1):void 0}),r=f+"transform",y[a=f+"transition-property"]=y[u=f+"transition-duration"]=y[c=f+"transition-timing-function"]=y[h=f+"animation-name"]=y[l=f+"animation-duration"]=y[p=f+"animation-timing-function"]="",t.fx={off:s===e&&v.style.transitionProperty===e,speeds:{_default:400,fast:200,slow:600},cssPrefix:f,transitionEnd:o("TransitionEnd"),animationEnd:o("AnimationEnd")},t.fn.animate=function(e,i,n,o){return t.isPlainObject(i)&&(n=i.easing,o=i.complete,i=i.duration),i&&(i=("number"==typeof i?i:t.fx.speeds[i]||t.fx.speeds._default)/1e3),this.anim(e,i,n,o)},t.fn.anim=function(n,o,s,f){var d,m,v,b={},w="",S=this,_=t.fx.transitionEnd;if(o===e&&(o=.4),t.fx.off&&(o=0),"string"==typeof n)b[h]=n,b[l]=o+"s",b[p]=s||"linear",_=t.fx.animationEnd;else{m=[];for(d in n)g.test(d)?w+=d+"("+n[d]+") ":(b[d]=n[d],m.push(i(d)));w&&(b[r]=w,m.push(r)),o>0&&"object"==typeof n&&(b[a]=m.join(", "),b[u]=o+"s",b[c]=s||"linear")}return v=function(e){if("undefined"!=typeof e){if(e.target!==e.currentTarget)return;t(e.target).unbind(_,v)}t(this).css(y),f&&f.call(this)},o>0&&this.bind(_,v),this.size()&&this.get(0).clientLeft,this.css(b),0>=o&&setTimeout(function(){S.each(function(){v.call(this)})},0),this},v=null}(Zepto),define("lib/zepto.min",function(){}),function(){var t=this,e=t._,i={},n=Array.prototype,o=Object.prototype,s=Function.prototype,r=n.push,a=n.slice,u=n.concat,c=o.toString,h=o.hasOwnProperty,l=n.forEach,p=n.map,f=n.reduce,d=n.reduceRight,m=n.filter,v=n.every,g=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,S=Object.keys,_=s.bind,x=function(t){return t instanceof x?t:this instanceof x?(this._wrapped=t,void 0):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.5.2";var C=x.each=x.forEach=function(t,e,n){if(null!=t)if(l&&t.forEach===l)t.forEach(e,n);else if(t.length===+t.length){for(var o=0,s=t.length;s>o;o++)if(e.call(n,t[o],o,t)===i)return}else for(var r=x.keys(t),o=0,s=r.length;s>o;o++)if(e.call(n,t[r[o]],r[o],t)===i)return};x.map=x.collect=function(t,e,i){var n=[];return null==t?n:p&&t.map===p?t.map(e,i):(C(t,function(t,o,s){n.push(e.call(i,t,o,s))}),n)};var O="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return n&&(e=x.bind(e,n)),o?t.reduce(e,i):t.reduce(e);
if(C(t,function(t,s,r){o?i=e.call(n,i,t,s,r):(i=t,o=!0)}),!o)throw new TypeError(O);return i},x.reduceRight=x.foldr=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),d&&t.reduceRight===d)return n&&(e=x.bind(e,n)),o?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var r=x.keys(t);s=r.length}if(C(t,function(a,u,c){u=r?r[--s]:--s,o?i=e.call(n,i,t[u],u,c):(i=t[u],o=!0)}),!o)throw new TypeError(O);return i},x.find=x.detect=function(t,e,i){var n;return T(t,function(t,o,s){return e.call(i,t,o,s)?(n=t,!0):void 0}),n},x.filter=x.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(C(t,function(t,o,s){e.call(i,t,o,s)&&n.push(t)}),n)},x.reject=function(t,e,i){return x.filter(t,function(t,n,o){return!e.call(i,t,n,o)},i)},x.every=x.all=function(t,e,n){e||(e=x.identity);var o=!0;return null==t?o:v&&t.every===v?t.every(e,n):(C(t,function(t,s,r){return(o=o&&e.call(n,t,s,r))?void 0:i}),!!o)};var T=x.some=x.any=function(t,e,n){e||(e=x.identity);var o=!1;return null==t?o:g&&t.some===g?t.some(e,n):(C(t,function(t,s,r){return o||(o=e.call(n,t,s,r))?i:void 0}),!!o)};x.contains=x.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},x.invoke=function(t,e){var i=a.call(arguments,2),n=x.isFunction(e);return x.map(t,function(t){return(n?e:t[e]).apply(t,i)})},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.where=function(t,e,i){return x.isEmpty(e)?i?void 0:[]:x[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},x.findWhere=function(t,e){return x.where(t,e,!0)},x.max=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&x.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return C(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r>n.computed&&(n={value:t,computed:r})}),n.value},x.min=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&x.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return C(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r<n.computed&&(n={value:t,computed:r})}),n.value},x.shuffle=function(t){var e,i=0,n=[];return C(t,function(t){e=x.random(i++),n[i-1]=n[e],n[e]=t}),n},x.sample=function(t,e,i){return arguments.length<2||i?t[x.random(t.length-1)]:x.shuffle(t).slice(0,Math.max(0,e))};var k=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(t,e,i){var n=k(e);return x.pluck(x.map(t,function(t,e,o){return{value:t,index:e,criteria:n.call(i,t,e,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,i,n){var o={},s=null==i?x.identity:k(i);return C(e,function(i,r){var a=s.call(n,i,r,e);t(o,a,i)}),o}};x.groupBy=E(function(t,e,i){(x.has(t,e)?t[e]:t[e]=[]).push(i)}),x.indexBy=E(function(t,e,i){t[e]=i}),x.countBy=E(function(t,e){x.has(t,e)?t[e]++:t[e]=1}),x.sortedIndex=function(t,e,i,n){i=null==i?x.identity:k(i);for(var o=i.call(n,e),s=0,r=t.length;r>s;){var a=s+r>>>1;i.call(n,t[a])<o?s=a+1:r=a}return s},x.toArray=function(t){return t?x.isArray(t)?a.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},x.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},x.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var I=function(t,e,i){return e&&x.every(t,x.isArray)?u.apply(i,t):(C(t,function(t){x.isArray(t)||x.isArguments(t)?e?r.apply(i,t):I(t,e,i):i.push(t)}),i)};x.flatten=function(t,e){return I(t,e,[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.uniq=x.unique=function(t,e,i,n){x.isFunction(e)&&(n=i,i=e,e=!1);var o=i?x.map(t,i,n):t,s=[],r=[];return C(o,function(i,n){(e?n&&r[r.length-1]===i:x.contains(r,i))||(r.push(i),s.push(t[n]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})},x.difference=function(t){var e=u.apply(n,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=x.max(x.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=x.pluck(arguments,""+i);return e},x.object=function(t,e){if(null==t)return{};for(var i={},n=0,o=t.length;o>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},x.indexOf=function(t,e,i){if(null==t)return-1;var n=0,o=t.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,o+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;o>n;n++)if(t[n]===e)return n;return-1},x.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var o=n?i:t.length;o--;)if(t[o]===e)return o;return-1},x.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,s=new Array(n);n>o;)s[o++]=t,t+=i;return s};var M=function(){};x.bind=function(t,e){var i,n;if(_&&t.bind===_)return _.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));M.prototype=t.prototype;var o=new M;M.prototype=null;var s=t.apply(o,i.concat(a.call(arguments)));return Object(s)===s?s:o}},x.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},x.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var i={};return e||(e=x.identity),function(){var n=e.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},x.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e,i){var n,o,s,r=null,a=0;i||(i={});var u=function(){a=i.leading===!1?0:new Date,r=null,s=t.apply(n,o)};return function(){var c=new Date;a||i.leading!==!1||(a=c);var h=e-(c-a);return n=this,o=arguments,0>=h?(clearTimeout(r),r=null,a=c,s=t.apply(n,o)):r||i.trailing===!1||(r=setTimeout(u,h)),s}},x.debounce=function(t,e,i){var n,o,s,r,a;return function(){s=this,o=arguments,r=new Date;var u=function(){var c=new Date-r;e>c?n=setTimeout(u,e-c):(n=null,i||(a=t.apply(s,o)))},c=i&&!n;return n||(n=setTimeout(u,e)),c&&(a=t.apply(s,o)),a}},x.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return function(){var i=[t];return r.apply(i,arguments),e.apply(this,i)}},x.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},x.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},x.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)x.has(t,i)&&e.push(i);return e},x.values=function(t){for(var e=x.keys(t),i=e.length,n=new Array(i),o=0;i>o;o++)n[o]=t[e[o]];return n},x.pairs=function(t){for(var e=x.keys(t),i=e.length,n=new Array(i),o=0;i>o;o++)n[o]=[e[o],t[e[o]]];return n},x.invert=function(t){for(var e={},i=x.keys(t),n=0,o=i.length;o>n;n++)e[t[i[n]]]=i[n];return e},x.functions=x.methods=function(t){var e=[];for(var i in t)x.isFunction(t[i])&&e.push(i);return e.sort()},x.extend=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},x.pick=function(t){var e={},i=u.apply(n,a.call(arguments,1));return C(i,function(i){i in t&&(e[i]=t[i])}),e},x.omit=function(t){var e={},i=u.apply(n,a.call(arguments,1));for(var o in t)x.contains(i,o)||(e[o]=t[o]);return e},x.defaults=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var z=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var o=c.call(t);if(o!=c.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;var r=t.constructor,a=e.constructor;if(r!==a&&!(x.isFunction(r)&&r instanceof r&&x.isFunction(a)&&a instanceof a))return!1;i.push(t),n.push(e);var u=0,h=!0;if("[object Array]"==o){if(u=t.length,h=u==e.length)for(;u--&&(h=z(t[u],e[u],i,n)););}else{for(var l in t)if(x.has(t,l)&&(u++,!(h=x.has(e,l)&&z(t[l],e[l],i,n))))break;if(h){for(l in e)if(x.has(e,l)&&!u--)break;h=!u}}return i.pop(),n.pop(),h};x.isEqual=function(t,e){return z(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=w||function(t){return"[object Array]"==c.call(t)},x.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return h.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.times=function(t,e,i){for(var n=Array(Math.max(0,t)),o=0;t>o;o++)n[o]=e.call(i,o);return n},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=x.invert(A.escape);var F={escape:new RegExp("["+x.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(A.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(F[t],function(e){return A[t][e]})}}),x.result=function(t,e){if(null==t)return void 0;var i=t[e];return x.isFunction(i)?i.call(t):i},x.mixin=function(t){C(x.functions(t),function(e){var i=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),L.call(this,i.apply(x,t))}})};var P=0;x.uniqueId=function(t){var e=++P+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,i){var n;i=x.defaults({},i,x.templateSettings);var o=new RegExp([(i.escape||R).source,(i.interpolate||R).source,(i.evaluate||R).source].join("|")+"|$","g"),s=0,r="__p+='";t.replace(o,function(e,i,n,o,a){return r+=t.slice(s,a).replace(D,function(t){return"\\"+N[t]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(r+="';\n"+o+"\n__p+='"),s=a+e.length,e}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(e)return n(e,x);var u=function(t){return n.call(this,t,x)};return u.source="function("+(i.variable||"obj")+"){\n"+r+"}",u},x.chain=function(t){return x(t).chain()};var L=function(t){return this._chain?x(t).chain():t};x.mixin(x),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];x.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],L.call(this,i)}}),C(["concat","join","slice"],function(t){var e=n[t];x.prototype[t]=function(){return L.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("../bower_components/underscore/underscore-min",function(){}),function(){{var t,e=this,i=e.Backbone,n=[],o=(n.push,n.slice);n.splice}t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.1.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var r=t.Events={on:function(t,e,i){if(!u(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!u(this,"once",t,[e,i])||!e)return this;var n=this,o=s.once(function(){n.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var n,o,r,a,c,h,l,p;if(!this._events||!u(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:s.keys(this._events),c=0,h=a.length;h>c;c++)if(t=a[c],r=this._events[t]){if(this._events[t]=n=[],e||i)for(l=0,p=r.length;p>l;l++)o=r[l],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var r in n)t=n[r],t.off(e,i,this),(o||s.isEmpty(t._events))&&delete this._listeningTo[r];return this}},a=/\s+/,u=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(a.test(i)){for(var s=i.split(a),r=0,u=s.length;u>r;r++)t[e].apply(t,[s[r]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,o=t.length,s=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(t,e){r[e]=function(e,i,n){var o=this._listeningTo||(this._listeningTo={}),r=e._listenId||(e._listenId=s.uniqueId("l"));return o[r]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}}),r.bind=r.on,r.unbind=r.off,s.extend(t,r);var l=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};s.extend(l.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,o,r,a,u,c,h,l;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;r=i.unset,u=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),l=this.attributes,h=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)e=o[n],s.isEqual(l[n],e)||a.push(n),s.isEqual(h[n],e)?delete this.changed[n]:this.changed[n]=e,r?delete l[n]:l[n]=e;if(!u){a.length&&(this._pending=!0);for(var p=0,f=a.length;f>p;p++)this.trigger("change:"+a[p],this,l[a[p]],i)}if(c)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in t)s.isEqual(n[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),e.trigger("sync",e,n,t),void 0):!1},N(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,o,r,a=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var u=this,c=i.success;return i.success=function(t){u.attributes=a;var e=u.parse(t,i);return i.wait&&(e=s.extend(n||{},e)),s.isObject(e)&&!u.set(e,i)?!1:(c&&c(u,t,i),u.trigger("sync",u,t,i),void 0)},N(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=n),r=this.sync(o,this,i),n&&i.wait&&(this.attributes=a),r},destroy:function(t){t=t?s.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(o){(t.wait||e.isNew())&&n(),i&&i(e,o,t),e.isNew()||e.trigger("sync",e,o,t)},this.isNew())return t.success(),!1;N(this,t);var o=this.sync("delete",this,t);return t.wait||n(),o},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||R();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,s.extend(e,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];s.each(p,function(t){l.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}});var f=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},d={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};s.extend(f.prototype,r,{model:l,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.extend({merge:!1},e,m))},remove:function(t,e){var i=!s.isArray(t);t=i?[t]:s.clone(t),e||(e={});var n,o,r,a;for(n=0,o=t.length;o>n;n++)a=t[n]=this.get(t[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,e.silent||(e.index=r,a.trigger("remove",a,this,e)),this._removeReference(a));return i?t[0]:t},set:function(t,e){e=s.defaults({},e,d),e.parse&&(t=this.parse(t,e));var i=!s.isArray(t);t=i?t?[t]:[]:s.clone(t);var n,o,r,a,u,c,h,p=e.at,f=this.model,m=this.comparator&&null==p&&e.sort!==!1,v=s.isString(this.comparator)?this.comparator:null,g=[],y=[],b={},w=e.add,S=e.merge,_=e.remove,x=!m&&w&&_?[]:!1;for(n=0,o=t.length;o>n;n++){if(u=t[n],r=u instanceof l?a=u:u[f.prototype.idAttribute],c=this.get(r))_&&(b[c.cid]=!0),S&&(u=u===a?a.attributes:u,e.parse&&(u=c.parse(u,e)),c.set(u,e),m&&!h&&c.hasChanged(v)&&(h=!0)),t[n]=c;else if(w){if(a=t[n]=this._prepareModel(u,e),!a)continue;g.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}x&&x.push(c||a)}if(_){for(n=0,o=this.length;o>n;++n)b[(a=this.models[n]).cid]||y.push(a);y.length&&this.remove(y,e)}if(g.length||x&&x.length)if(m&&(h=!0),this.length+=g.length,null!=p)for(n=0,o=g.length;o>n;n++)this.models.splice(p+n,0,g[n]);else{x&&(this.models.length=0);var C=x||g;for(n=0,o=C.length;o>n;n++)this.models.push(C[n])}if(h&&this.sort({silent:!0}),!e.silent){for(n=0,o=g.length;o>n;n++)(a=g[n]).trigger("add",a,this,e);(h||x&&x.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,s.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,s.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,o){o.wait&&i.add(t,o),n&&n(t,e,o)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof l)return t.collection||(t.collection=this),t;e=e?s.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(v,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var g=["groupBy","countBy","sortBy"];s.each(g,function(t){f.prototype[t]=function(e,i){var n=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,n,i)}});var y=t.View=function(t){this.cid=s.uniqueId("view"),t||(t={}),s.extend(this,s.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];s.extend(y.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(s.isFunction(i)||(i=this[t[e]]),i){var n=e.match(b),o=n[1],r=n[2];i=s.bind(i,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,i):this.$el.on(o,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className"));var i=t.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var o=_[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||R()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);var a=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&S&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=n.xhr=t.ajax(s.extend(r,n));return i.trigger("request",i,u,n),u};var S=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var x=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,T=/\*\w+/g,k=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(x.prototype,r,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=this;return t.history.route(e,function(s){var r=o._extractParameters(e,s);n&&n.apply(o,r),o.trigger.apply(o,["route:"+i].concat(r)),o.trigger("route",i,r),t.history.trigger("route",o,i,r)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(k,"\\$&").replace(C,"(?:$1)?").replace(O,function(t,e){return e?t:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return s.map(i,function(t){return t?decodeURIComponent(t):null})}});var E=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,z=/msie [\w.]+/,A=/\/$/,F=/[?#].*$/;E.started=!1,s.extend(E.prototype,r,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(A,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(I,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,o=z.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(M,"/"),o&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl(),void 0)},loadUrl:function(t){return t=this.fragment=this.getFragment(t),s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!E.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(F,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new E;var P=function(t,e){var i,n=this;i=t&&s.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,e);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&s.extend(i.prototype,t),i.__super__=n.prototype,i};l.extend=f.extend=x.extend=y.extend=E.extend=P;var R=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(this),define("../bower_components/backbone/backbone-min",function(){});var Handlebars=function(){var t=function(){function t(t){this.string=t}var e;return t.prototype.toString=function(){return""+this.string
},e=t}(),e=function(t){function e(t){return a[t]||"&amp;"}function i(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}function n(t){return t instanceof r?t.toString():t||0===t?(t=""+t,c.test(t)?t.replace(u,e):t):""}function o(t){return t||0===t?p(t)&&0===t.length?!0:!1:!0}var s={},r=t,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,c=/[&<>"'`]/;s.extend=i;var h=Object.prototype.toString;s.toString=h;var l=function(t){return"function"==typeof t};l(/x/)&&(l=function(t){return"function"==typeof t&&"[object Function]"===h.call(t)});var l;s.isFunction=l;var p=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===h.call(t):!1};return s.isArray=p,s.escapeExpression=n,s.isEmpty=o,s}(t),i=function(){function t(){for(var t=Error.prototype.constructor.apply(this,arguments),e=0;e<i.length;e++)this[i[e]]=t[i[e]]}var e,i=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,e=t}(),n=function(t,e){function i(t,e){this.helpers=t||{},this.partials=e||{},n(this)}function n(t){t.registerHelper("helperMissing",function(t){if(2===arguments.length)return void 0;throw new Error("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,i){var n=i.inverse||function(){},o=i.fn;return p(e)&&(e=e.call(this)),e===!0?o(this):e===!1||null==e?n(this):l(e)?e.length>0?t.helpers.each(e,i):n(this):o(e)}),t.registerHelper("each",function(t,e){var i,n=e.fn,o=e.inverse,s=0,r="";if(p(t)&&(t=t.call(this)),e.data&&(i=v(e.data)),t&&"object"==typeof t)if(l(t))for(var a=t.length;a>s;s++)i&&(i.index=s,i.first=0===s,i.last=s===t.length-1),r+=n(t[s],{data:i});else for(var u in t)t.hasOwnProperty(u)&&(i&&(i.key=u),r+=n(t[u],{data:i}),s++);return 0===s&&(r=o(this)),r}),t.registerHelper("if",function(t,e){return p(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||r.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),t.registerHelper("with",function(t,e){return p(t)&&(t=t.call(this)),r.isEmpty(t)?void 0:e.fn(t)}),t.registerHelper("log",function(e,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;t.log(n,e)})}function o(t,e){m.log(t,e)}var s={},r=t,a=e,u="1.1.2";s.VERSION=u;var c=4;s.COMPILER_REVISION=c;var h={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};s.REVISION_CHANGES=h;var l=r.isArray,p=r.isFunction,f=r.toString,d="[object Object]";s.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:m,log:o,registerHelper:function(t,e,i){if(f.call(t)===d){if(i||e)throw new a("Arg not supported with multiple helpers");r.extend(this.helpers,t)}else i&&(e.not=i),this.helpers[t]=e},registerPartial:function(t,e){f.call(t)===d?r.extend(this.partials,t):this.partials[t]=e}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(m.level<=t){var i=m.methodMap[t];"undefined"!=typeof console&&console[i]&&console[i].call(console,e)}}};s.logger=m,s.log=o;var v=function(t){var e={};return r.extend(e,t),e};return s.createFrame=v,s}(e,i),o=function(t,e,i){function n(t){var e=t&&t[0]||1,i=p;if(e!==i){if(i>e){var n=f[i],o=f[e];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function o(t,e){if(!e)throw new Error("No environment passed to template");var i;i=e.compile?function(t,i,n,o,s,r){var u=a.apply(this,arguments);if(u)return u;var c={helpers:o,partials:s,data:r};return s[i]=e.compile(t,{data:void 0!==r},e),s[i](n,c)}:function(t,e){var i=a.apply(this,arguments);if(i)return i;throw new l("The partial "+e+" could not be compiled when running in runtime-only mode")};var o={escapeExpression:h.escapeExpression,invokePartial:i,programs:[],program:function(t,e,i){var n=this.programs[t];return i?n=r(t,e,i):n||(n=this.programs[t]=r(t,e)),n},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i={},h.extend(i,e),h.extend(i,t)),i},programWithDepth:s,noop:u,compilerInfo:null};return function(i,s){s=s||{};var r,a,u=s.partial?s:e;s.partial||(r=s.helpers,a=s.partials);var c=t.call(o,u,i,r,a,s.data);return s.partial||n(o.compilerInfo),c}}function s(t,e,i){var n=Array.prototype.slice.call(arguments,3),o=function(t,o){return o=o||{},e.apply(this,[t,o.data||i].concat(n))};return o.program=t,o.depth=n.length,o}function r(t,e,i){var n=function(t,n){return n=n||{},e(t,n.data||i)};return n.program=t,n.depth=0,n}function a(t,e,i,n,o,s){var r={partial:!0,helpers:n,partials:o,data:s};if(void 0===t)throw new l("The partial "+e+" could not be found");return t instanceof Function?t(i,r):void 0}function u(){return""}var c={},h=t,l=e,p=i.COMPILER_REVISION,f=i.REVISION_CHANGES;return c.template=o,c.programWithDepth=s,c.program=r,c.invokePartial=a,c.noop=u,c}(e,i,n),s=function(t,e,i,n,o){var s,r=t,a=e,u=i,c=n,h=o,l=function(){var t=new r.HandlebarsEnvironment;return c.extend(t,r),t.SafeString=a,t.Exception=u,t.Utils=c,t.VM=h,t.template=function(e){return h.template(e,t)},t},p=l();return p.create=l,s=p}(n,t,i,e,o);return s}();return define("../bower_components/handlebars/handlebars.runtime.min",function(){}),function(){var t=this,e=t._,i={},n=Array.prototype,o=Object.prototype,s=Function.prototype,r=n.push,a=n.slice,u=n.concat,c=o.toString,h=o.hasOwnProperty,l=n.forEach,p=n.map,f=n.reduce,d=n.reduceRight,m=n.filter,v=n.every,g=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,S=Object.keys,_=s.bind,x=function(t){return t instanceof x?t:this instanceof x?(this._wrapped=t,void 0):new x(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):t._=x,x.VERSION="1.5.2";var C=x.each=x.forEach=function(t,e,n){if(null!=t)if(l&&t.forEach===l)t.forEach(e,n);else if(t.length===+t.length){for(var o=0,s=t.length;s>o;o++)if(e.call(n,t[o],o,t)===i)return}else for(var r=x.keys(t),o=0,s=r.length;s>o;o++)if(e.call(n,t[r[o]],r[o],t)===i)return};x.map=x.collect=function(t,e,i){var n=[];return null==t?n:p&&t.map===p?t.map(e,i):(C(t,function(t,o,s){n.push(e.call(i,t,o,s))}),n)};var O="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return n&&(e=x.bind(e,n)),o?t.reduce(e,i):t.reduce(e);if(C(t,function(t,s,r){o?i=e.call(n,i,t,s,r):(i=t,o=!0)}),!o)throw new TypeError(O);return i},x.reduceRight=x.foldr=function(t,e,i,n){var o=arguments.length>2;if(null==t&&(t=[]),d&&t.reduceRight===d)return n&&(e=x.bind(e,n)),o?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var r=x.keys(t);s=r.length}if(C(t,function(a,u,c){u=r?r[--s]:--s,o?i=e.call(n,i,t[u],u,c):(i=t[u],o=!0)}),!o)throw new TypeError(O);return i},x.find=x.detect=function(t,e,i){var n;return T(t,function(t,o,s){return e.call(i,t,o,s)?(n=t,!0):void 0}),n},x.filter=x.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(C(t,function(t,o,s){e.call(i,t,o,s)&&n.push(t)}),n)},x.reject=function(t,e,i){return x.filter(t,function(t,n,o){return!e.call(i,t,n,o)},i)},x.every=x.all=function(t,e,n){e||(e=x.identity);var o=!0;return null==t?o:v&&t.every===v?t.every(e,n):(C(t,function(t,s,r){return(o=o&&e.call(n,t,s,r))?void 0:i}),!!o)};var T=x.some=x.any=function(t,e,n){e||(e=x.identity);var o=!1;return null==t?o:g&&t.some===g?t.some(e,n):(C(t,function(t,s,r){return o||(o=e.call(n,t,s,r))?i:void 0}),!!o)};x.contains=x.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},x.invoke=function(t,e){var i=a.call(arguments,2),n=x.isFunction(e);return x.map(t,function(t){return(n?e:t[e]).apply(t,i)})},x.pluck=function(t,e){return x.map(t,function(t){return t[e]})},x.where=function(t,e,i){return x.isEmpty(e)?i?void 0:[]:x[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},x.findWhere=function(t,e){return x.where(t,e,!0)},x.max=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&x.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return C(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r>n.computed&&(n={value:t,computed:r})}),n.value},x.min=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&x.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return C(t,function(t,o,s){var r=e?e.call(i,t,o,s):t;r<n.computed&&(n={value:t,computed:r})}),n.value},x.shuffle=function(t){var e,i=0,n=[];return C(t,function(t){e=x.random(i++),n[i-1]=n[e],n[e]=t}),n},x.sample=function(t,e,i){return arguments.length<2||i?t[x.random(t.length-1)]:x.shuffle(t).slice(0,Math.max(0,e))};var k=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(t,e,i){var n=k(e);return x.pluck(x.map(t,function(t,e,o){return{value:t,index:e,criteria:n.call(i,t,e,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,i,n){var o={},s=null==i?x.identity:k(i);return C(e,function(i,r){var a=s.call(n,i,r,e);t(o,a,i)}),o}};x.groupBy=E(function(t,e,i){(x.has(t,e)?t[e]:t[e]=[]).push(i)}),x.indexBy=E(function(t,e,i){t[e]=i}),x.countBy=E(function(t,e){x.has(t,e)?t[e]++:t[e]=1}),x.sortedIndex=function(t,e,i,n){i=null==i?x.identity:k(i);for(var o=i.call(n,e),s=0,r=t.length;r>s;){var a=s+r>>>1;i.call(n,t[a])<o?s=a+1:r=a}return s},x.toArray=function(t){return t?x.isArray(t)?a.call(t):t.length===+t.length?x.map(t,x.identity):x.values(t):[]},x.size=function(t){return null==t?0:t.length===+t.length?t.length:x.keys(t).length},x.first=x.head=x.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},x.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},x.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},x.rest=x.tail=x.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},x.compact=function(t){return x.filter(t,x.identity)};var I=function(t,e,i){return e&&x.every(t,x.isArray)?u.apply(i,t):(C(t,function(t){x.isArray(t)||x.isArguments(t)?e?r.apply(i,t):I(t,e,i):i.push(t)}),i)};x.flatten=function(t,e){return I(t,e,[])},x.without=function(t){return x.difference(t,a.call(arguments,1))},x.uniq=x.unique=function(t,e,i,n){x.isFunction(e)&&(n=i,i=e,e=!1);var o=i?x.map(t,i,n):t,s=[],r=[];return C(o,function(i,n){(e?n&&r[r.length-1]===i:x.contains(r,i))||(r.push(i),s.push(t[n]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})},x.difference=function(t){var e=u.apply(n,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})},x.zip=function(){for(var t=x.max(x.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=x.pluck(arguments,""+i);return e},x.object=function(t,e){if(null==t)return{};for(var i={},n=0,o=t.length;o>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},x.indexOf=function(t,e,i){if(null==t)return-1;var n=0,o=t.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,o+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;o>n;n++)if(t[n]===e)return n;return-1},x.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var o=n?i:t.length;o--;)if(t[o]===e)return o;return-1},x.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),o=0,s=new Array(n);n>o;)s[o++]=t,t+=i;return s};var M=function(){};x.bind=function(t,e){var i,n;if(_&&t.bind===_)return _.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));M.prototype=t.prototype;var o=new M;M.prototype=null;var s=t.apply(o,i.concat(a.call(arguments)));return Object(s)===s?s:o}},x.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},x.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,function(e){t[e]=x.bind(t[e],t)}),t},x.memoize=function(t,e){var i={};return e||(e=x.identity),function(){var n=e.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},x.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))},x.throttle=function(t,e,i){var n,o,s,r=null,a=0;i||(i={});var u=function(){a=i.leading===!1?0:new Date,r=null,s=t.apply(n,o)};return function(){var c=new Date;a||i.leading!==!1||(a=c);var h=e-(c-a);return n=this,o=arguments,0>=h?(clearTimeout(r),r=null,a=c,s=t.apply(n,o)):r||i.trailing===!1||(r=setTimeout(u,h)),s}},x.debounce=function(t,e,i){var n,o,s,r,a;return function(){s=this,o=arguments,r=new Date;var u=function(){var c=new Date-r;e>c?n=setTimeout(u,e-c):(n=null,i||(a=t.apply(s,o)))},c=i&&!n;return n||(n=setTimeout(u,e)),c&&(a=t.apply(s,o)),a}},x.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},x.wrap=function(t,e){return function(){var i=[t];return r.apply(i,arguments),e.apply(this,i)}},x.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},x.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},x.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)x.has(t,i)&&e.push(i);return e},x.values=function(t){for(var e=x.keys(t),i=e.length,n=new Array(i),o=0;i>o;o++)n[o]=t[e[o]];return n},x.pairs=function(t){for(var e=x.keys(t),i=e.length,n=new Array(i),o=0;i>o;o++)n[o]=[e[o],t[e[o]]];return n},x.invert=function(t){for(var e={},i=x.keys(t),n=0,o=i.length;o>n;n++)e[t[i[n]]]=i[n];return e},x.functions=x.methods=function(t){var e=[];for(var i in t)x.isFunction(t[i])&&e.push(i);return e.sort()},x.extend=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},x.pick=function(t){var e={},i=u.apply(n,a.call(arguments,1));return C(i,function(i){i in t&&(e[i]=t[i])}),e},x.omit=function(t){var e={},i=u.apply(n,a.call(arguments,1));for(var o in t)x.contains(i,o)||(e[o]=t[o]);return e},x.defaults=function(t){return C(a.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},x.clone=function(t){return x.isObject(t)?x.isArray(t)?t.slice():x.extend({},t):t},x.tap=function(t,e){return e(t),t};var z=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof x&&(t=t._wrapped),e instanceof x&&(e=e._wrapped);var o=c.call(t);if(o!=c.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;var r=t.constructor,a=e.constructor;if(r!==a&&!(x.isFunction(r)&&r instanceof r&&x.isFunction(a)&&a instanceof a))return!1;i.push(t),n.push(e);var u=0,h=!0;if("[object Array]"==o){if(u=t.length,h=u==e.length)for(;u--&&(h=z(t[u],e[u],i,n)););}else{for(var l in t)if(x.has(t,l)&&(u++,!(h=x.has(e,l)&&z(t[l],e[l],i,n))))break;if(h){for(l in e)if(x.has(e,l)&&!u--)break;h=!u}}return i.pop(),n.pop(),h};x.isEqual=function(t,e){return z(t,e,[],[])},x.isEmpty=function(t){if(null==t)return!0;if(x.isArray(t)||x.isString(t))return 0===t.length;for(var e in t)if(x.has(t,e))return!1;return!0},x.isElement=function(t){return!(!t||1!==t.nodeType)},x.isArray=w||function(t){return"[object Array]"==c.call(t)},x.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),x.isArguments(arguments)||(x.isArguments=function(t){return!(!t||!x.has(t,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(t){return"function"==typeof t}),x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},x.isNaN=function(t){return x.isNumber(t)&&t!=+t},x.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},x.isNull=function(t){return null===t},x.isUndefined=function(t){return void 0===t},x.has=function(t,e){return h.call(t,e)},x.noConflict=function(){return t._=e,this},x.identity=function(t){return t},x.times=function(t,e,i){for(var n=Array(Math.max(0,t)),o=0;t>o;o++)n[o]=e.call(i,o);return n},x.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=x.invert(A.escape);var F={escape:new RegExp("["+x.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(A.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){return null==e?"":(""+e).replace(F[t],function(e){return A[t][e]})}}),x.result=function(t,e){if(null==t)return void 0;var i=t[e];return x.isFunction(i)?i.call(t):i},x.mixin=function(t){C(x.functions(t),function(e){var i=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),L.call(this,i.apply(x,t))}})};var P=0;x.uniqueId=function(t){var e=++P+"";return t?t+e:e},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,i){var n;i=x.defaults({},i,x.templateSettings);var o=new RegExp([(i.escape||R).source,(i.interpolate||R).source,(i.evaluate||R).source].join("|")+"|$","g"),s=0,r="__p+='";t.replace(o,function(e,i,n,o,a){return r+=t.slice(s,a).replace(D,function(t){return"\\"+N[t]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(r+="';\n"+o+"\n__p+='"),s=a+e.length,e}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(e)return n(e,x);var u=function(t){return n.call(this,t,x)};return u.source="function("+(i.variable||"obj")+"){\n"+r+"}",u},x.chain=function(t){return x(t).chain()};var L=function(t){return this._chain?x(t).chain():t};x.mixin(x),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];x.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],L.call(this,i)}}),C(["concat","join","slice"],function(t){var e=n[t];x.prototype[t]=function(){return L.call(this,e.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("lib/../../bower_components/underscore/underscore-min",function(){}),function(){{var t,e=this,i=e.Backbone,n=[],o=(n.push,n.slice);n.splice}t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.1.0";var s=e._;s||"undefined"==typeof require||(s=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var r=t.Events={on:function(t,e,i){if(!u(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!u(this,"once",t,[e,i])||!e)return this;var n=this,o=s.once(function(){n.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},off:function(t,e,i){var n,o,r,a,c,h,l,p;if(!this._events||!u(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:s.keys(this._events),c=0,h=a.length;h>c;c++)if(t=a[c],r=this._events[t]){if(this._events[t]=n=[],e||i)for(l=0,p=r.length;p>l;l++)o=r[l],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var o=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var r in n)t=n[r],t.off(e,i,this),(o||s.isEmpty(t._events))&&delete this._listeningTo[r];return this}},a=/\s+/,u=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)t[e].apply(t,[o,i[o]].concat(n));return!1}if(a.test(i)){for(var s=i.split(a),r=0,u=s.length;u>r;r++)t[e].apply(t,[s[r]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,o=t.length,s=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,s,r,a);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(t,e){r[e]=function(e,i,n){var o=this._listeningTo||(this._listeningTo={}),r=e._listenId||(e._listenId=s.uniqueId("l"));return o[r]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}}),r.bind=r.on,r.unbind=r.off,s.extend(t,r);var l=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=s.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};s.extend(l.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return s.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,o,r,a,u,c,h,l;if(null==t)return this;if("object"==typeof t?(o=t,i=e):(o={})[t]=e,i||(i={}),!this._validate(o,i))return!1;r=i.unset,u=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),l=this.attributes,h=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)e=o[n],s.isEqual(l[n],e)||a.push(n),s.isEqual(h[n],e)?delete this.changed[n]:this.changed[n]=e,r?delete l[n]:l[n]=e;if(!u){a.length&&(this._pending=!0);for(var p=0,f=a.length;f>p;p++)this.trigger("change:"+a[p],this,l[a[p]],i)}if(c)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,s.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,s.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!s.isEmpty(this.changed):s.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in t)s.isEqual(n[o],e=t[o])||((i||(i={}))[o]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),e.trigger("sync",e,n,t),void 0):!1},N(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,o,r,a=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var u=this,c=i.success;return i.success=function(t){u.attributes=a;var e=u.parse(t,i);return i.wait&&(e=s.extend(n||{},e)),s.isObject(e)&&!u.set(e,i)?!1:(c&&c(u,t,i),u.trigger("sync",u,t,i),void 0)},N(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=n),r=this.sync(o,this,i),n&&i.wait&&(this.attributes=a),r},destroy:function(t){t=t?s.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(o){(t.wait||e.isNew())&&n(),i&&i(e,o,t),e.isNew()||e.trigger("sync",e,o,t)},this.isNew())return t.success(),!1;N(this,t);var o=this.sync("delete",this,t);return t.wait||n(),o},url:function(){var t=s.result(this,"urlRoot")||s.result(this.collection,"url")||R();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},s.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=s.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,s.extend(e,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];s.each(p,function(t){l.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),s[t].apply(s,e)}});var f=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,s.extend({silent:!0},e))},d={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};s.extend(f.prototype,r,{model:l,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,s.extend({merge:!1},e,m))},remove:function(t,e){var i=!s.isArray(t);t=i?[t]:s.clone(t),e||(e={});var n,o,r,a;for(n=0,o=t.length;o>n;n++)a=t[n]=this.get(t[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,e.silent||(e.index=r,a.trigger("remove",a,this,e)),this._removeReference(a));return i?t[0]:t},set:function(t,e){e=s.defaults({},e,d),e.parse&&(t=this.parse(t,e));var i=!s.isArray(t);t=i?t?[t]:[]:s.clone(t);var n,o,r,a,u,c,h,p=e.at,f=this.model,m=this.comparator&&null==p&&e.sort!==!1,v=s.isString(this.comparator)?this.comparator:null,g=[],y=[],b={},w=e.add,S=e.merge,_=e.remove,x=!m&&w&&_?[]:!1;for(n=0,o=t.length;o>n;n++){if(u=t[n],r=u instanceof l?a=u:u[f.prototype.idAttribute],c=this.get(r))_&&(b[c.cid]=!0),S&&(u=u===a?a.attributes:u,e.parse&&(u=c.parse(u,e)),c.set(u,e),m&&!h&&c.hasChanged(v)&&(h=!0)),t[n]=c;else if(w){if(a=t[n]=this._prepareModel(u,e),!a)continue;g.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}x&&x.push(c||a)}if(_){for(n=0,o=this.length;o>n;++n)b[(a=this.models[n]).cid]||y.push(a);y.length&&this.remove(y,e)}if(g.length||x&&x.length)if(m&&(h=!0),this.length+=g.length,null!=p)for(n=0,o=g.length;o>n;n++)this.models.splice(p+n,0,g[n]);else{x&&(this.models.length=0);var C=x||g;for(n=0,o=C.length;o>n;n++)this.models.push(C[n])}if(h&&this.sort({silent:!0}),!e.silent){for(n=0,o=g.length;o>n;n++)(a=g[n]).trigger("add",a,this,e);(h||x&&x.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,s.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,s.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return s.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return s.invoke(this.models,"get",t)},fetch:function(t){t=t?s.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?s.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,o){o.wait&&i.add(t,o),n&&n(t,e,o)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof l)return t.collection||(t.collection=this),t;e=e?s.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(v,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),s[t].apply(s,e)}});var g=["groupBy","countBy","sortBy"];s.each(g,function(t){f.prototype[t]=function(e,i){var n=s.isFunction(e)?e:function(t){return t.get(e)};return s[t](this.models,n,i)}});var y=t.View=function(t){this.cid=s.uniqueId("view"),t||(t={}),s.extend(this,s.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];s.extend(y.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=s.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(s.isFunction(i)||(i=this[t[e]]),i){var n=e.match(b),o=n[1],r=n[2];i=s.bind(i,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,i):this.$el.on(o,r,i)
}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className"));var i=t.$("<"+s.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var o=_[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||R()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);var a=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&S&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=n.xhr=t.ajax(s.extend(r,n));return i.trigger("request",i,u,n),u};var S=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var x=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,T=/\*\w+/g,k=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(x.prototype,r,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=this;return t.history.route(e,function(s){var r=o._extractParameters(e,s);n&&n.apply(o,r),o.trigger.apply(o,["route:"+i].concat(r)),o.trigger("route",i,r),t.history.trigger("route",o,i,r)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var t,e=s.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(k,"\\$&").replace(C,"(?:$1)?").replace(O,function(t,e){return e?t:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return s.map(i,function(t){return t?decodeURIComponent(t):null})}});var E=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,z=/msie [\w.]+/,A=/\/$/,F=/[?#].*$/;E.started=!1,s.extend(E.prototype,r,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(A,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(I,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,o=z.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(M,"/"),o&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl(),void 0)},loadUrl:function(t){return t=this.fragment=this.getFragment(t),s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!E.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(F,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new E;var P=function(t,e){var i,n=this;i=t&&s.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,e);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&s.extend(i.prototype,t),i.__super__=n.prototype,i};l.extend=f.extend=x.extend=y.extend=E.extend=P;var R=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}}}.call(this),define("lib/../../bower_components/backbone/backbone-min",function(){}),function(t,e){"function"==typeof define&&define.amd?define("lib/backboneLocalStorage",["../../bower_components/underscore/underscore-min","../../bower_components/backbone/backbone-min"],function(i,n){return e(i||t._,n||t.Backbone)}):e(_,Backbone)}(this,function(t,e){function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function n(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}return e.LocalStorage=window.Store=function(t){this.name=t;var e=this.localStorage().getItem(this.name);this.records=e&&e.split(",")||[]},t.extend(e.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(t){return t.id||(t.id=n(),t.set(t.idAttribute,t.id)),this.localStorage().setItem(this.name+"-"+t.id,JSON.stringify(t)),this.records.push(t.id.toString()),this.save(),this.find(t)},update:function(e){return this.localStorage().setItem(this.name+"-"+e.id,JSON.stringify(e)),t.include(this.records,e.id.toString())||this.records.push(e.id.toString()),this.save(),this.find(e)},find:function(t){return this.jsonData(this.localStorage().getItem(this.name+"-"+t.id))},findAll:function(){return t(this.records).chain().map(function(t){return this.jsonData(this.localStorage().getItem(this.name+"-"+t))},this).compact().value()},destroy:function(e){return e.isNew()?!1:(this.localStorage().removeItem(this.name+"-"+e.id),this.records=t.reject(this.records,function(t){return t===e.id.toString()}),this.save(),e)},localStorage:function(){return localStorage},jsonData:function(t){return t&&JSON.parse(t)}}),e.LocalStorage.sync=window.Store.sync=e.localSync=function(t,e,i){var n,o,s=e.localStorage||e.collection.localStorage,r=$.Deferred&&$.Deferred();try{switch(t){case"read":n=void 0!=e.id?s.find(e):s.findAll();break;case"create":n=s.create(e);break;case"update":n=s.update(e);break;case"delete":n=s.destroy(e)}}catch(a){o=a.code===DOMException.QUOTA_EXCEEDED_ERR&&0===window.localStorage.length?"Private browsing is unsupported":a.message}return n?(e.trigger("sync",e,n,i),i&&i.success&&i.success(n),r&&r.resolve(n)):(o=o?o:"Record Not Found",i&&i.error&&i.error(o),r&&r.reject(o)),i&&i.complete&&i.complete(n),r&&r.promise()},e.ajaxSync=e.sync,e.getSyncMethod=function(t){return t.localStorage||t.collection&&t.collection.localStorage?e.localSync:e.ajaxSync},e.sync=function(t,i,n){return e.getSyncMethod(i).apply(this,[t,i,n])},e.LocalStorage}),function(){function g(t){throw t}function aa(t){return function(){return this[t]}}function r(t){return function(){return t}}function ca(){}function da(t){t.mb=function(){return t.bd?t.bd:t.bd=new t}}function ea(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var i=Object.prototype.toString.call(t);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function u(t){return t!==j}function fa(t){var e=ea(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"string"==typeof t}function ga(t){return"number"==typeof t}function ha(t){var e=typeof t;return"object"==e&&t!=l||"function"==e}function ia(t){return t.call.apply(t.bind,arguments)}function ja(t,e){if(t||g(Error()),2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(){return w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja,w.apply(l,arguments)}function ka(t,e){function i(){}i.prototype=e.prototype,t.Vd=e.prototype,t.prototype=new i}function la(a){if(a=String(a),/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}g(Error("Invalid JSON string: "+a))}function ma(){this.dc=j}function na(t,e,i){switch(typeof e){case"string":oa(e,i);break;case"number":i.push(isFinite(e)&&!isNaN(e)?e:"null");break;case"boolean":i.push(e);break;case"undefined":i.push("null");break;case"object":if(e==l){i.push("null");break}if("array"==ea(e)){var n=e.length;i.push("[");for(var o="",s=0;n>s;s++)i.push(o),o=e[s],na(t,t.dc?t.dc.call(e,String(s),o):o,i),o=",";i.push("]");break}i.push("{"),n="";for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(o=e[s],"function"!=typeof o&&(i.push(n),oa(s,i),i.push(":"),na(t,t.dc?t.dc.call(e,s,o):o,i),n=","));i.push("}");break;case"function":break;default:g(Error("Unknown type: "+typeof e))}}function oa(t,e){e.push('"',t.replace(qa,function(t){if(t in pa)return pa[t];var e=t.charCodeAt(0),i="\\u";return 16>e?i+="000":256>e?i+="00":4096>e&&(i+="0"),pa[t]=i+e.toString(16)}),'"')}function y(t){if("undefined"!=typeof JSON&&u(JSON.stringify))t=JSON.stringify(t);else{var e=[];na(new ma,t,e),t=e.join("")}return t}function ra(t){for(var e=[],i=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);o>=55296&&56319>=o&&(o-=55296,n++,z(n<t.length,"Surrogate pair missing trail surrogate."),o=65536+(o<<10)+(t.charCodeAt(n)-56320)),128>o?e[i++]=o:(2048>o?e[i++]=o>>6|192:(65536>o?e[i++]=o>>12|224:(e[i++]=o>>18|240,e[i++]=o>>12&63|128),e[i++]=o>>6&63|128),e[i++]=63&o|128)}return e}function A(t,e,i,n){var o;e>n?o="at least "+e:n>i&&(o=0===i?"none":"no more than "+i),o&&g(Error(t+" failed: Was called with "+n+(1===n?" argument.":" arguments.")+" Expects "+o+"."))}function B(t,e,i){var n="";switch(e){case 1:n=i?"first":"First";break;case 2:n=i?"second":"Second";break;case 3:n=i?"third":"Third";break;case 4:n=i?"fourth":"Fourth";break;default:sa.assert(o,"errorPrefix_ called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(n+" argument ")}function C(t,e,i,n){(!n||u(i))&&"function"!=ea(i)&&g(Error(B(t,e,n)+"must be a valid function."))}function ta(t,e,i){u(i)&&(!ha(i)||i===l)&&g(Error(B(t,e,k)+"must be a valid context object."))}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ua(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function xa(t){return v(t)&&0!==t.length&&!va.test(t)}function ya(t,e,i){(!i||u(e))&&za(B(t,1,i),e)}function za(t,e,i,n){if(i||(i=0),n||(n=[]),u(e)||g(Error(t+"contains undefined"+Aa(n))),"function"==ea(e)&&g(Error(t+"contains a function"+Aa(n)+" with contents: "+e.toString())),Ba(e)&&g(Error(t+"contains "+e.toString()+Aa(n))),i>1e3&&g(new TypeError(t+"contains a cyclic object value ("+n.slice(0,100).join(".")+"...)")),v(e)&&e.length>10485760/3&&10485760<ra(e).length&&g(Error(t+"contains a string greater than 10485760 utf8 bytes"+Aa(n)+" ('"+e.substring(0,50)+"...')")),ha(e))for(var o in e)D(e,o)&&(".priority"!==o&&".value"!==o&&".sv"!==o&&!xa(o)&&g(Error(t+"contains an invalid key ("+o+")"+Aa(n)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')),n.push(o),za(t,e[o],i+1,n),n.pop())}function Aa(t){return 0==t.length?"":" in property '"+t.join(".")+"'"}function Ca(t,e){ha(e)||g(Error(B(t,1,o)+" must be an object containing the children to replace.")),ya(t,e,o)}function Da(t,e,i,n){(!n||u(i))&&!(i===l||ga(i)||v(i)||ha(i)&&D(i,".sv")||!g(Error(B(t,e,n)+"must be a valid firebase priority (a string, number, or null).")))}function Ea(t,e,i){if(!i||u(e))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:g(Error(B(t,1,i)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".'))}}function Fa(t,e){u(e)&&!xa(e)&&g(Error(B(t,2,k)+'was an invalid key: "'+e+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").'))}function Ga(t,e){(!v(e)||0===e.length||wa.test(e))&&g(Error(B(t,1,o)+'was an invalid path: "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"'))}function E(t,e){".info"===F(e)&&g(Error(t+" failed: Can't modify data under /.info/"))}function H(t,e,i,n,o,s,r){this.n=t,this.path=e,this.Ba=i,this.ca=n,this.ua=o,this.za=s,this.Sa=r,u(this.ca)&&u(this.za)&&u(this.Ba)&&g("Query: Can't combine startAt(), endAt(), and limit().")}function Ia(t){var e={};return u(t.ca)&&(e.sp=t.ca),u(t.ua)&&(e.sn=t.ua),u(t.za)&&(e.ep=t.za),u(t.Sa)&&(e.en=t.Sa),u(t.Ba)&&(e.l=t.Ba),u(t.ca)&&u(t.ua)&&t.ca===l&&t.ua===l&&(e.vf="l"),e}function Ha(t,e,i){var n={};return e&&i?(n.cancel=e,C(t,3,n.cancel,k),n.T=i,ta(t,4,n.T)):e&&("object"==typeof e&&e!==l?n.T=e:"function"==typeof e?n.cancel=e:g(Error(B(t,3,k)+"must either be a cancel callback or a context object."))),n}function K(t){if(t instanceof K)return t;if(1==arguments.length){this.m=t.split("/");for(var e=0,i=0;i<this.m.length;i++)0<this.m[i].length&&(this.m[e]=this.m[i],e++);this.m.length=e,this.Z=0}else this.m=arguments[0],this.Z=arguments[1]}function F(t){return t.Z>=t.m.length?l:t.m[t.Z]}function Ka(t){var e=t.Z;return e<t.m.length&&e++,new K(t.m,e)}function La(t,e){var i=F(t);return i===l?e:i===F(e)?La(Ka(t),Ka(e)):(g("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")"),void 0)}function Ma(){this.children={},this.pc=0,this.value=l}function Na(t,e,i){this.Ca=t?t:"",this.Bb=e?e:l,this.z=i?i:new Ma}function L(t,e){for(var i,n=e instanceof K?e:new K(e),o=t;(i=F(n))!==l;)o=new Na(i,o,ua(o.z.children,i)||new Ma),n=Ka(n);return o}function M(t,e){z("undefined"!=typeof e),t.z.value=e,Oa(t)}function Pa(t,e,i,n){i&&!n&&e(t),t.w(function(t){Pa(t,e,k,n)}),i&&n&&e(t)}function Qa(t,e,i){for(t=i?t:t.parent();t!==l;){if(e(t))return k;t=t.parent()}return o}function Oa(t){if(t.Bb!==l){var e=t.Bb,i=t.Ca,n=t.f(),o=D(e.z.children,i);n&&o?(delete e.z.children[i],e.z.pc--,Oa(e)):!n&&!o&&(e.z.children[i]=t.z,e.z.pc++,Oa(e))}}function Ra(t,e){this.Pa=t?t:Sa,this.ba=e?e:Ta}function Sa(t,e){return e>t?-1:t>e?1:0}function Ua(t,e){for(var i,n=t.ba,o=l;!n.f();){if(i=t.Pa(e,n.key),0===i){if(n.left.f())return o?o.key:l;for(n=n.left;!n.right.f();)n=n.right;return n.key}0>i?n=n.left:i>0&&(o=n,n=n.right)}g(Error("Attempted to find predecessor key for a nonexistent key.  What gives?"))}function Va(t,e){for(this.jd=e,this.Rb=[];!t.f();)this.Rb.push(t),t=t.left}function Wa(t){if(0===t.Rb.length)return l;var e,i=t.Rb.pop();for(e=t.jd?t.jd(i.key,i.value):{key:i.key,value:i.value},i=i.right;!i.f();)t.Rb.push(i),i=i.left;return e}function Xa(t,e,i,n,o){this.key=t,this.value=e,this.color=i!=l?i:k,this.left=n!=l?n:Ta,this.right=o!=l?o:Ta}function Ya(t){return t.left.f()?t:Ya(t.left)}function bb(t){return t.left.f()?Ta:(!t.left.O()&&!t.left.left.O()&&(t=cb(t)),t=t.copy(l,l,l,bb(t.left),l),Za(t))}function Za(t){return t.right.O()&&!t.left.O()&&(t=fb(t)),t.left.O()&&t.left.left.O()&&(t=db(t)),t.left.O()&&t.right.O()&&(t=eb(t)),t}function cb(t){return t=eb(t),t.right.left.O()&&(t=t.copy(l,l,l,l,db(t.right)),t=fb(t),t=eb(t)),t}function fb(t){var e;return e=t.copy(l,l,k,l,t.right.left),t.right.copy(l,l,t.color,e,l)}function db(t){var e;return e=t.copy(l,l,k,t.left.right,l),t.left.copy(l,l,t.color,l,e)}function eb(t){var e,i;return e=t.left.copy(l,l,!t.left.color,l,l),i=t.right.copy(l,l,!t.right.color,l,l),t.copy(l,l,!t.color,e,i)}function gb(){}function kb(){}function lb(){this.B=[],this.oc=[],this.rd=[],this.Xb=[],this.Xb[0]=128;for(var t=1;64>t;++t)this.Xb[t]=0;this.reset()}function mb(t,e){var i;i||(i=0);for(var n=t.rd,o=i;i+64>o;o+=4)n[o/4]=e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3];for(o=16;80>o;o++){var s=n[o-3]^n[o-8]^n[o-14]^n[o-16];n[o]=4294967295&(s<<1|s>>>31)}i=t.B[0];for(var r,a=t.B[1],u=t.B[2],c=t.B[3],h=t.B[4],o=0;80>o;o++)40>o?20>o?(s=c^a&(u^c),r=1518500249):(s=a^u^c,r=1859775393):60>o?(s=a&u|c&(a|u),r=2400959708):(s=a^u^c,r=3395469782),s=(i<<5|i>>>27)+s+h+r+n[o]&4294967295,h=c,c=u,u=4294967295&(a<<30|a>>>2),a=i,i=s;t.B[0]=t.B[0]+i&4294967295,t.B[1]=t.B[1]+a&4294967295,t.B[2]=t.B[2]+u&4294967295,t.B[3]=t.B[3]+c&4294967295,t.B[4]=t.B[4]+h&4294967295}function nb(){this.Oa={},this.length=0}function qb(t,e,i,n){this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.ec=e,this.ub=i,this.ea=n||ob.getItem(t)||this.host}function rb(t,e){e!==t.ea&&(t.ea=e,"s-"===t.ea.substr(0,2)&&ob.setItem(t.host,t.ea))}function wb(){return ba.navigator?ba.navigator.userAgent:l}function Gb(t,e){if(fa(t)||g(Error("encodeByteArray takes an array as a parameter")),!Eb){Eb={},Fb={};for(var i=0;65>i;i++)Eb[i]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i),Fb[i]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(i)}for(var i=e?Fb:Eb,n=[],o=0;o<t.length;o+=3){var s=t[o],r=o+1<t.length,a=r?t[o+1]:0,u=o+2<t.length,c=u?t[o+2]:0,h=s>>2,s=(3&s)<<4|a>>4,a=(15&a)<<2|c>>6,c=63&c;u||(c=64,r||(a=64)),n.push(i[h],i[s],i[a],i[c])}return n.join("")}function z(t,e){t||g(Error("Firebase INTERNAL ASSERT FAILED:"+e))}function Jb(t){var e=ra(t),t=new lb;t.update(e);var e=[],i=8*t.Sc;56>t.ob?t.update(t.Xb,56-t.ob):t.update(t.Xb,64-(t.ob-56));for(var n=63;n>=56;n--)t.oc[n]=255&i,i/=256;for(mb(t,t.oc),n=i=0;5>n;n++)for(var o=24;o>=0;o-=8)e[i++]=t.B[n]>>o&255;return Gb(e)}function Kb(){for(var t="",e=0;e<arguments.length;e++)t=fa(arguments[e])?t+Kb.apply(l,arguments[e]):"object"==typeof arguments[e]?t+y(arguments[e]):t+arguments[e],t+=" ";return t}function Nb(){if(Mb===k&&(Mb=o,Lb===l&&"true"===ob.getItem("logging_enabled")&&Ob(k)),Lb){var t=Kb.apply(l,arguments);Lb(t)}}function Pb(t){return function(){Nb(t,arguments)}}function Qb(){if("undefined"!=typeof console){var t="FIREBASE INTERNAL ERROR: "+Kb.apply(l,arguments);"undefined"!=typeof console.error?console.error(t):console.log(t)}}function Rb(){var t=Kb.apply(l,arguments);g(Error("FIREBASE FATAL ERROR: "+t))}function N(){if("undefined"!=typeof console){var t="FIREBASE WARNING: "+Kb.apply(l,arguments);"undefined"!=typeof console.warn?console.warn(t):console.log(t)}}function Ba(t){return ga(t)&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)}function Sb(t,e){return t!==e?t===l?-1:e===l?1:typeof t!=typeof e?"number"==typeof t?-1:1:t>e?1:-1:0}function Tb(t,e){if(t===e)return 0;var i=Ub(t),n=Ub(e);return i!==l?n!==l?i-n:-1:n!==l?1:e>t?-1:1}function Vb(t,e){return e&&t in e?e[t]:(g(Error("Missing required key ("+t+") in object: "+y(e))),void 0)}function Ja(t){if("object"!=typeof t||t===l)return y(t);var e,i=[];for(e in t)i.push(e);i.sort(),e="{";for(var n=0;n<i.length;n++)0!==n&&(e+=","),e+=y(i[n]),e+=":",e+=Ja(t[i[n]]);return e+"}"}function Wb(t,e){if(t.length<=e)return[t];for(var i=[],n=0;n<t.length;n+=e)n+e>t?i.push(t.substring(n,t.length)):i.push(t.substring(n,n+e));return i}function Xb(t,e){if("array"==ea(t))for(var i=0;i<t.length;++i)e(i,t[i]);else Yb(t,e)}function Zb(t){z(!Ba(t));var e,i,n,o;for(0===t?(n=i=0,e=-1/0===1/t?1:0):(e=0>t,t=Math.abs(t),t>=Math.pow(2,-1022)?(n=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),i=n+1023,n=Math.round(t*Math.pow(2,52-n)-Math.pow(2,52))):(i=0,n=Math.round(t/Math.pow(2,-1074)))),o=[],t=52;t;t-=1)o.push(n%2?1:0),n=Math.floor(n/2);for(t=11;t;t-=1)o.push(i%2?1:0),i=Math.floor(i/2);for(o.push(e?1:0),o.reverse(),e=o.join(""),i="",t=0;64>t;t+=8)n=parseInt(e.substr(t,8),2).toString(16),1===n.length&&(n="0"+n),i+=n;return i.toLowerCase()}function Ub(t){return $b.test(t)&&(t=Number(t),t>=-2147483648&&2147483647>=t)?t:l}function ac(t){try{t()}catch(e){setTimeout(function(){g(e)})}}function bc(t,e){this.D=t,z(this.D!==l,"LeafNode shouldn't be created with null value."),this.Za="undefined"!=typeof e?e:l}function dc(t,e){return Sb(t.ha,e.ha)||Tb(t.name,e.name)}function ec(t,e){return Tb(t.name,e.name)}function fc(t,e){return Tb(t,e)}function Q(t,e){this.o=t||new Ra(fc),this.Za="undefined"!=typeof e?e:l}function gc(t,e,i){Q.call(this,t,i),e===l&&(e=new Ra(dc),t.Aa(function(t,i){e=e.na({name:t,ha:i.j()},i)})),this.ta=e}function R(t,e){if(t===l)return P;var i=l;if("object"==typeof t&&".priority"in t?i=t[".priority"]:"undefined"!=typeof e&&(i=e),z(i===l||"string"==typeof i||"number"==typeof i||"object"==typeof i&&".sv"in i),"object"==typeof t&&".value"in t&&t[".value"]!==l&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new bc(t,i);if(t instanceof Array){var n=P;return Yb(t,function(e,i){if(D(t,i)&&"."!==i.substring(0,1)){var o=R(e);(o.N()||!o.f())&&(n=n.G(i,o))}}),n.Ea(i)}var s=[],r={},a=o;Xb(t,function(e,i){if("string"!=typeof i||"."!==i.substring(0,1)){var n=R(t[i]);n.f()||(a=a||n.j()!==l,s.push({name:i,ha:n.j()}),r[i]=n)}});var u=ic(s,r,o);if(a){var c=ic(s,r,k);return new gc(u,c,i)}return new Q(u,i)}function kc(t){this.count=parseInt(Math.log(t+1)/jc),this.Xc=this.count-1,this.td=t+1&parseInt(Array(this.count+1).join("1"),2)}function ic(t,e,i){function n(n,o){var r=h-n,a=h;h-=n;var p=t[r].name,r=new Xa(i?t[r]:p,e[p],o,l,s(r+1,a));u?u.left=r:c=r,u=r}function s(n,r){var a=r-n;if(0==a)return l;if(1==a){var a=t[n].name,u=i?t[n]:a;return new Xa(u,e[a],o,l,l)}var u=parseInt(a/2)+n,c=s(n,u),h=s(u+1,r),a=t[u].name,u=i?t[u]:a;return new Xa(u,e[a],o,c,h)}var r=i?dc:ec;t.sort(r);var a,r=new kc(t.length),u=l,c=l,h=t.length;for(a=0;a<r.count;++a){var p=!(r.td&1<<r.Xc);r.Xc--;var f=Math.pow(2,r.count-(a+1));p?n(f,o):(n(f,o),n(f,k))}return a=c,r=i?dc:fc,a!==l?new Ra(r,a):new Ra(r)}function cc(t){return"number"==typeof t?"number:"+Zb(t):"string:"+t}function S(t,e){this.z=t,this.bc=e}function mc(t){z("array"==ea(t)&&0<t.length),this.sd=t,this.sb={}}function nc(t,e){var i,n=t.sd;t:{i=function(t){return t===e};for(var o=n.length,s=v(n)?n.split(""):n,r=0;o>r;r++)if(r in s&&i.call(j,s[r])){i=r;break t}i=-1}z(0>i?l:v(n)?n.charAt(i):n[i],"Unknown event: "+e)}function oc(){mc.call(this,["visible"]);var t,e;if("undefined"!=typeof document&&"undefined"!=typeof document.addEventListener&&("undefined"!=typeof document.hidden?(e="visibilitychange",t="hidden"):"undefined"!=typeof document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):"undefined"!=typeof document.msHidden?(e="msvisibilitychange",t="msHidden"):"undefined"!=typeof document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.hb=k,e){var i=this;document.addEventListener(e,function(){var e=!document[t];e!==i.hb&&(i.hb=e,i.Uc("visible",e))},o)}}function pc(t){this.Gc=t,this.Zb=[],this.Ra=0,this.qc=-1,this.Ja=l}function Yb(t,e){for(var i in t)e.call(j,t[i],i,t)}function qc(t){var e,i={};for(e in t)i[e]=t[e];return i}function rc(){this.jb={}}function sc(t,e,i){u(i)||(i=1),D(t.jb,e)||(t.jb[e]=0),t.jb[e]+=i}function tc(t){this.ud=t,this.Qb=l}function uc(t,e){this.Pc={},this.hc=new tc(t),this.u=e,setTimeout(w(this.gd,this),10+6e4*Math.random())}function xc(t){return t=t.toString(),vc[t]||(vc[t]=new rc),vc[t]}function T(t,e,i){this.rc=t,this.e=Pb(this.rc),this.frames=this.qb=l,this.Rc=0,this.$=xc(e),this.Qa=(e.ec?"wss://":"ws://")+e.ea+"/.ws?v=5",e.host!==e.ea&&(this.Qa=this.Qa+"&ns="+e.ub),i&&(this.Qa=this.Qa+"&s="+i)}function Bc(t,e){if(t.frames.push(e),t.frames.length==t.Rc){var i=t.frames.join("");t.frames=l,i="undefined"!=typeof JSON&&u(JSON.parse)?JSON.parse(i):la(i),t.Fd(i)}}function Ac(t){clearInterval(t.qb),t.qb=setInterval(function(){t.Y.send("0"),Ac(t)},45e3)}function Cc(){this.set={}}function Dc(t,e){for(var i in t.set)D(t.set,i)&&e(i,t.set[i])}function Gc(t,e,i){this.rc=t,this.e=Pb(t),this.Ud=e,this.$=xc(e),this.gc=i,this.kb=o,this.Mb=function(t){e.host!==e.ea&&(t.ns=e.ub);var i,n=[];for(i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);return(e.ec?"https://":"http://")+e.ea+"/.lp?"+n.join("&")}}function Jc(t,e,i,n){if(this.Mb=n,this.ga=i,this.Ic=new Cc,this.Db=[],this.sc=Math.floor(1e8*Math.random()),this.fc=k,this.jc=Hb(),window[Ec+this.jc]=t,window[Fc+this.jc]=e,t=document.createElement("iframe"),t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Nb("No IE domain setting required")}catch(o){t.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}}else g("Document body has not initialized. Wait to initialize Firebase until after the document is ready.");t.contentDocument?t.ya=t.contentDocument:t.contentWindow?t.ya=t.contentWindow.document:t.document&&(t.ya=t.document),this.X=t,t="",this.X.src&&"javascript:"===this.X.src.substr(0,11)&&(t='<script>document.domain="'+document.domain+'";</script>'),t="<html><body>"+t+"</body></html>";try{this.X.ya.open(),this.X.ya.write(t),this.X.ya.close()}catch(s){Nb("frame writing exception"),s.stack&&Nb(s.stack),Nb(s)}}function Lc(t){if(t.mc&&t.fc&&t.Ic.count()<(0<t.Db.length?2:1)){t.sc++;var e={};e.id=t.Dd,e.pw=t.Ed,e.ser=t.sc;for(var e=t.Mb(e),i="",n=0;0<t.Db.length&&1870>=t.Db[0].Yc.length+30+i.length;){var s=t.Db.shift(),i=i+"&seg"+n+"="+s.Nd+"&ts"+n+"="+s.Sd+"&d"+n+"="+s.Yc;n++}var e=e+i,r=t.sc;t.Ic.add(r);var a=function(){t.Ic.remove(r),Lc(t)},u=setTimeout(a,25e3);return Kc(t,e,function(){clearTimeout(u),a()}),k}return o}function Kc(t,e,i){setTimeout(function(){try{if(t.fc){var n=t.X.ya.createElement("script");n.type="text/javascript",n.async=k,n.src=e,n.onload=n.onreadystatechange=function(){var t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=l,n.parentNode&&n.parentNode.removeChild(n),i())},n.onerror=function(){Nb("Long-poll script failed to load: "+e),t.fc=o,t.close()},t.X.ya.body.appendChild(n)}}catch(s){}},1)}function Mc(){var t=[];T&&T.isAvailable()?t.push(T):Xb(Nc,function(e,i){i&&i.isAvailable()&&t.push(i)}),this.ic=t}function Oc(t,e,i,n,o,s){this.id=t,this.e=Pb("c:"+this.id+":"),this.Gc=i,this.yb=n,this.R=o,this.Fc=s,this.K=e,this.Yb=[],this.Vc=0,this.Tc=new Mc,this.va=0,this.e("Connection created"),Pc(this)}function Pc(t){var e,i=t.Tc;0<i.ic.length?e=i.ic[0]:g(Error("No transports available")),t.L=new e("c:"+t.id+":"+t.Vc++,t.K);var n=Qc(t,t.L),o=Rc(t,t.L);t.Kb=t.L,t.Ib=t.L,t.A=l,setTimeout(function(){t.L&&t.L.open(n,o)},0)}function Rc(t,e){return function(i){e===t.L?(t.L=l,i||0!==t.va?1===t.va&&t.e("Realtime connection lost."):(t.e("Realtime connection failed."),"s-"===t.K.ea.substr(0,2)&&(ob.removeItem(t.K.ub),t.K.ea=t.K.host)),t.close()):e===t.A?(i=t.A,t.A=l,(t.Kb===i||t.Ib===i)&&t.close()):t.e("closing an old connection")}}function Qc(t,e){return function(i){if(2!=t.va)if(e===t.Ib){var n=Vb("t",i),i=Vb("d",i);if("c"==n){if(n=Vb("t",i),"d"in i)if(i=i.d,"h"===n){var n=i.ts,o=i.v,s=i.h;t.gc=i.s,rb(t.K,s),0==t.va&&(t.L.start(),i=t.L,t.e("Realtime connection established."),t.L=i,t.va=1,t.yb&&(t.yb(n),t.yb=l),"5"!==o&&N("Protocol version mismatch detected"),i=1<t.Tc.ic.length?t.Tc.ic[1]:l)&&(t.A=new i("c:"+t.id+":"+t.Vc++,t.K,t.gc),t.A.open(Qc(t,t.A),Rc(t,t.A)))}else if("n"===n){for(t.e("recvd end transmission on primary"),t.Ib=t.A,i=0;i<t.Yb.length;++i)t.Vb(t.Yb[i]);t.Yb=[],Sc(t)}else"s"===n?(t.e("Connection shutdown command received. Shutting down..."),t.Fc&&(t.Fc(i),t.Fc=l),t.R=l,t.close()):"r"===n?(t.e("Reset packet received.  New host: "+i),rb(t.K,i),1===t.va?t.close():(Tc(t),Pc(t))):"e"===n?Qb("Server Error: "+i):Qb("Unknown control packet command: "+n)}else"d"==n&&t.Vb(i)}else e===t.A?(n=Vb("t",i),i=Vb("d",i),"c"==n?"t"in i&&(i=i.t,"a"===i?(t.A.start(),t.e("sending client ack on secondary"),t.A.send({t:"c",d:{t:"a",d:{}}}),t.e("Ending transmission on primary"),t.L.send({t:"c",d:{t:"n",d:{}}}),t.Kb=t.A,Sc(t)):"r"===i&&(t.e("Got a reset on secondary, closing it"),t.A.close(),(t.Kb===t.A||t.Ib===t.A)&&t.close())):"d"==n?t.Yb.push(i):g(Error("Unknown protocol layer: "+n))):t.e("message on old connection")}}function Sc(t){t.Kb===t.A&&t.Ib===t.A&&(t.e("cleaning up and promoting a connection: "+t.A.rc),t.L=t.A,t.A=l)}function Tc(t){t.e("Shutting down all connections"),t.L&&(t.L.close(),t.L=l),t.A&&(t.A.close(),t.A=l)}function Vc(){if(mc.call(this,["online"]),this.zb=k,"undefined"!=typeof window&&"undefined"!=typeof window.addEventListener){var t=this;window.addEventListener("online",function(){t.zb||t.Uc("online",k),t.zb=k},o),window.addEventListener("offline",function(){t.zb&&t.Uc("online",o),t.zb=o},o)}}function Wc(t,e,i,n,s,r){this.id=Xc++,this.e=Pb("p:"+this.id+":"),this.Na=k,this.fa={},this.U=[],this.Ab=0,this.xb=[],this.P=o,this.pa=1e3,this.Wb=e||ca,this.Ub=i||ca,this.wb=n||ca,this.Hc=s||ca,this.yc=r||ca,this.K=t,this.Lc=l,this.Hb={},this.Md=0,this.rb=this.Cc=l,Yc(this,0),oc.mb().Ya("visible",this.Hd,this),-1===t.host.indexOf("fblocal")&&Vc.mb().Ya("online",this.Gd,this)}function $c(t,e,i,n,o){t.e("Listen on "+e+" for "+i);var s={p:e},n=jb(n,function(t){return Ia(t)});"{}"!==i&&(s.q=n),s.h=t.yc(e),t.Da("l",s,function(n){t.e("listen response",n),n=n.s,"ok"!==n&&ad(t,e,i),o&&o(n)})}function bd(t){var e=t.Ga;t.P&&e&&t.Da("auth",{cred:e.vd},function(i){var n=i.s,i=i.d||"error";"ok"!==n&&t.Ga===e&&delete t.Ga,t.wb("ok"===n),e.Zc?"ok"!==n&&e.Ob&&e.Ob(n,i):(e.Zc=k,e.W&&e.W(n,i))})}function cd(t,e,i,n){e=e.toString(),ad(t,e,i)&&t.P&&(t.e("Unlisten on "+e+" for "+i),e={p:e},n=jb(n,function(t){return Ia(t)}),"{}"!==i&&(e.q=n),t.Da("u",e))}function dd(t,e,i,n){t.P?ed(t,"o",e,i,n):t.xb.push({Jc:e,action:"o",data:i,C:n})}function ed(t,e,i,n,o){i={p:i,d:n},t.e("onDisconnect "+e,i),t.Da(e,i,function(t){o&&setTimeout(function(){o(t.s)},0)})}function fd(t,e,i,n,o,s){i={p:i,d:n},u(s)&&(i.h=s),t.U.push({action:e,hd:i,C:o}),t.Ab++,e=t.U.length-1,t.P&&gd(t,e)}function gd(t,e){var i=t.U[e].action,n=t.U[e].hd,o=t.U[e].C;
t.U[e].Jd=t.P,t.Da(i,n,function(n){t.e(i+" response",n),delete t.U[e],t.Ab--,0===t.Ab&&(t.U=[]),o&&o(n.s)})}function Yc(t,e){z(!t.ia,"Scheduling a connect when we're already connected/ing?"),t.Ta&&clearTimeout(t.Ta),t.Ta=setTimeout(function(){if(t.Ta=l,t.Na){t.e("Making a connection attempt"),t.Cc=(new Date).getTime(),t.rb=l;var e=w(t.Vb,t),i=w(t.yb,t),n=w(t.dd,t),s=t.id+":"+Zc++;t.ia=new Oc(s,t.K,e,i,n,function(e){N(e+" ("+t.K.toString()+")"),t.Na=o})}},e)}function ad(t,e,i){e=new K(e).toString(),i||(i="{}");var n=t.fa[e][i];return delete t.fa[e][i],n}function hd(){this.o=this.D=l}function id(t,e,i){if(e.f())t.D=i,t.o=l;else if(t.D!==l)t.D=t.D.xa(e,i);else{t.o==l&&(t.o=new Cc);var n=F(e);t.o.contains(n)||t.o.add(n,new hd),t=t.o.get(n),e=Ka(e),id(t,e,i)}}function jd(t,e){if(e.f())return t.D=l,t.o=l,k;if(t.D!==l){if(t.D.N())return o;var i=t.D;return t.D=l,i.w(function(e,i){id(t,new K(e),i)}),jd(t,e)}return t.o!==l?(i=F(e),e=Ka(e),t.o.contains(i)&&jd(t.o.get(i),e)&&t.o.remove(i),t.o.f()?(t.o=l,k):o):k}function kd(t,e,i){t.D!==l?i(e,t.D):t.w(function(t,n){var o=new K(e.toString()+"/"+t);kd(n,o,i)})}function ld(){this.qa=P}function U(t,e){return t.qa.Q(e)}function V(t,e,i){t.qa=t.qa.xa(e,i)}function md(){this.ra=new ld,this.I=new ld,this.la=new ld,this.Cb=new Na}function nd(t,e){for(var i=U(t.ra,e),n=U(t.I,e),s=L(t.Cb,e),r=o,a=s;a!==l;){if(a.k()!==l){r=k;break}a=a.parent()}return r?o:(i=od(i,n,s),i!==n?(V(t.I,e,i),k):o)}function od(t,e,i){return i.f()?t:i.k()!==l?e:(t=t||P,i.w(function(n){var n=n.name(),o=t.M(n),s=e.M(n),r=L(i,n),o=od(o,s,r);t=t.G(n,o)}),t)}function pd(t,e){ib(e,function(e){var i=e.Od,e=L(t.Cb,e.path),n=e.k();z(n!==l,"pendingPut should not be null."),n===i&&M(e,l)})}function qd(){this.Ua=[]}function rd(t,e){if(0!==e.length)for(var i=0;i<e.length;i++)t.Ua.push(e[i])}function sd(t){var e=t.W,i=t.md,n=t.Eb;ac(function(){e(i,n)})}function W(t,e,i,n){this.type=t,this.sa=e,this.aa=i,this.Eb=n}function td(t){this.J=t,this.ma=[],this.uc=new qd}function ud(t,e,i,n,o){t.ma.push({type:e,W:i,cancel:n,T:o});var n=[],s=vd(t.i);t.pb&&s.push(new W("value",t.i));for(var r=0;r<s.length;r++)if(s[r].type===e){var a=new J(t.J.n,t.J.path);s[r].aa&&(a=a.F(s[r].aa)),n.push({W:o?w(i,o):i,md:new S(s[r].sa,a),Eb:s[r].Eb})}rd(t.uc,n)}function wd(t,e){for(var i=[],n=0;n<e.length;n++){var o=e[n],s=o.type,r=new J(t.J.n,t.J.path);for(e[n].aa&&(r=r.F(e[n].aa)),r=new S(e[n].sa,r),"value"!==o.type||r.nb()?"value"!==o.type&&(s+=" "+r.name()):s+="("+r.V()+")",Nb(t.J.n.u.id+": event:"+t.J.path+":"+t.J.La()+":"+s),s=0;s<t.ma.length;s++){var a=t.ma[s];e[n].type===a.type&&i.push({W:a.T?w(a.W,a.T):a.W,md:r,Eb:o.Eb})}}rd(t.uc,i)}function vd(t){var e=[];if(!t.N()){var i=l;t.w(function(t,n){e.push(new W("child_added",n,t,i)),i=t})}return e}function xd(t){t.pb||(t.pb=k,wd(t,[new W("value",t.i)]))}function zd(t,e){td.call(this,t),this.i=e}function Ad(t,e){this.Pb=t,this.Dc=e}function Bd(t,e,i,n,s){var r=t.Q(i),a=e.Q(i),n=new Ad(n,s),s=Cd(n,i,r,a),a=!r.f()&&!a.f()&&r.j()!==a.j();if(s||a)for(r=i,i=s;r.parent()!==l;){var u=t.Q(r),s=e.Q(r),c=r.parent();if(!n.Pb||L(n.Pb,c).k()){var h=e.Q(c),p=[],r=r.Z<r.m.length?r.m[r.m.length-1]:l;u.f()?(u=h.da(r,s),p.push(new W("child_added",s,r,u))):s.f()?p.push(new W("child_removed",u,r)):(u=h.da(r,s),a&&p.push(new W("child_moved",s,r,u)),i&&p.push(new W("child_changed",s,r,u))),n.Dc(c,h,p)}a&&(a=o,i=k),r=c}}function Cd(t,e,i,n){var s,r=[];return i===n?s=o:i.N()&&n.N()?s=i.k()!==n.k():i.N()?(Dd(t,e,P,n,r),s=k):n.N()?(Dd(t,e,i,P,r),s=k):s=Dd(t,e,i,n,r),s?t.Dc(e,n,r):i.j()!==n.j()&&t.Dc(e,n,l),s}function Dd(t,e,i,n,s){var r,a,c,h,p=o,f=!t.Pb||!L(t.Pb,e).f(),d=[],m=[],v=[],g=[],y={},b={};for(r=i.Va(),c=Wa(r),a=n.Va(),h=Wa(a);c!==l||h!==l;)if(i=c===l?1:h===l?-1:c.key===h.key?0:dc({name:c.key,ha:c.value.j()},{name:h.key,ha:h.value.j()}),0>i?(p=ua(y,c.key),u(p)?(v.push({wc:c,Qc:d[p]}),d[p]=l):(b[c.key]=m.length,m.push(c)),p=k,c=Wa(r)):(i>0?(p=ua(b,h.key),u(p)?(v.push({wc:m[p],Qc:h}),m[p]=l):(y[h.key]=d.length,d.push(h)),p=k):(i=e.F(h.key),(i=Cd(t,i,c.value,h.value))&&(g.push(h),p=k),c.value.j()!==h.value.j()&&(v.push({wc:c,Qc:h}),p=k),c=Wa(r)),h=Wa(a)),!f&&p)return k;for(f=0;f<m.length;f++)(y=m[f])&&(i=e.F(y.key),Cd(t,i,y.value,P),s.push(new W("child_removed",y.value,y.key)));for(f=0;f<d.length;f++)(y=d[f])&&(i=e.F(y.key),m=n.da(y.key,y.value),Cd(t,i,P,y.value),s.push(new W("child_added",y.value,y.key,m)));for(f=0;f<v.length;f++)y=v[f].wc,d=v[f].Qc,i=e.F(d.key),m=n.da(d.key,d.value),s.push(new W("child_moved",d.value,d.key,m)),(i=Cd(t,i,y.value,d.value))&&g.push(d);for(f=0;f<g.length;f++)t=g[f],m=n.da(t.key,t.value),s.push(new W("child_changed",t.value,t.key,m));return p}function Ed(){this.S=this.wa=l,this.set={}}function Fd(t){return t.contains("default")}function Gd(t){return t.wa!=l&&Fd(t)}function Hd(t,e){td.call(this,t),this.i=P,this.ac(e,vd(e))}function Id(t,e,i,n){if(t.N())return l;var o=l;return(n?t.vc:t.w).call(t,function(t,n){return Jd(e,t,n)&&(o=t,i--,0===i)?k:void 0}),o}function Jd(t,e,i){for(var n=0;n<t.length;n++)if(!t[n](e,i.j()))return o;return k}function Kd(t,e){this.u=t,this.g=e,this.Tb=e.qa,this.ka=new Na}function Nd(t,e,i,n,s){var r,a=t.get(e);if(r=a){r=o;for(var u=a.ma.length-1;u>=0;u--){var c=a.ma[u];if(!(i&&c.type!==i||n&&c.W!==n||s&&c.T!==s)&&(a.ma.splice(u,1),r=k,i&&n))break}r=r&&!(0<a.ma.length)}return(i=r)&&t.remove(e),i}function Od(t,e,i,n,s,r){var a=e.path(),a=L(t.ka,a),i=i?i.La():l,u=[];if(i&&"default"!==i?Nd(e,i,n,s,r)&&u.push(i):ib(e.keys(),function(t){Nd(e,t,n,s,r)&&u.push(t)}),e.f()&&M(a,l),i=Ld(a),0<u.length&&!i){for(var c=a,h=a.parent(),i=o;!i&&h;){var p=h.k();if(p){z(!Gd(p));var f=c.name(),d=o;Dc(p,function(t,e){d=e.zc(f)||d}),d&&(i=k)}c=h,h=h.parent()}if(c=l,!Gd(e)){h=e.wa,e.wa=l;var m=[],v=function(e){var i=e.k();if(i&&Fd(i))m.push(i.path()),i.wa==l&&i.setActive(Md(t,i));else{if(i){i.wa!=l||i.setActive(Md(t,i));var n={};Dc(i,function(t,e){e.i.w(function(t){D(n,t)||(n[t]=k,t=i.path().F(t),m.push(t))})})}e.w(v)}};v(a),c=m,h&&h()}return i?l:c}return l}function Pd(t,e,i){Pa(L(t.ka,e),function(t){(t=t.k())&&Dc(t,function(t,e){xd(e)})},i,k)}function Qd(t,e,i){function n(t){do{if(a[t.toString()])return k;t=t.parent()}while(t!==l);return o}var s=t.Tb,r=t.g.qa;t.Tb=r;for(var a={},u=0;u<i.length;u++)a[i[u].toString()]=k;Bd(s,r,e,t.ka,function(i,s,r){if(e.contains(i)){var a=n(i);a&&Pd(t,i,o),t.$b(i,s,r),a&&Pd(t,i,k)}else t.$b(i,s,r)}),n(e)&&Pd(t,e,k),Rd(t,e)}function Rd(t,e){var i=L(t.ka,e);Pa(i,function(t){(t=t.k())&&Dc(t,function(t,e){e.Fb()})},k,k),Qa(i,function(t){(t=t.k())&&Dc(t,function(t,e){e.Fb()})},o)}function Ld(t){return Qa(t,function(t){return t.k()&&Gd(t.k())})}function Md(t,e){if(t.u){var i,n=t.u,o=e.path(),s=e.toString(),r=e.$a(),a=e.keys(),u=Fd(e),c=t.u,h=function(n){if("ok"!==n){var o="Unknown Error";"too_big"===n?o="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==n?o="Client doesn't have permission to access the desired data.":"unavailable"==n&&(o="The service is unavailable");var s=Error(n+": "+o);s.code=n.toUpperCase(),N("on() or once() for "+e.path().toString()+" failed: "+s.toString()),e&&(Dc(e,function(t,e){for(var i=0;i<e.ma.length;i++){var n=e.ma[i];n.cancel&&(n.T?w(n.cancel,n.T):n.cancel)(s)}}),Od(t,e))}else i||(u?Pd(t,e.path(),k):ib(a,function(t){(t=e.get(t))&&xd(t)}),Rd(t,e.path()))},l=e.toString(),p=e.path().toString();return c.fa[p]=c.fa[p]||{},z(!c.fa[p][l],"listen() called twice for same path/queryId."),c.fa[p][l]={$a:e.$a(),C:h},c.P&&$c(c,p,l,e.$a(),h),function(){i=k,cd(n,o,s,r)}}return ca}function Sd(t,e,i,n,o){var s=e.path(),e=t.lb(s,e,n,o),r=P,a=[];return Yb(e,function(e,u){var c=new K(u);3===e||1===e?r=r.G(u,n.Q(c)):(2===e&&a.push({path:s.F(u),oa:P}),a=a.concat(Td(t,n.Q(c),L(i,c),o)))}),[{path:s,oa:r}].concat(a)}function Ud(t,e,i,n){var o;t:{var s=L(t.ka,e);o=s.parent();for(var r=[];o!==l;){var a=o.k();if(a!==l){if(Fd(a)){o=[{path:e,oa:i}];break t}if(a=t.lb(e,a,i,n),s=ua(a,s.name()),3===s||1===s){o=[{path:e,oa:i}];break t}2===s&&r.push({path:e,oa:P})}s=o,o=o.parent()}o=r}return 1!=o.length||o[0].oa.f()&&!i.f()?(r=L(t.ka,e),s=r.k(),s!==l?Fd(s)?o.push({path:e,oa:i}):o=o.concat(Sd(t,s,r,i,n)):o=o.concat(Td(t,i,r,n)),o):o}function Td(t,e,i,n){var o=i.k();if(o!==l)return Fd(o)?[{path:i.path(),oa:e}]:Sd(t,o,i,e,n);var s=[];return i.w(function(i){var o=e.N()?P:e.M(i.name()),i=Td(t,o,i,n);s=s.concat(i)}),s}function Vd(t,e){return t&&"object"==typeof t?(z(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t}function Wd(t,e){var i,n=Vd(t.j(),e);if(t.N()){var o=Vd(t.k(),e);return o!==t.k()||n!==t.j()?new bc(o,n):t}return i=t,n!==t.j()&&(i=i.Ea(n)),t.w(function(t,n){var o=Wd(n,e);o!==n&&(i=i.G(t,o))}),i}function Xd(t){this.K=t,this.$=xc(t),this.u=new Wc(this.K,w(this.Wb,this),w(this.Ub,this),w(this.wb,this),w(this.Hc,this),w(this.yc,this));var e=w(function(){return new uc(this.$,this.u)},this),t=t.toString();wc[t]||(wc[t]=e()),this.nd=wc[t],this.fb=new Na,this.gb=new ld,this.g=new md,this.H=new Kd(this.u,this.g.la),this.Ac=new ld,this.Bc=new Kd(l,this.Ac),Yd(this,"connected",o),Yd(this,"authenticated",o),this.R=new hd,this.tc=0}function Zd(t){return t=U(t.Ac,new K(".info/serverTimeOffset")).V()||0,(new Date).getTime()+t}function $d(t){return t=t={timestamp:Zd(t)},t.timestamp=t.timestamp||(new Date).getTime(),t}function Yd(t,e,i){e=new K("/.info/"+e),V(t.Ac,e,R(i)),Qd(t.Bc,e,[e])}function ce(t,e,i,n){var o=R(i);dd(t.u,e.toString(),o.V(k),function(i){"ok"===i&&id(t.R,e,o),X(n,i)})}function de(t){sc(t.$,"deprecated_on_disconnect"),t.nd.Pc.deprecated_on_disconnect=k}function X(t,e,i){t&&ac(function(){if("ok"==e)t(l,i);else{var n=(e||"error").toUpperCase(),o=n;i&&(o+=": "+i),o=Error(o),o.code=n,t(o)}})}function ee(t,e){var i=e||t.fb;if(e||fe(t,i),i.k()!==l){var n=ge(t,i);if(z(0<n.length),2!==n[0].status&&4!==n[0].status){for(var o=i.path(),s=0;s<n.length;s++)z(1===n[s].status,"tryToSendTransactionQueue_: items in queue should all be run."),n[s].status=2,n[s].kd++;i=U(t.g.I,o).hash(),V(t.g.I,o,U(t.g.la,o));for(var r=U(t.gb,o).V(k),a=Hb(),u={},c=0;c<n.length;c++)n[c].nc&&(u[n[c].path.toString()]=n[c].path);var h,p=[];for(h in u)p.push(u[h]);for(s=0;s<p.length;s++)M(L(t.g.Cb,p[s]),a);t.u.put(o.toString(),r,function(e){for(t.e("transaction put response",{path:o.toString(),status:e}),s=0;s<p.length;s++){var i=L(t.g.Cb,p[s]),r=i.k();z(r!==l,"sendTransactionQueue_: pendingPut should not be null."),r===a&&(M(i,l),V(t.g.I,p[s],U(t.g.ra,p[s])))}if("ok"===e){for(e=[],s=0;s<n.length;s++)n[s].status=3,n[s].C&&(i=he(t,n[s].path),e.push(w(n[s].C,l,l,k,i))),n[s].kc();for(fe(t,L(t.fb,o)),ee(t),s=0;s<e.length;s++)ac(e[s])}else{if("datastale"===e)for(s=0;s<n.length;s++)n[s].status=4===n[s].status?5:1;else for(N("transaction at "+o+" failed: "+e),s=0;s<n.length;s++)n[s].status=5,n[s].lc=e;e=ae(t,o),Qd(t.H,e,[o])}},i)}}else i.nb()&&i.w(function(e){ee(t,e)})}function ae(t,e){var i=ie(t,e),n=i.path(),s=ge(t,i);if(V(t.g.la,n,U(t.g.I,n)),V(t.gb,n,U(t.g.I,n)),0!==s.length){for(var r=i=U(t.g.la,n),a=[],c=0;c<s.length;c++){var h,p=La(n,s[c].path),f=o;if(z(p!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),5===s[c].status)f=k,h=s[c].lc;else if(1===s[c].status)if(25<=s[c].kd)f=k,h="maxretry";else{var d=s[c].update(i.Q(p).V());u(d)?(za("transaction failed: Data returned ",d),d=R(d),i=i.xa(p,d),s[c].nc&&(r=r.xa(p,d))):(f=k,h="nodata")}f&&(s[c].status=3,setTimeout(s[c].kc,0),s[c].C&&(f=new J(t,s[c].path),p=new S(i.Q(p),f),"nodata"===h?a.push(w(s[c].C,l,l,o,p)):a.push(w(s[c].C,l,Error(h),o,p))))}for(h=U(t.g.I,n).j(),i=i.Ea(h),r=r.Ea(h),V(t.gb,n,i),V(t.g.la,n,r),fe(t,t.fb),c=0;c<a.length;c++)ac(a[c]);ee(t)}return n}function ie(t,e){for(var i,n=t.fb;(i=F(e))!==l&&n.k()===l;)n=L(n,i),e=Ka(e);return n}function ge(t,e){var i=[];return je(t,e,i),i.sort(function(t,e){return t.ed-e.ed}),i}function je(t,e,i){var n=e.k();if(n!==l)for(var o=0;o<n.length;o++)i.push(n[o]);e.w(function(e){je(t,e,i)})}function fe(t,e){var i=e.k();if(i){for(var n=0,o=0;o<i.length;o++)3!==i[o].status&&(i[n]=i[o],n++);i.length=n,M(e,0<i.length?i:l)}e.w(function(e){fe(t,e)})}function be(t,e){var i=ie(t,e).path(),n=L(t.fb,e);return Qa(n,function(t){ke(t)}),ke(n),Pa(n,function(t){ke(t)}),i}function ke(t){var e=t.k();if(e!==l){for(var i=[],n=-1,s=0;s<e.length;s++)4!==e[s].status&&(2===e[s].status?(z(n===s-1,"All SENT items should be at beginning of queue."),n=s,e[s].status=4,e[s].lc="set"):(z(1===e[s].status),e[s].kc(),e[s].C&&i.push(w(e[s].C,l,Error("set"),o,l))));for(-1===n?M(t,l):e.length=n+1,s=0;s<i.length;s++)ac(i[s])}}function he(t,e){var i=new J(t,e);return new S(U(t.gb,e),i)}function Y(){this.ab={}}function $(t,e,i){this.Gb=t,this.S=e,this.Ca=i}function J(){var t,e,i;if(arguments[0]instanceof Xd)i=arguments[0],t=arguments[1];else{A("new Firebase",1,2,arguments.length);var n=arguments[0];e=t="";var s=k,r="";if(v(n)){var a=n.indexOf("//");if(a>=0)var u=n.substring(0,a-1),n=n.substring(a+2);a=n.indexOf("/"),-1===a&&(a=n.length),t=n.substring(0,a);var n=n.substring(a+1),c=t.split(".");if(3==c.length){if(a=c[2].indexOf(":"),s=a>=0?"https"===u:k,"firebase"===c[1])Rb(t+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");else for(e=c[0],r="",n=("/"+n).split("/"),u=0;u<n.length;u++)if(0<n[u].length){a=n[u];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch(h){}r+="/"+a}e=e.toLowerCase()}else e=l}s||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&N("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),t=new qb(t,s,e),e=new K(r),s=e.toString(),(n=!v(t.host))||(n=0===t.host.length)||(n=!xa(t.ub))||(n=0!==s.length)&&(s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),n=!(v(s)&&0!==s.length&&!wa.test(s))),n&&g(Error(B("new Firebase",1,o)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')),arguments[1]?arguments[1]instanceof Y?i=arguments[1]:g(Error("Expected a valid Firebase.Context for second argument to new Firebase()")):i=Y.mb(),s=t.toString(),n=ua(i.ab,s),n||(n=new Xd(t),i.ab[s]=n),i=n,t=e}H.call(this,i,t)}function Ob(t,e){z(!e||t===k||t===o,"Can't turn on custom loggers persistently."),t===k?("undefined"!=typeof console&&("function"==typeof console.log?Lb=w(console.log,console):"object"==typeof console.log&&(Lb=function(t){console.log(t)})),e&&ob.setItem("logging_enabled","true")):t?Lb=t:(Lb=l,ob.removeItem("logging_enabled"))}var j=void 0,k=!0,l=null,o=!1,s,ba=this;Math.floor(2147483648*Math.random()).toString(36);var pa={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},qa=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,sa={},va=/[\[\].#$\/]/,wa=/[\[\].#$]/;H.prototype.Kc=function(){return A("Query.ref",0,0,arguments.length),new J(this.n,this.path)},H.prototype.ref=H.prototype.Kc,H.prototype.Ya=function(t,e){A("Query.on",2,4,arguments.length),Ea("Query.on",t,o),C("Query.on",2,e,o);var i=Ha("Query.on",arguments[2],arguments[3]);return this.n.Nb(this,t,e,i.cancel,i.T),e},H.prototype.on=H.prototype.Ya,H.prototype.vb=function(t,e,i){A("Query.off",0,3,arguments.length),Ea("Query.off",t,k),C("Query.off",2,e,k),ta("Query.off",3,i),this.n.cc(this,t,e,i)},H.prototype.off=H.prototype.vb,H.prototype.Id=function(t,e){function i(a){r&&(r=o,s.vb(t,i),e.call(n.T,a))}A("Query.once",2,4,arguments.length),Ea("Query.once",t,o),C("Query.once",2,e,o);var n=Ha("Query.once",arguments[2],arguments[3]),s=this,r=k;this.Ya(t,i,function(e){s.vb(t,i),n.cancel&&n.cancel.call(n.T,e)})},H.prototype.once=H.prototype.Id,H.prototype.Bd=function(t){return A("Query.limit",1,1,arguments.length),(!ga(t)||Math.floor(t)!==t||0>=t)&&g("Query.limit: First argument must be a positive integer."),new H(this.n,this.path,t,this.ca,this.ua,this.za,this.Sa)},H.prototype.limit=H.prototype.Bd,H.prototype.Rd=function(t,e){return A("Query.startAt",0,2,arguments.length),Da("Query.startAt",1,t,k),Fa("Query.startAt",e),u(t)||(e=t=l),new H(this.n,this.path,this.Ba,t,e,this.za,this.Sa)},H.prototype.startAt=H.prototype.Rd,H.prototype.wd=function(t,e){return A("Query.endAt",0,2,arguments.length),Da("Query.endAt",1,t,k),Fa("Query.endAt",e),new H(this.n,this.path,this.Ba,this.ca,this.ua,t,e)},H.prototype.endAt=H.prototype.wd,H.prototype.La=function(){var t=Ja(Ia(this));return"{}"===t?"default":t},s=K.prototype,s.toString=function(){for(var t="",e=this.Z;e<this.m.length;e++)""!==this.m[e]&&(t+="/"+this.m[e]);return t||"/"},s.parent=function(){if(this.Z>=this.m.length)return l;for(var t=[],e=this.Z;e<this.m.length-1;e++)t.push(this.m[e]);return new K(t,0)},s.F=function(t){for(var e=[],i=this.Z;i<this.m.length;i++)e.push(this.m[i]);if(t instanceof K)for(i=t.Z;i<t.m.length;i++)e.push(t.m[i]);else for(t=t.split("/"),i=0;i<t.length;i++)0<t[i].length&&e.push(t[i]);return new K(e,0)},s.f=function(){return this.Z>=this.m.length},s.contains=function(t){var e=0;if(this.m.length>t.m.length)return o;for(;e<this.m.length;){if(this.m[e]!==t.m[e])return o;++e}return k},s=Na.prototype,s.k=function(){return this.z.value},s.nb=function(){return 0<this.z.pc},s.f=function(){return this.k()===l&&!this.nb()},s.w=function(t){for(var e in this.z.children)t(new Na(e,this,this.z.children[e]))},s.path=function(){return new K(this.Bb===l?this.Ca:this.Bb.path()+"/"+this.Ca)},s.name=aa("Ca"),s.parent=aa("Bb"),s=Ra.prototype,s.na=function(t,e){return new Ra(this.Pa,this.ba.na(t,e,this.Pa).copy(l,l,o,l,l))},s.remove=function(t){return new Ra(this.Pa,this.ba.remove(t,this.Pa).copy(l,l,o,l,l))},s.get=function(t){for(var e,i=this.ba;!i.f();){if(e=this.Pa(t,i.key),0===e)return i.value;0>e?i=i.left:e>0&&(i=i.right)}return l},s.f=function(){return this.ba.f()},s.count=function(){return this.ba.count()},s.tb=function(){return this.ba.tb()},s.Wa=function(){return this.ba.Wa()},s.Aa=function(t){return this.ba.Aa(t)},s.Ma=function(t){return this.ba.Ma(t)},s.Va=function(t){return new Va(this.ba,t)},s=Xa.prototype,s.copy=function(t,e,i,n,o){return new Xa(t!=l?t:this.key,e!=l?e:this.value,i!=l?i:this.color,n!=l?n:this.left,o!=l?o:this.right)},s.count=function(){return this.left.count()+1+this.right.count()},s.f=r(o),s.Aa=function(t){return this.left.Aa(t)||t(this.key,this.value)||this.right.Aa(t)},s.Ma=function(t){return this.right.Ma(t)||t(this.key,this.value)||this.left.Ma(t)},s.tb=function(){return Ya(this).key},s.Wa=function(){return this.right.f()?this.key:this.right.Wa()},s.na=function(t,e,i){var n,o;return o=this,n=i(t,o.key),o=0>n?o.copy(l,l,l,o.left.na(t,e,i),l):0===n?o.copy(l,e,l,l,l):o.copy(l,l,l,l,o.right.na(t,e,i)),Za(o)},s.remove=function(t,e){var i,n;if(i=this,0>e(t,i.key))!i.left.f()&&!i.left.O()&&!i.left.left.O()&&(i=cb(i)),i=i.copy(l,l,l,i.left.remove(t,e),l);else{if(i.left.O()&&(i=db(i)),!i.right.f()&&!i.right.O()&&!i.right.left.O()&&(i=eb(i),i.left.left.O()&&(i=db(i),i=eb(i))),0===e(t,i.key)){if(i.right.f())return Ta;n=Ya(i.right),i=i.copy(n.key,n.value,l,l,bb(i.right))}i=i.copy(l,l,l,l,i.right.remove(t,e))}return Za(i)},s.O=aa("color"),s=gb.prototype,s.copy=function(){return this},s.na=function(t,e){return new Xa(t,e,j,j,j)},s.remove=function(){return this},s.count=r(0),s.f=r(k),s.Aa=r(o),s.Ma=r(o),s.tb=r(l),s.Wa=r(l),s.O=r(o);var Ta=new gb,hb=Array.prototype,ib=hb.forEach?function(t,e,i){hb.forEach.call(t,e,i)}:function(t,e,i){for(var n=t.length,o=v(t)?t.split(""):t,s=0;n>s;s++)s in o&&e.call(i,o[s],s,t)},jb=hb.map?function(t,e,i){return hb.map.call(t,e,i)}:function(t,e,i){for(var n=t.length,o=Array(n),s=v(t)?t.split(""):t,r=0;n>r;r++)r in s&&(o[r]=e.call(i,s[r],r,t));return o};ka(lb,kb),lb.prototype.reset=function(){this.B[0]=1732584193,this.B[1]=4023233417,this.B[2]=2562383102,this.B[3]=271733878,this.B[4]=3285377520,this.Sc=this.ob=0},lb.prototype.update=function(t,e){u(e)||(e=t.length);var i=this.oc,n=this.ob,o=0;if(v(t))for(;e>o;)i[n++]=t.charCodeAt(o++),64==n&&(mb(this,i),n=0);else for(;e>o;)i[n++]=t[o++],64==n&&(mb(this,i),n=0);this.ob=n,this.Sc+=e},nb.prototype.setItem=function(t,e){D(this.Oa,t)||(this.length+=1),this.Oa[t]=e},nb.prototype.getItem=function(t){return D(this.Oa,t)?this.Oa[t]:l},nb.prototype.removeItem=function(t){D(this.Oa,t)&&(this.length-=1,delete this.Oa[t])};var ob=l;try{"undefined"!=typeof sessionStorage&&(sessionStorage.setItem("firebase-sentinel","cache"),sessionStorage.removeItem("firebase-sentinel"),ob=sessionStorage)}catch(pb){}ob=ob||new nb,qb.prototype.toString=function(){return(this.ec?"https://":"http://")+this.host};var sb,tb,ub,vb;vb=ub=tb=sb=o;var xb;if(xb=wb()){var yb=ba.navigator;sb=0==xb.indexOf("Opera"),tb=!sb&&-1!=xb.indexOf("MSIE"),ub=!sb&&-1!=xb.indexOf("WebKit"),vb=!sb&&!ub&&"Gecko"==yb.product}var zb=tb,Ab=vb,Bb=ub,Cb;if(sb&&ba.opera){var Db=ba.opera.version;"function"==typeof Db&&Db()}else Ab?Cb=/rv\:([^\);]+)(\)|;)/:zb?Cb=/MSIE\s+([^\);]+)(\)|;)/:Bb&&(Cb=/WebKit\/(\S+)/),Cb&&Cb.exec(wb());var Eb=l,Fb=l,Hb,Ib=1;Hb=function(){return Ib++};var Lb=l,Mb=k,$b=/^-?\d{1,10}$/;s=bc.prototype,s.N=r(k),s.j=aa("Za"),s.Ea=function(t){return new bc(this.D,t)},s.M=function(){return P},s.Q=function(t){return F(t)===l?this:P},s.da=r(l),s.G=function(t,e){return(new Q).G(t,e).Ea(this.Za)},s.xa=function(t,e){var i=F(t);return i===l?e:this.G(i,P.xa(Ka(t),e))},s.f=r(o),s.Sb=r(0),s.V=function(t){return t&&this.j()!==l?{".value":this.k(),".priority":this.j()}:this.k()},s.hash=function(){var t="";this.j()!==l&&(t+="priority:"+cc(this.j())+":");var e=typeof this.D,t=t+(e+":"),t="number"===e?t+Zb(this.D):t+this.D;return Jb(t)},s.k=aa("D"),s.toString=function(){return"string"==typeof this.D?'"'+this.D+'"':this.D},s=Q.prototype,s.N=r(o),s.j=aa("Za"),s.Ea=function(t){return new Q(this.o,t)},s.G=function(t,e){var i=this.o.remove(t);return e&&e.f()&&(e=l),e!==l&&(i=i.na(t,e)),e&&e.j()!==l?new gc(i,l,this.Za):new Q(i,this.Za)},s.xa=function(t,e){var i=F(t);if(i===l)return e;var n=this.M(i).xa(Ka(t),e);return this.G(i,n)},s.f=function(){return this.o.f()},s.Sb=function(){return this.o.count()};var hc=/^\d+$/;s=Q.prototype,s.V=function(t){if(this.f())return l;var e={},i=0,n=0,s=k;if(this.w(function(r,a){e[r]=a.V(t),i++,s&&hc.test(r)?n=Math.max(n,Number(r)):s=o}),!t&&s&&2*i>n){var r,a=[];for(r in e)a[r]=e[r];return a}return t&&this.j()!==l&&(e[".priority"]=this.j()),e},s.hash=function(){var t="";return this.j()!==l&&(t+="priority:"+cc(this.j())+":"),this.w(function(e,i){var n=i.hash();""!==n&&(t+=":"+e+":"+n)}),""===t?"":Jb(t)},s.M=function(t){return t=this.o.get(t),t===l?P:t},s.Q=function(t){var e=F(t);return e===l?this:this.M(e).Q(Ka(t))},s.da=function(t){return Ua(this.o,t)},s.$c=function(){return this.o.tb()},s.ad=function(){return this.o.Wa()},s.w=function(t){return this.o.Aa(t)},s.vc=function(t){return this.o.Ma(t)},s.Va=function(){return this.o.Va()},s.toString=function(){var t="{",e=k;return this.w(function(i,n){e?e=o:t+=", ",t+='"'+i+'" : '+n.toString()}),t+="}"};var P=new Q;ka(gc,Q),s=gc.prototype,s.G=function(t,e){var i=this.M(t),n=this.o,o=this.ta;return i!==l&&(n=n.remove(t),o=o.remove({name:t,ha:i.j()})),e&&e.f()&&(e=l),e!==l&&(n=n.na(t,e),o=o.na({name:t,ha:e.j()},e)),new gc(n,o,this.j())},s.da=function(t,e){var i=Ua(this.ta,{name:t,ha:e.j()});return i?i.name:l},s.w=function(t){return this.ta.Aa(function(e,i){return t(e.name,i)})},s.vc=function(t){return this.ta.Ma(function(e,i){return t(e.name,i)})},s.Va=function(){return this.ta.Va(function(t,e){return{key:t.name,value:e}})},s.$c=function(){return this.ta.f()?l:this.ta.tb().name},s.ad=function(){return this.ta.f()?l:this.ta.Wa().name};var jc=Math.log(2);S.prototype.V=function(){return A("Firebase.DataSnapshot.val",0,0,arguments.length),this.z.V()},S.prototype.val=S.prototype.V,S.prototype.xd=function(){return A("Firebase.DataSnapshot.exportVal",0,0,arguments.length),this.z.V(k)},S.prototype.exportVal=S.prototype.xd,S.prototype.F=function(t){A("Firebase.DataSnapshot.child",0,1,arguments.length),ga(t)&&(t=String(t)),Ga("Firebase.DataSnapshot.child",t);var e=new K(t),i=this.bc.F(e);return new S(this.z.Q(e),i)},S.prototype.child=S.prototype.F,S.prototype.zc=function(t){A("Firebase.DataSnapshot.hasChild",1,1,arguments.length),Ga("Firebase.DataSnapshot.hasChild",t);var e=new K(t);return!this.z.Q(e).f()},S.prototype.hasChild=S.prototype.zc,S.prototype.j=function(){return A("Firebase.DataSnapshot.getPriority",0,0,arguments.length),this.z.j()},S.prototype.getPriority=S.prototype.j,S.prototype.forEach=function(t){if(A("Firebase.DataSnapshot.forEach",1,1,arguments.length),C("Firebase.DataSnapshot.forEach",1,t,o),this.z.N())return o;var e=this;return this.z.w(function(i,n){return t(new S(n,e.bc.F(i)))})},S.prototype.forEach=S.prototype.forEach,S.prototype.nb=function(){return A("Firebase.DataSnapshot.hasChildren",0,0,arguments.length),this.z.N()?o:!this.z.f()},S.prototype.hasChildren=S.prototype.nb,S.prototype.name=function(){return A("Firebase.DataSnapshot.name",0,0,arguments.length),this.bc.name()},S.prototype.name=S.prototype.name,S.prototype.Sb=function(){return A("Firebase.DataSnapshot.numChildren",0,0,arguments.length),this.z.Sb()},S.prototype.numChildren=S.prototype.Sb,S.prototype.Kc=function(){return A("Firebase.DataSnapshot.ref",0,0,arguments.length),this.bc},S.prototype.ref=S.prototype.Kc,mc.prototype.xc=function(){},mc.prototype.Uc=function(t){for(var e=this.sb[t]||[],i=0;i<e.length;i++)e[i].W.apply(e[i].T,Array.prototype.slice.call(arguments,1))},mc.prototype.Ya=function(t,e,i){nc(this,t),this.sb[t]=this.sb[t]||[],this.sb[t].push({W:e,T:i}),(t=this.xc(t))&&e.apply(i,t)},mc.prototype.vb=function(t,e,i){nc(this,t);for(var t=this.sb[t]||[],n=0;n<t.length;n++)if(t[n].W===e&&(!i||i===t[n].T)){t.splice(n,1);break}},ka(oc,mc),da(oc),oc.prototype.xc=function(t){return z("visible"===t),[this.hb]},rc.prototype.get=function(){return qc(this.jb)},tc.prototype.get=function(){var t=this.ud.get(),e=qc(t);if(this.Qb)for(var i in this.Qb)e[i]-=this.Qb[i];return this.Qb=t,e},uc.prototype.gd=function(){var t,e=this.hc.get(),i={},n=o;for(t in e)0<e[t]&&D(this.Pc,t)&&(i[t]=e[t],n=k);n&&(e=this.u,e.P&&(i={c:i},e.e("reportStats",i),e.Da("s",i))),setTimeout(w(this.gd,this),6e5*Math.random())};var vc={},wc={},yc=l;"undefined"!=typeof MozWebSocket?yc=MozWebSocket:"undefined"!=typeof WebSocket&&(yc=WebSocket);var zc;T.prototype.open=function(t,e){this.ga=e,this.Fd=t,this.e("websocket connecting to "+this.Qa),this.Y=new yc(this.Qa),this.kb=o;var i=this;this.Y.onopen=function(){i.e("Websocket connected."),i.kb=k},this.Y.onclose=function(){i.e("Websocket connection was disconnected."),i.Y=l,i.Ka()},this.Y.onmessage=function(t){if(i.Y!==l)if(t=t.data,sc(i.$,"bytes_received",t.length),Ac(i),i.frames!==l)Bc(i,t);else{t:{if(z(i.frames===l,"We already have a frame buffer"),6>=t.length){var e=Number(t);if(!isNaN(e)){i.Rc=e,i.frames=[],t=l;break t}}i.Rc=1,i.frames=[]}t!==l&&Bc(i,t)}},this.Y.onerror=function(t){i.e("WebSocket error.  Closing connection."),t.data&&i.e(t.data),i.Ka()}},T.prototype.start=function(){},T.isAvailable=function(){var t=o;if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);e&&1<e.length&&4.4>parseFloat(e[1])&&(t=k)}return!t&&yc!==l&&!zc},T.prototype.send=function(t){Ac(this),t=y(t),sc(this.$,"bytes_sent",t.length),t=Wb(t,16384),1<t.length&&this.Y.send(String(t.length));for(var e=0;e<t.length;e++)this.Y.send(t[e])},T.prototype.Jb=function(){this.Ia=k,this.qb&&(clearInterval(this.qb),this.qb=l),this.Y&&(this.Y.close(),this.Y=l)},T.prototype.Ka=function(){this.Ia||(this.e("WebSocket is closing itself"),this.Jb(),this.ga&&(this.ga(this.kb),this.ga=l))},T.prototype.close=function(){this.Ia||(this.e("WebSocket is being closed"),this.Jb())},s=Cc.prototype,s.add=function(t,e){this.set[t]=e!==l?e:k},s.contains=function(t){return D(this.set,t)},s.get=function(t){return this.contains(t)?this.set[t]:j},s.remove=function(t){delete this.set[t]},s.f=function(){var t;t:{for(t in this.set){t=o;break t}t=k}return t},s.count=function(){var t,e=0;for(t in this.set)e++;return e},s.keys=function(){var t,e=[];for(t in this.set)D(this.set,t)&&e.push(t);return e};var Ec="pLPCommand",Fc="pRTLPCB",Hc,Ic;Gc.prototype.open=function(t,e){function i(){if(!n.Ia){n.ja=new Jc(function(t,e,i){if(sc(n.$,"bytes_received",y(arguments).length),n.ja)if(n.Fa&&(clearTimeout(n.Fa),n.Fa=l),n.kb=k,"start"==t)n.id=e,n.fd=i;else if("close"===t)if(e){n.ja.fc=o;var s=n.cd;s.qc=e,s.Ja=function(){n.Ka()},s.qc<s.Ra&&(s.Ja(),s.Ja=l)}else n.Ka();else g(Error("Unrecognized command received: "+t))},function(t,e){sc(n.$,"bytes_received",y(arguments).length);var i=n.cd;for(i.Zb[t]=e;i.Zb[i.Ra];){var o=i.Zb[i.Ra];delete i.Zb[i.Ra];for(var s=0;s<o.length;++s)if(o[s]){var r=i;ac(function(){r.Gc(o[s])})}if(i.Ra===i.qc){i.Ja&&(clearTimeout(i.Ja),i.Ja(),i.Ja=l);break}i.Ra++}},function(){n.Ka()},n.Mb);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.ja.jc&&(t.cb=n.ja.jc),t.v="5",n.gc&&(t.s=n.gc),t=n.Mb(t),n.e("Connecting via long-poll to "+t),Kc(n.ja,t,function(){})}}this.Wc=0,this.R=e,this.cd=new pc(t),this.Ia=o;var n=this;if(this.Fa=setTimeout(function(){n.e("Timed out trying to connect."),n.Ka(),n.Fa=l},3e4),"complete"===document.readyState)i();else{var s=o,r=function(){document.body?s||(s=k,i()):setTimeout(r,10)};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,o),window.addEventListener("load",r,o)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()},o),window.attachEvent("onload",r,o))}},Gc.prototype.start=function(){var t=this.ja,e=this.fd;for(t.Dd=this.id,t.Ed=e,t.mc=k;Lc(t););t=this.id,e=this.fd,this.Xa=document.createElement("iframe");var i={dframe:"t"};i.id=t,i.pw=e,t=this.Mb(i),this.Xa.src=t,this.Xa.style.display="none",document.body.appendChild(this.Xa)},Gc.isAvailable=function(){return!(Ic||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.Td||!Hc&&!k)},Gc.prototype.Jb=function(){this.Ia=k,this.ja&&(this.ja.close(),this.ja=l),this.Xa&&(document.body.removeChild(this.Xa),this.Xa=l),this.Fa&&(clearTimeout(this.Fa),this.Fa=l)},Gc.prototype.Ka=function(){this.Ia||(this.e("Longpoll is closing itself"),this.Jb(),this.R&&(this.R(this.kb),this.R=l))},Gc.prototype.close=function(){this.Ia||(this.e("Longpoll is being closed."),this.Jb())},Gc.prototype.send=function(t){t=y(t),sc(this.$,"bytes_sent",t.length);for(var t=ra(t),t=Gb(t,k),t=Wb(t,1840),e=0;e<t.length;e++){var i=this.ja;i.Db.push({Nd:this.Wc,Sd:t.length,Yc:t[e]}),i.mc&&Lc(i),this.Wc++}},Jc.prototype.close=function(){if(this.mc=o,this.X){this.X.ya.body.innerHTML="";var t=this;setTimeout(function(){t.X!==l&&(document.body.removeChild(t.X),t.X=l)},0)}var e=this.ga;e&&(this.ga=l,e())};var Nc=[Gc,{isAvailable:r(o)},T];Oc.prototype.ld=function(t){t={t:"d",d:t},1!==this.va&&g("Connection is not connected"),this.Kb.send(t)},Oc.prototype.Vb=function(t){this.Gc(t)},Oc.prototype.close=function(){2!==this.va&&(this.e("Closing realtime connection."),this.va=2,Tc(this),this.R&&(this.R(),this.R=l))},ka(Vc,mc),da(Vc),Vc.prototype.xc=function(t){return z("online"===t),[this.zb]};var Xc=0,Zc=0;s=Wc.prototype,s.Da=function(t,e,i){var n=++this.Md,t={r:n,a:t,b:e};this.e(y(t)),z(this.P,"sendRequest_ call when we're not connected not allowed."),this.ia.ld(t),i&&(this.Hb[n]=i)},s.ib=function(t,e,i){this.Ga={vd:t,Zc:o,W:e,Ob:i},this.e("Authenticating using credential: "+this.Ga),bd(this)},s.Lb=function(t){delete this.Ga,this.wb(o),this.P&&this.Da("unauth",{},function(e){t(e.s)})},s.Ec=function(t,e){this.P?ed(this,"oc",t,l,e):this.xb.push({Jc:t,action:"oc",data:l,C:e})},s.put=function(t,e,i,n){fd(this,"p",t,e,i,n)},s.Vb=function(t){if("r"in t){this.e("from server: "+y(t));var e=t.r,i=this.Hb[e];i&&(delete this.Hb[e],i(t.b))}else"error"in t&&g("A server-side error has occurred: "+t.error),"a"in t&&(e=t.a,t=t.b,this.e("handleServerMessage",e,t),"d"===e?this.Wb(t.p,t.d):"m"===e?this.Wb(t.p,t.d,k):"c"===e?(e=t.p,t=(t=t.q)?jb(t,function(t){return Ja(t)}).join("$"):"{}",(t=ad(this,e,t))&&t.C&&t.C("permission_denied")):"ac"===e?(e=t.s,t=t.d,i=this.Ga,delete this.Ga,i&&i.Ob&&i.Ob(e,t),this.wb(o)):"sd"===e?this.Lc?this.Lc(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: ")):Qb("Unrecognized action received from server: "+y(e)+"\nAre you using the latest client?"))
},s.yb=function(t){this.e("connection ready"),this.P=k,this.rb=(new Date).getTime(),this.Hc({serverTimeOffset:t-(new Date).getTime()}),bd(this);for(var e in this.fa)for(var i in this.fa[e])t=this.fa[e][i],$c(this,e,i,t.$a,t.C);for(e=0;e<this.U.length;e++)this.U[e]&&gd(this,e);for(;this.xb.length;)e=this.xb.shift(),ed(this,e.action,e.Jc,e.data,e.C);this.Ub(k)},s.Hd=function(t){t&&!this.hb&&3e5===this.pa&&(this.e("Window became visible.  Reducing delay."),this.pa=1e3,this.ia||Yc(this,0)),this.hb=t},s.Gd=function(t){t?(this.e("Browser went online.  Reconnecting."),this.pa=1e3,this.Na=k,this.ia||Yc(this,0)):(this.e("Browser went offline.  Killing connection; don't reconnect."),this.Na=o,this.ia&&this.ia.close())},s.dd=function(){this.e("data client disconnected"),this.P=o,this.ia=l;for(var t=0;t<this.U.length;t++){var e=this.U[t];e&&"h"in e.hd&&e.Jd&&(e.C&&e.C("disconnect"),delete this.U[t],this.Ab--)}if(0===this.Ab&&(this.U=[]),this.Na)this.hb?this.rb&&(3e4<(new Date).getTime()-this.rb&&(this.pa=1e3),this.rb=l):(this.e("Window isn't visible.  Delaying reconnect."),this.pa=3e5,this.Cc=(new Date).getTime()),t=Math.max(0,this.pa-((new Date).getTime()-this.Cc)),t*=Math.random(),this.e("Trying to reconnect in "+t+"ms"),Yc(this,t),this.pa=Math.min(3e5,1.3*this.pa);else for(var i in this.Hb)delete this.Hb[i];this.Ub(o)},s.Ha=function(){this.Na=o,this.ia?this.ia.close():(this.Ta&&(clearTimeout(this.Ta),this.Ta=l),this.P&&this.dd())},s.bb=function(){this.Na=k,this.pa=1e3,this.P||Yc(this,0)},hd.prototype.w=function(t){this.o!==l&&Dc(this.o,function(e,i){t(e,i)})},ld.prototype.toString=function(){return this.qa.toString()},md.prototype.set=function(t,e){var i=this,n=[];return ib(e,function(t){var e=t.path,t=t.oa,o=Hb();M(L(i.Cb,e),o),V(i.I,e,t),n.push({path:e,Od:o})}),n},qd.prototype.Fb=function(){for(var t=0;t<this.Ua.length;t++)if(this.Ua[t]){var e=this.Ua[t];this.Ua[t]=l,sd(e)}this.Ua=[]},td.prototype.$b=function(t,e){e=this.ac(t,e),e!=l&&wd(this,e)},td.prototype.Fb=function(){this.uc.Fb()},ka(zd,td),zd.prototype.ac=function(t,e){return this.i=t,this.pb&&e!=l&&e.push(new W("value",this.i)),e},zd.prototype.lb=function(){return{}},ka(Ed,Cc),s=Ed.prototype,s.setActive=function(t){this.wa=t},s.defaultView=function(){return Fd(this)?this.get("default"):l},s.path=aa("S"),s.toString=function(){return jb(this.keys(),function(t){return"default"===t?"{}":t}).join("$")},s.$a=function(){var t=[];return Dc(this,function(e,i){t.push(i.J)}),t},ka(Hd,td),Hd.prototype.ac=function(t,e){if(e===l)return e;var i=[],n=this.J;u(n.ca)&&(u(n.ua)&&n.ua!=l?i.push(function(t,e){var i=Sb(e,n.ca);return i>0||0===i&&0<=Tb(t,n.ua)}):i.push(function(t,e){return 0<=Sb(e,n.ca)})),u(n.za)&&(u(n.Sa)?i.push(function(t,e){var i=Sb(e,n.za);return 0>i||0===i&&0>=Tb(t,n.Sa)}):i.push(function(t,e){return 0>=Sb(e,n.za)}));var s=l,r=l;if(u(this.J.Ba))if(u(this.J.ca)){if(s=Id(t,i,this.J.Ba,o)){var a=t.M(s).j();i.push(function(t,e){var i=Sb(e,a);return 0>i||0===i&&0>=Tb(t,s)})}}else if(r=Id(t,i,this.J.Ba,k)){var c=t.M(r).j();i.push(function(t,e){var i=Sb(e,c);return i>0||0===i&&0<=Tb(t,r)})}for(var h=[],p=[],f=[],d=[],m=0;m<e.length;m++){var v=e[m].aa,g=e[m].sa;switch(e[m].type){case"child_added":Jd(i,v,g)&&(this.i=this.i.G(v,g),p.push(e[m]));break;case"child_removed":this.i.M(v).f()||(this.i=this.i.G(v,l),h.push(e[m]));break;case"child_changed":!this.i.M(v).f()&&Jd(i,v,g)&&(this.i=this.i.G(v,g),d.push(e[m]));break;case"child_moved":var y=!this.i.M(v).f(),b=Jd(i,v,g);y?b?(this.i=this.i.G(v,g),f.push(e[m])):(h.push(new W("child_removed",this.i.M(v),v)),this.i=this.i.G(v,l)):b&&(this.i=this.i.G(v,g),p.push(e[m]))}}var w=s||r;if(w){var S=(m=r!==l)?this.i.$c():this.i.ad(),_=o,x=o,C=this;(m?t.vc:t.w).call(t,function(t,e){return!x&&S===l&&(x=k),x&&_?k:(_?(h.push(new W("child_removed",C.i.M(t),t)),C.i=C.i.G(t,l)):x&&(p.push(new W("child_added",e,t)),C.i=C.i.G(t,e)),S===t&&(x=k),t===w&&(_=k),void 0)})}for(m=0;m<p.length;m++)i=p[m],v=this.i.da(i.aa,i.sa),h.push(new W("child_added",i.sa,i.aa,v));for(m=0;m<f.length;m++)i=f[m],v=this.i.da(i.aa,i.sa),h.push(new W("child_moved",i.sa,i.aa,v));for(m=0;m<d.length;m++)i=d[m],v=this.i.da(i.aa,i.sa),h.push(new W("child_changed",i.sa,i.aa,v));return this.pb&&0<h.length&&h.push(new W("value",this.i)),h},Hd.prototype.zc=function(t){return this.i.M(t)!==P},Hd.prototype.lb=function(t,e,i){var n={};this.i.N()||this.i.w(function(t){n[t]=3});var o=this.i,i=U(i,new K("")),s=new Na;M(L(s,this.J.path),k);var e=P.xa(t,e),r=this;return Bd(i,e,t,s,function(t,e,i){i!==l&&t.toString()===r.J.path.toString()&&r.ac(e,i)}),this.i.N()?Yb(n,function(t,e){n[e]=2}):(this.i.w(function(t){D(n,t)||(n[t]=1)}),Yb(n,function(t,e){r.i.M(e).f()&&(n[e]=2)})),this.i=o,n},Kd.prototype.Nb=function(t,e,i,n,o){var s=t.path,r=L(this.ka,s),a=r.k();a===l?(a=new Ed,M(r,a)):z(!a.f(),"We shouldn't be storing empty QueryMaps");var u=t.La();if(a.contains(u))t=a.get(u),ud(t,e,i,n,o);else{var c=this.g.qa.Q(s),c=t="default"===t.La()?new zd(t,c):new Hd(t,c);if(Gd(a)||Ld(r))a.add(u,c),a.S||(a.S=c.J.path);else{var h,p;a.f()||(h=a.toString(),p=a.$a()),a.add(u,c),a.S||(a.S=c.J.path),a.setActive(Md(this,a)),h&&p&&cd(this.u,a.path(),h,p)}Gd(a)&&Pa(r,function(t){(t=t.k())&&(t.wa&&t.wa(),t.wa=l)}),ud(t,e,i,n,o),(e=(e=Qa(L(this.ka,s),function(t){var e;return(e=t.k())&&(e=t.k().defaultView())&&(e=t.k().defaultView().pb),e?k:void 0},k))||this.u===l&&!U(this.g,s).f())&&xd(t)}t.Fb()},Kd.prototype.cc=function(t,e,i,n){var o=L(this.ka,t.path).k();return o===l?l:Od(this,o,t,e,i,n)},Kd.prototype.$b=function(t,e,i){t=L(this.ka,t).k(),t!==l&&Dc(t,function(t,n){n.$b(e,i)})},Kd.prototype.lb=function(t,e,i,n){var o={};return Dc(e,function(e,s){var r=s.lb(t,i,n);Yb(r,function(t,e){o[e]=3===t?3:(ua(o,e)||t)===t?t:3})}),i.N()||i.w(function(t){D(o,t)||(o[t]=4)}),o},s=Xd.prototype,s.toString=function(){return(this.K.ec?"https://":"http://")+this.K.host},s.name=function(){return this.K.ub},s.Wb=function(t,e,i){this.tc++;var n,s,r=[];for(9<=t.length&&t.lastIndexOf(".priority")===t.length-9?(n=new K(t.substring(0,t.length-9)),s=U(this.g.ra,n).Ea(e),r.push(n)):i?(n=new K(t),s=U(this.g.ra,n),Yb(e,function(t,e){var i=new K(e);s=s.xa(i,R(t)),r.push(n.F(e))})):(n=new K(t),s=R(e),r.push(n)),t=Ud(this.H,n,s,this.g.I),e=o,i=0;i<t.length;++i){var a=t[i],u=this.g,c=a.path;V(u.ra,c,a.oa),e=nd(u,c)||e}e&&(n=ae(this,n)),Qd(this.H,n,r)},s.Ub=function(t){if(Yd(this,"connected",t),t===o){this.e("onDisconnectEvents");var e=this,i=[],n=$d(this),t=kd,s=new hd;kd(this.R,new K(""),function(t,e){id(s,t,Wd(e,n))}),t(s,new K(""),function(t,n){var o=Ud(e.H,t,n,e.g.I);i.push.apply(i,e.g.set(t,o)),o=be(e,t),ae(e,o),Qd(e.H,o,[t])}),pd(this.g,i),this.R=new hd}},s.Hc=function(t){var e=this;Xb(t,function(t,i){Yd(e,i,t)})},s.yc=function(t){return t=new K(t),U(this.g.ra,t).hash()},s.wb=function(t){Yd(this,"authenticated",t)},s.ib=function(t,e,i){"firebaseio-demo.com"===this.K.domain&&N("FirebaseRef.auth() not supported on demo (*.firebaseio-demo.com) Firebases. Please use on production (*.firebaseio.com) Firebases only."),this.u.ib(t,function(t,i){X(e,t,i)},function(t,e){if(N("auth() was canceled: "+e),i){var n=Error(e);n.code=t.toUpperCase(),i(n)}})},s.Lb=function(t){this.u.Lb(function(e){X(t,e)})},s.eb=function(t,e,i,n){this.e("set",{path:t.toString(),value:e,ha:i});var o=$d(this),e=R(e,i),o=Wd(e,o),o=Ud(this.H,t,o,this.g.I),s=this.g.set(t,o),r=this;this.u.put(t.toString(),e.V(k),function(e){"ok"!==e&&N("set at "+t+" failed: "+e),pd(r.g,s),nd(r.g,t);var i=ae(r,t);Qd(r.H,i,[]),X(n,e)}),o=be(this,t),ae(this,o),Qd(this.H,o,[t])},s.update=function(t,e,i){this.e("update",{path:t.toString(),value:e});var n,s=U(this.g.la,t),r=k,a=[],u=$d(this),c=[];for(n in e){var r=o,h=R(e[n]),h=Wd(h,u),s=s.G(n,h),l=t.F(n);a.push(l),h=Ud(this.H,l,h,this.g.I),c=c.concat(this.g.set(t,h))}if(r)Nb("update() called with empty data.  Don't do anything."),X(i,"ok");else{var p=this;fd(this.u,"m",t.toString(),e,function(e){z("ok"===e||"permission_denied"===e,"merge at "+t+" failed."),"ok"!==e&&N("update at "+t+" failed: "+e),pd(p.g,c),nd(p.g,t);var n=ae(p,t);Qd(p.H,n,[]),X(i,e)},j),e=be(this,t),ae(this,e),Qd(p.H,e,a)}},s.Mc=function(t,e,i){this.e("setPriority",{path:t.toString(),ha:e});var n=$d(this),n=Vd(e,n),n=U(this.g.I,t).Ea(n),n=Ud(this.H,t,n,this.g.I),o=this.g.set(t,n),s=this;this.u.put(t.toString()+"/.priority",e,function(t){pd(s.g,o),X(i,t)}),t=ae(this,t),Qd(s.H,t,[])},s.Ec=function(t,e){var i=this;this.u.Ec(t.toString(),function(n){"ok"===n&&jd(i.R,t),X(e,n)})},s.Nb=function(t,e,i,n,o){".info"===F(t.path)?this.Bc.Nb(t,e,i,n,o):this.H.Nb(t,e,i,n,o)},s.cc=function(t,e,i,n){if(".info"===F(t.path))this.Bc.cc(t,e,i,n);else{if(e=this.H.cc(t,e,i,n),i=e!==l){for(var i=this.g,n=t.path,o=[],s=0;s<e.length;++s)o[s]=U(i.ra,e[s]);for(V(i.ra,n,P),s=0;s<e.length;++s)V(i.ra,e[s],o[s]);i=nd(i,n)}i&&(z(this.g.la.qa===this.H.Tb,"We should have raised any outstanding events by now.  Else, we'll blow them away."),V(this.g.la,t.path,U(this.g.I,t.path)),this.H.Tb=this.g.la.qa)}},s.Ha=function(){this.u.Ha()},s.bb=function(){this.u.bb()},s.Nc=function(t){if("undefined"!=typeof console){t?(this.hc||(this.hc=new tc(this.$)),t=this.hc.get()):t=this.$.get();var e,i=t,n=[],o=0;for(e in i)n[o++]=e;var s=function(t,e){return Math.max(e.length,t)};if(n.reduce)e=n.reduce(s,0);else{var r=0;ib(n,function(t){r=s.call(j,r,t)}),e=r}for(var a in t){for(i=t[a],n=a.length;e+2>n;n++)a+=" ";console.log(a+i)}}},s.Oc=function(t){sc(this.$,t),this.nd.Pc[t]=k},s.e=function(){Nb("r:"+this.u.id+":",arguments)},da(Y),Y.prototype.Ha=function(){for(var t in this.ab)this.ab[t].Ha()},Y.prototype.interrupt=Y.prototype.Ha,Y.prototype.bb=function(){for(var t in this.ab)this.ab[t].bb()},Y.prototype.resume=Y.prototype.bb;var Z={Ad:function(t){var e=Q.prototype.hash;Q.prototype.hash=t;var i=bc.prototype.hash;return bc.prototype.hash=t,function(){Q.prototype.hash=e,bc.prototype.hash=i}}};Z.hijackHash=Z.Ad,Z.La=function(t){return t.La()},Z.queryIdentifier=Z.La,Z.Cd=function(t){return t.n.u.fa},Z.listens=Z.Cd,Z.Kd=function(t){return t.n.u.ia},Z.refConnection=Z.Kd,Z.pd=Wc,Z.DataConnection=Z.pd,Wc.prototype.sendRequest=Wc.prototype.Da,Wc.prototype.interrupt=Wc.prototype.Ha,Z.qd=Oc,Z.RealTimeConnection=Z.qd,Oc.prototype.sendRequest=Oc.prototype.ld,Oc.prototype.close=Oc.prototype.close,Z.od=qb,Z.ConnectionTarget=Z.od,Z.yd=function(){Hc=zc=k},Z.forceLongPolling=Z.yd,Z.zd=function(){Ic=k},Z.forceWebSockets=Z.zd,Z.Qd=function(t,e){t.n.u.Lc=e},Z.setSecurityDebugCallback=Z.Qd,Z.Nc=function(t,e){t.n.Nc(e)},Z.stats=Z.Nc,Z.Oc=function(t,e){t.n.Oc(e)},Z.statsIncrementCounter=Z.Oc,Z.tc=function(t){return t.n.tc},$.prototype.cancel=function(t){A("Firebase.onDisconnect().cancel",0,1,arguments.length),C("Firebase.onDisconnect().cancel",1,t,k),this.Gb.Ec(this.S,t)},$.prototype.cancel=$.prototype.cancel,$.prototype.remove=function(t){A("Firebase.onDisconnect().remove",0,1,arguments.length),E("Firebase.onDisconnect().remove",this.S),C("Firebase.onDisconnect().remove",1,t,k),ce(this.Gb,this.S,l,t)},$.prototype.remove=$.prototype.remove,$.prototype.set=function(t,e){A("Firebase.onDisconnect().set",1,2,arguments.length),E("Firebase.onDisconnect().set",this.S),ya("Firebase.onDisconnect().set",t,o),C("Firebase.onDisconnect().set",2,e,k),ce(this.Gb,this.S,t,e)},$.prototype.set=$.prototype.set,$.prototype.eb=function(t,e,i){A("Firebase.onDisconnect().setWithPriority",2,3,arguments.length),E("Firebase.onDisconnect().setWithPriority",this.S),ya("Firebase.onDisconnect().setWithPriority",t,o),Da("Firebase.onDisconnect().setWithPriority",2,e,o),C("Firebase.onDisconnect().setWithPriority",3,i,k),(".length"===this.Ca||".keys"===this.Ca)&&g("Firebase.onDisconnect().setWithPriority failed: "+this.Ca+" is a read-only object.");var n=this.Gb,s=this.S,r=R(t,e);dd(n.u,s.toString(),r.V(k),function(t){"ok"===t&&id(n.R,s,r),X(i,t)})},$.prototype.setWithPriority=$.prototype.eb,$.prototype.update=function(t,e){A("Firebase.onDisconnect().update",1,2,arguments.length),E("Firebase.onDisconnect().update",this.S),Ca("Firebase.onDisconnect().update",t),C("Firebase.onDisconnect().update",2,e,k);var i,n=this.Gb,s=this.S,r=k;for(i in t)r=o;if(r)Nb("onDisconnect().update() called with empty data.  Don't do anything."),X(e,k);else{r=n.u,i=s.toString();var a=function(i){if("ok"===i)for(var o in t){var r=R(t[o]);id(n.R,s.F(o),r)}X(e,i)};r.P?ed(r,"om",i,t,a):r.xb.push({Jc:i,action:"om",data:t,C:a})}},$.prototype.update=$.prototype.update;var le,me=0,ne=[];le=function(t){var e=t===me;me=t;for(var i=Array(8),n=7;n>=0;n--)i[n]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(t%64),t=Math.floor(t/64);if(z(0===t),t=i.join(""),e){for(n=11;n>=0&&63===ne[n];n--)ne[n]=0;ne[n]++}else for(n=0;12>n;n++)ne[n]=Math.floor(64*Math.random());for(n=0;12>n;n++)t+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(ne[n]);return z(20===t.length,"NextPushId: Length should be 20."),t},ka(J,H);var oe=J,pe=["Firebase"],qe=ba;!(pe[0]in qe)&&qe.execScript&&qe.execScript("var "+pe[0]);for(var re;pe.length&&(re=pe.shift());)!pe.length&&u(oe)?qe[re]=oe:qe=qe[re]?qe[re]:qe[re]={};J.prototype.name=function(){return A("Firebase.name",0,0,arguments.length),this.path.f()?l:this.path.Z<this.path.m.length?this.path.m[this.path.m.length-1]:l},J.prototype.name=J.prototype.name,J.prototype.F=function(t){if(A("Firebase.child",1,1,arguments.length),ga(t))t=String(t);else if(!(t instanceof K))if(F(this.path)===l){var e=t;e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ga("Firebase.child",e)}else Ga("Firebase.child",t);return new J(this.n,this.path.F(t))},J.prototype.child=J.prototype.F,J.prototype.parent=function(){A("Firebase.parent",0,0,arguments.length);var t=this.path.parent();return t===l?l:new J(this.n,t)},J.prototype.parent=J.prototype.parent,J.prototype.root=function(){A("Firebase.ref",0,0,arguments.length);for(var t=this;t.parent()!==l;)t=t.parent();return t},J.prototype.root=J.prototype.root,J.prototype.toString=function(){A("Firebase.toString",0,0,arguments.length);var t;if(this.parent()===l)t=this.n.toString();else{t=this.parent().toString()+"/";var e=this.name();t+=encodeURIComponent(String(e))}return t},J.prototype.toString=J.prototype.toString,J.prototype.set=function(t,e){return A("Firebase.set",1,2,arguments.length),E("Firebase.set",this.path),ya("Firebase.set",t,o),C("Firebase.set",2,e,k),this.n.eb(this.path,t,l,e)},J.prototype.set=J.prototype.set,J.prototype.update=function(t,e){return A("Firebase.update",1,2,arguments.length),E("Firebase.update",this.path),Ca("Firebase.update",t),C("Firebase.update",2,e,k),this.n.update(this.path,t,e)},J.prototype.update=J.prototype.update,J.prototype.eb=function(t,e,i){return A("Firebase.setWithPriority",2,3,arguments.length),E("Firebase.setWithPriority",this.path),ya("Firebase.setWithPriority",t,o),Da("Firebase.setWithPriority",2,e,o),C("Firebase.setWithPriority",3,i,k),(".length"===this.name()||".keys"===this.name())&&g("Firebase.setWithPriority failed: "+this.name()+" is a read-only object."),this.n.eb(this.path,t,e,i)},J.prototype.setWithPriority=J.prototype.eb,J.prototype.remove=function(t){A("Firebase.remove",0,1,arguments.length),E("Firebase.remove",this.path),C("Firebase.remove",1,t,k),this.set(l,t)},J.prototype.remove=J.prototype.remove,J.prototype.transaction=function(t,e,i){function n(){}A("Firebase.transaction",1,3,arguments.length),E("Firebase.transaction",this.path),C("Firebase.transaction",1,t,o),C("Firebase.transaction",2,e,k),u(i)&&"boolean"!=typeof i&&g(Error(B("Firebase.transaction",3,k)+"must be a boolean.")),(".length"===this.name()||".keys"===this.name())&&g("Firebase.transaction failed: "+this.name()+" is a read-only object."),"undefined"==typeof i&&(i=k);var s=this.n,r=this.path,a=i;s.e("transaction on "+r);var c=new J(s,r);c.Ya("value",n);var a={path:r,update:t,C:e,status:l,ed:Hb(),nc:a,kd:0,kc:function(){c.vb("value",n)},lc:l},h=a.update(U(s.gb,r).V());if(u(h)){za("transaction failed: Data returned ",h),a.status=1;var p=L(s.fb,r),f=p.k()||[];f.push(a),M(p,f),f="object"==typeof h&&h!==l&&D(h,".priority")?h[".priority"]:U(s.g.I,r).j(),p=$d(s),h=R(h,f),h=Wd(h,p),V(s.gb,r,h),a.nc&&(V(s.g.la,r,h),Qd(s.H,r,[r])),ee(s)}else a.kc(),a.C&&(s=he(s,r),a.C(l,o,s))},J.prototype.transaction=J.prototype.transaction,J.prototype.Mc=function(t,e){A("Firebase.setPriority",1,2,arguments.length),E("Firebase.setPriority",this.path),Da("Firebase.setPriority",1,t,o),C("Firebase.setPriority",2,e,k),this.n.Mc(this.path,t,e)},J.prototype.setPriority=J.prototype.Mc,J.prototype.push=function(t,e){A("Firebase.push",0,2,arguments.length),E("Firebase.push",this.path),ya("Firebase.push",t,k),C("Firebase.push",2,e,k);var i=Zd(this.n),i=le(i),i=this.F(i);return"undefined"!=typeof t&&t!==l&&i.set(t,e),i},J.prototype.push=J.prototype.push,J.prototype.ga=function(){return new $(this.n,this.path,this.name())},J.prototype.onDisconnect=J.prototype.ga,J.prototype.Ld=function(){N("FirebaseRef.removeOnDisconnect() being deprecated. Please use FirebaseRef.onDisconnect().remove() instead."),this.ga().remove(),de(this.n)},J.prototype.removeOnDisconnect=J.prototype.Ld,J.prototype.Pd=function(t){N("FirebaseRef.setOnDisconnect(value) being deprecated. Please use FirebaseRef.onDisconnect().set(value) instead."),this.ga().set(t),de(this.n)},J.prototype.setOnDisconnect=J.prototype.Pd,J.prototype.ib=function(t,e,i){A("Firebase.auth",1,3,arguments.length),v(t)||g(Error(B("Firebase.auth",1,o)+"must be a valid credential (a string).")),C("Firebase.auth",2,e,k),C("Firebase.auth",3,e,k),this.n.ib(t,e,i)},J.prototype.auth=J.prototype.ib,J.prototype.Lb=function(t){A("Firebase.unauth",0,1,arguments.length),C("Firebase.unauth",1,t,k),this.n.Lb(t)},J.prototype.unauth=J.prototype.Lb,J.goOffline=function(){A("Firebase.goOffline",0,0,arguments.length),Y.mb().Ha()},J.goOnline=function(){A("Firebase.goOnline",0,0,arguments.length),Y.mb().bb()},J.enableLogging=Ob,J.ServerValue={TIMESTAMP:{".sv":"timestamp"}},J.INTERNAL=Z,J.Context=Y}(),define("lib/firebase",function(){}),!function(){var t=window._,e=window.Backbone;e.Firebase=function(t){this._fbref=t,this._children=[],"string"==typeof t&&(this._fbref=new Firebase(t)),this._fbref.on("child_added",this._childAdded,this),this._fbref.on("child_moved",this._childMoved,this),this._fbref.on("child_changed",this._childChanged,this),this._fbref.on("child_removed",this._childRemoved,this)},t.extend(e.Firebase.prototype,{_childAdded:function(e,i){var n=e.val();if(n.id=e.name(),i){var o=t.find(this._children,function(t){return t.id==i});this._children.splice(this._children.indexOf(o)+1,0,n)}else this._children.unshift(n)},_childMoved:function(e,i){var n=e.val();this._children=t.reject(this._children,function(t){return t.id==n.id}),this._childAdded(e,i)},_childChanged:function(e){var i=e.val();i.id=e.name();var n=t.find(this._children,function(t){return t.id==i.id});this._children[this._children.indexOf(n)]=i},_childRemoved:function(e){var i=e.val();this._children=t.reject(this._children,function(t){return t.id==i.id})},create:function(e,i){e.id||(e.id=this._fbref.ref().push().name());var n=e.toJSON();this._fbref.ref().child(e.id).set(n,t.bind(function(t){t?i("Could not create model "+e.id):i(null,n)},this))},read:function(e,i){if(!e.id)return t.defer(i,"Invalid model ID provided to read"),void 0;var n=t.find(this._children,function(t){return t.id==e.id});t.defer(i,null,this._children[n])},readAll:function(e,i){t.defer(i,null,this._children)},update:function(t,e){var i=t.toJSON();this._fbref.ref().child(t.id).update(i,function(n){n?e("Could not update model "+t.id,null):e(null,i)})},"delete":function(t,e){this._fbref.ref().child(t.id).remove(function(i){i?e("Could not delete model "+t.id):e(null,t)})},ref:function(){return this._fbref}}),e.Firebase.sync=function(t,i,n,o){var s=i.firebase||i.collection.firebase;"function"==typeof n&&(n={success:n,error:o}),"read"==t&&void 0===i.id&&(t="readAll"),s[t].apply(s,[i,function(t,o){t?(i.trigger("error",i,t,n),"0.9.10"===e.VERSION?n.error(i,t,n):n.error(t)):(i.trigger("sync",i,o,n),"0.9.10"===e.VERSION?n.success(i,o,n):n.success(o))}])},e.oldSync=e.sync,e.sync=function(t,i,n,o){var s=e.oldSync;return(i.firebase||i.collection&&i.collection.firebase)&&(s=e.Firebase.sync),s.apply(this,[t,i,n,o])},e.Firebase.Collection=e.Collection.extend({sync:function(){this._log("Sync called on a Firebase collection, ignoring.")},fetch:function(){this._log("Fetch called on a Firebase collection, ignoring.")},constructor:function(i,n){switch(e.Collection.apply(this,arguments),n&&n.firebase&&(this.firebase=n.firebase),typeof this.firebase){case"object":break;case"string":this.firebase=new Firebase(this.firebase);break;case"function":this.firebase=this.firebase();break;default:throw new Error("Invalid firebase reference created")}this.firebase.on("child_added",t.bind(this._childAdded,this)),this.firebase.on("child_moved",t.bind(this._childMoved,this)),this.firebase.on("child_changed",t.bind(this._childChanged,this)),this.firebase.on("child_removed",t.bind(this._childRemoved,this)),this.firebase.once("value",t.bind(function(){this.trigger("sync",this,null,null)},this)),this.listenTo(this,"change",this._updateModel,this),this.listenTo(this,"destroy",this._removeModel,this),this._suppressEvent=!1},comparator:function(t){return t.id},add:function(e,i){var n=this._parseModels(e);i=i?t.clone(i):{},i.success=t.isFunction(i.success)?i.success:function(){};for(var o=0;o<n.length;o++){var s=n[o],r=this.firebase.ref().child(s.id);i.silent===!0&&(this._suppressEvent=!0),r.set(s,t.bind(i.success,s))}return n},remove:function(e,i){var n=this._parseModels(e);i=i?t.clone(i):{},i.success=t.isFunction(i.success)?i.success:function(){};for(var o=0;o<n.length;o++){var s=n[o],r=this.firebase.ref().child(s.id);i.silent===!0&&(this._suppressEvent=!0),r.set(null,t.bind(i.success,s))}return n},create:function(i,n){if(n=n?t.clone(n):{},n.wait&&this._log("Wait option provided to create, ignoring."),i=e.Collection.prototype._prepareModel.apply(this,[i,n]),!i)return!1;var o=this.add([i],n);return o[0]},reset:function(e,i){i=i?t.clone(i):{},this.remove(this.models,{silent:!0});var n=this.add(e,{silent:!0});return i.silent||this.trigger("reset",this,i),n},_log:function(t){console&&console.log&&console.log(t)},_parseModels:function(e){var i=[];e=t.isArray(e)?e.slice():[e];for(var n=0;n<e.length;n++){var o=e[n];o.toJSON&&"function"==typeof o.toJSON&&(o=o.toJSON()),o.id||(o.id=this.firebase.ref().push().name()),i.push(o)}return i},_childAdded:function(i){var n=i.val();n.id||(t.isObject(n)||(n={}),n.id=i.name()),this._suppressEvent===!0?(this._suppressEvent=!1,e.Collection.prototype.add.apply(this,[n],{silent:!0})):e.Collection.prototype.add.apply(this,[n]),this.get(n.id)._remoteAttributes=n},_childMoved:function(t){this._log("_childMoved called with "+t.val())},_childChanged:function(e){var i=e.val();i.id||(i.id=e.name());var n=t.find(this.models,function(t){return t.id==i.id});if(!n)throw new Error("Could not find model with ID "+i.id);this._preventSync(n,!0),n._remoteAttributes=i;var o=t.difference(t.keys(n.attributes),t.keys(i));t.each(o,function(t){n.unset(t)}),n.set(i),this._preventSync(n,!1)},_childRemoved:function(t){var i=t.val();i.id||(i.id=t.name()),this._suppressEvent===!0?(this._suppressEvent=!1,e.Collection.prototype.remove.apply(this,[i],{silent:!0})):e.Collection.prototype.remove.apply(this,[i])},_updateModel:function(e){if(!e._remoteChanging){var i=e._remoteAttributes||{},n=e.toJSON(),o={},s=t.union(t.keys(i),t.keys(n));t.each(s,function(e){t.has(n,e)?n[e]!=i[e]&&(o[e]=n[e]):o[e]=null}),t.size(o)&&this.firebase.ref().child(e.id).update(o)}},_removeModel:function(e,i,n){n=n?t.clone(n):{},n.success=t.isFunction(n.success)?n.success:function(){};var o=this.firebase.ref().child(e.id);o.set(null,t.bind(n.success,e))},_preventSync:function(t,e){t._remoteChanging=e}}),e.Firebase.Model=e.Model.extend({save:function(){this._log("Save called on a Firebase model, ignoring.")},destroy:function(t){this.firebase.ref().set(null,this._log),this.trigger("destroy",this,this.collection,t),t.success&&t.success(this,null,t)},constructor:function(i,n){var o=t.result(this,"defaults");switch(this.once("sync",function(){this.set(t.defaults(this.toJSON(),o))}),e.Model.apply(this,arguments),n&&n.firebase&&(this.firebase=n.firebase),typeof this.firebase){case"object":break;case"string":this.firebase=new Firebase(this.firebase);break;case"function":this.firebase=this.firebase();break;default:throw new Error("Invalid firebase reference created")}this.firebase.on("value",t.bind(this._modelChanged,this)),this._listenLocalChange(!0)},_listenLocalChange:function(t){t?this.on("change",this._updateModel,this):this.off("change",this._updateModel,this)},_updateModel:function(e){var i=e.changedAttributes();t.each(e.changed,function(t,e){("undefined"==typeof t||null===t)&&("id"==e?delete i[e]:i[e]=null)}),t.size(i)&&this.firebase.ref().update(i,this._log)},_modelChanged:function(e){var i=e.val();if("object"==typeof i&&null!==i){var n=t.difference(t.keys(this.attributes),t.keys(i)),o=this;t.each(n,function(t){o.unset(t)})}this._listenLocalChange(!1),this.set(i),this.trigger("sync",this,null,null),this._listenLocalChange(!0)},_log:function(t){"undefined"!=typeof t&&null!==t&&console&&console.log&&console.log(t)}})}(),define("lib/backboneFirebase",function(){}),function(t){function e(){this._pieces=[],this._parts=[]}function i(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function n(){this.bufferBuilder=new e}function o(t){var e=t.charCodeAt(0);return 2047>=e?"00":65535>=e?"000":2097151>=e?"0000":67108863>=e?"00000":"000000"}function s(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,o).length}function r(){this._events={}}function a(t,e){return this instanceof a?(this._dc=t,v.debug=e,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],this._setupDC(),void 0):new a(t)}function u(t,e){if(!(this instanceof u))return new u(t,e);if(r.call(this),t&&t.constructor==Object?(e=t,t=void 0):t&&(t=t.toString()),e=v.extend({debug:0,host:v.CLOUD_HOST,port:v.CLOUD_PORT,key:"peerjs",config:v.defaultConfig},e),this.options=e,"/"===e.host&&(e.host=window.location.hostname),void 0===e.secure&&e.host!==v.CLOUD_HOST&&(e.secure=v.isSecure()),e.logFunction&&v.setLogFunction(e.logFunction),v.setLogLevel(e.debug),!v.supports.audioVideo&&!v.supports.data)return this._delayedAbort("browser-incompatible","The current browser does not support WebRTC"),void 0;if(!v.validateId(t))return this._delayedAbort("invalid-id",'ID "'+t+'" is invalid'),void 0;if(!v.validateKey(e.key))return this._delayedAbort("invalid-key",'API KEY "'+e.key+'" is invalid'),void 0;if(e.secure&&"0.peerjs.com"===e.host)return this._delayedAbort("ssl-unavailable","The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS."),void 0;this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={};var i=this;this.socket=new l(this.options.secure,this.options.host,this.options.port,this.options.key),this.socket.on("message",function(t){i._handleMessage(t)}),this.socket.on("error",function(t){i._abort("socket-error",t)}),this.socket.on("close",function(){i.disconnected||i._abort("socket-closed","Underlying socket is already closed.")}),t?this._initialize(t):this._retrieveId()}function c(t,e,i){return this instanceof c?(r.call(this),this.options=v.extend({serialization:"binary",reliable:!1},i),this.open=!1,this.type="data",this.peer=t,this.provider=e,this.id=this.options.connectionId||c._idPrefix+v.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),g.startConnection(this,this.options._payload||{originator:!0}),void 0):new c(t,e,i)}function h(t,e,i){return this instanceof h?(r.call(this),this.options=v.extend({},i),this.open=!1,this.type="media",this.peer=t,this.provider=e,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||h._idPrefix+v.randomToken(),this.localStream&&g.startConnection(this,{_stream:this.localStream,originator:!0}),void 0):new h(t,e,i)}function l(t,e,i,n){if(!(this instanceof l))return new l(t,e,i,n);r.call(this),this.disconnected=!1,this._queue=[];var o=t?"https://":"http://",s=t?"wss://":"ws://";this._httpUrl=o+e+":"+i+"/"+n,this._wsUrl=s+e+":"+i+"/peerjs?key="+n}var p={};p.useBlobBuilder=function(){try{return new Blob([]),!1}catch(t){return!0}}(),p.useArrayBufferView=!p.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(t){return!0}}(),t.binaryFeatures=p,t.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder,e.prototype.append=function(t){"number"==typeof t?this._pieces.push(t):(this.flush(),this._parts.push(t))},e.prototype.flush=function(){if(this._pieces.length>0){var t=new Uint8Array(this._pieces);p.useArrayBufferView||(t=t.buffer),this._parts.push(t),this._pieces=[]}},e.prototype.getBuffer=function(){if(this.flush(),p.useBlobBuilder){for(var t=new BlobBuilder,e=0,i=this._parts.length;i>e;e++)t.append(this._parts[e]);return t.getBlob()}return new Blob(this._parts)},t.BinaryPack={unpack:function(t){var e=new i(t);return e.unpack()},pack:function(t){var e=new n;e.pack(t);var i=e.getBuffer();return i}},i.prototype.unpack=function(){var t=this.unpack_uint8();if(128>t){var e=t;return e}if(32>(224^t)){var i=(224^t)-32;return i}var n;if((n=160^t)<=15)return this.unpack_raw(n);if((n=176^t)<=15)return this.unpack_string(n);if((n=144^t)<=15)return this.unpack_array(n);if((n=128^t)<=15)return this.unpack_map(n);switch(t){case 192:return null;case 193:return void 0;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return void 0;case 213:return void 0;case 214:return void 0;case 215:return void 0;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}},i.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},i.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},i.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},i.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},i.prototype.unpack_int8=function(){var t=this.unpack_uint8();return 128>t?t:t-256},i.prototype.unpack_int16=function(){var t=this.unpack_uint16();return 32768>t?t:t-65536},i.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},i.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},i.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);
return this.index+=t,e},i.prototype.unpack_string=function(t){for(var e,i,n=this.read(t),o=0,s="";t>o;)e=n[o],128>e?(s+=String.fromCharCode(e),o++):32>(192^e)?(i=(192^e)<<6|63&n[o+1],s+=String.fromCharCode(i),o+=2):(i=(15&e)<<12|(63&n[o+1])<<6|63&n[o+2],s+=String.fromCharCode(i),o+=3);return this.index+=t,s},i.prototype.unpack_array=function(t){for(var e=new Array(t),i=0;t>i;i++)e[i]=this.unpack();return e},i.prototype.unpack_map=function(t){for(var e={},i=0;t>i;i++){var n=this.unpack(),o=this.unpack();e[n]=o}return e},i.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=t>>31,i=(t>>23&255)-127,n=8388607&t|8388608;return(0==e?1:-1)*n*Math.pow(2,i-23)},i.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),i=t>>31,n=(t>>20&2047)-1023,o=1048575&t|1048576,s=o*Math.pow(2,n-20)+e*Math.pow(2,n-52);return(0==i?1:-1)*s},i.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},n.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},n.prototype.pack=function(t){var e=typeof t;if("string"==e)this.pack_string(t);else if("number"==e)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==e)t===!0?this.bufferBuilder.append(195):t===!1&&this.bufferBuilder.append(194);else if("undefined"==e)this.bufferBuilder.append(192);else{if("object"!=e)throw new Error('Type "'+e+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var i=t.constructor;if(i==Array)this.pack_array(t);else if(i==Blob||i==File)this.pack_bin(t);else if(i==ArrayBuffer)p.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)p.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(i==Object)this.pack_object(t);else if(i==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+i.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},n.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(15>=e)this.pack_uint8(160+e);else if(65535>=e)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_string=function(t){var e=s(t);if(15>=e)this.pack_uint8(176+e);else if(65535>=e)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},n.prototype.pack_array=function(t){var e=t.length;if(15>=e)this.pack_uint8(144+e);else if(65535>=e)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var i=0;e>i;i++)this.pack(t[i])},n.prototype.pack_integer=function(t){if(t>=-32&&127>=t)this.bufferBuilder.append(255&t);else if(t>=0&&255>=t)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&127>=t)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&65535>=t)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&32767>=t)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&4294967295>=t)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&2147483647>=t)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&0x8000000000000000>=t)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(t>=0&&0x10000000000000000>=t))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},n.prototype.pack_double=function(t){var e=0;0>t&&(e=1,t=-t);var i=Math.floor(Math.log(t)/Math.LN2),n=t/Math.pow(2,i)-1,o=Math.floor(n*Math.pow(2,52)),s=Math.pow(2,32),r=e<<31|i+1023<<20|o/s&1048575,a=o%s;this.bufferBuilder.append(203),this.pack_int32(r),this.pack_int32(a)},n.prototype.pack_object=function(t){var e=Object.keys(t),i=e.length;if(15>=i)this.pack_uint8(128+i);else if(65535>=i)this.bufferBuilder.append(222),this.pack_uint16(i);else{if(!(4294967295>=i))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(i)}for(var n in t)t.hasOwnProperty(n)&&(this.pack(n),this.pack(t[n]))},n.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},n.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},n.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)},n.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},n.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},n.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),i=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&i)>>>24),this.bufferBuilder.append((16711680&i)>>>16),this.bufferBuilder.append((65280&i)>>>8),this.bufferBuilder.append(255&i)};var f=Array.isArray;r.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");return this.emit("newListener",t,"function"==typeof e.listener?e.listener:e),this._events[t]?f(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function i(){n.removeListener(t,i),e.apply(this,arguments)}if("function"!=typeof e)throw new Error(".once only takes instances of Function");var n=this;return i.listener=e,n.on(t,i),this},r.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events[t])return this;var i=this._events[t];if(f(i)){for(var n=-1,o=0,s=i.length;s>o;o++)if(i[o]===e||i[o].listener&&i[o].listener===e){n=o;break}if(0>n)return this;i.splice(n,1),0==i.length&&delete this._events[t]}else(i===e||i.listener&&i.listener===e)&&delete this._events[t];return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},r.prototype.listeners=function(t){return this._events[t]||(this._events[t]=[]),f(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},r.prototype.emit=function(t){var t=arguments[0],e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:for(var i=arguments.length,n=new Array(i-1),o=1;i>o;o++)n[o-1]=arguments[o];e.apply(this,n)}return!0}if(f(e)){for(var i=arguments.length,n=new Array(i-1),o=1;i>o;o++)n[o-1]=arguments[o];for(var s=e.slice(),o=0,i=s.length;i>o;o++)s[o].apply(this,n);return!0}return!1},a.prototype.send=function(t){var e=v.pack(t);return e.size<this._mtu?(this._handleSend(["no",e]),void 0):(this._outgoing[this._count]={ack:0,chunks:this._chunk(e)},v.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),this._count+=1,void 0)},a.prototype._setupInterval=function(){var t=this;this._timeout=setInterval(function(){var e=t._queue.shift();if(e._multiple)for(var i=0,n=e.length;n>i;i+=1)t._intervalSend(e[i]);else t._intervalSend(e)},this._interval)},a.prototype._intervalSend=function(t){var e=this;t=v.pack(t),v.blobToBinaryString(t,function(t){e._dc.send(t)}),0===e._queue.length&&(clearTimeout(e._timeout),e._timeout=null)},a.prototype._processAcks=function(){for(var t in this._outgoing)this._outgoing.hasOwnProperty(t)&&this._sendWindowedChunks(t)},a.prototype._handleSend=function(t){for(var e=!0,i=0,n=this._queue.length;n>i;i+=1){var o=this._queue[i];o===t?e=!1:o._multiple&&-1!==o.indexOf(t)&&(e=!1)}e&&(this._queue.push(t),this._timeout||this._setupInterval())},a.prototype._setupDC=function(){var t=this;this._dc.onmessage=function(e){var i=e.data,n=i.constructor;if(n===String){var o=v.binaryStringToArrayBuffer(i);i=v.unpack(o),t._handleMessage(i)}}},a.prototype._handleMessage=function(t){var e,i=t[1],n=this._incoming[i],o=this._outgoing[i];switch(t[0]){case"no":var s=i;!s||this.onmessage(v.unpack(s));break;case"end":if(e=n,this._received[i]=t[2],!e)break;this._ack(i);break;case"ack":if(e=o){var r=t[2];e.ack=Math.max(r,e.ack),e.ack>=e.chunks.length?(v.log("Time: ",new Date-e.timer),delete this._outgoing[i]):this._processAcks()}break;case"chunk":if(e=n,!e){var a=this._received[i];if(a===!0)break;e={ack:["ack",i,0],chunks:[]},this._incoming[i]=e}var u=t[2],c=t[3];e.chunks[u]=new Uint8Array(c),u===e.ack[2]&&this._calculateNextAck(i),this._ack(i);break;default:this._handleSend(t)}},a.prototype._chunk=function(t){for(var e=[],i=t.size,n=0;i>n;){var o=Math.min(i,n+this._mtu),s=t.slice(n,o),r={payload:s};e.push(r),n=o}return v.log("Created",e.length,"chunks."),e},a.prototype._ack=function(t){var e=this._incoming[t].ack;this._received[t]===e[2]&&(this._complete(t),this._received[t]=!0),this._handleSend(e)},a.prototype._calculateNextAck=function(t){for(var e=this._incoming[t],i=e.chunks,n=0,o=i.length;o>n;n+=1)if(void 0===i[n])return e.ack[2]=n,void 0;e.ack[2]=i.length},a.prototype._sendWindowedChunks=function(t){v.log("sendWindowedChunks for: ",t);for(var e=this._outgoing[t],i=e.chunks,n=[],o=Math.min(e.ack+this._window,i.length),s=e.ack;o>s;s+=1)i[s].sent&&s!==e.ack||(i[s].sent=!0,n.push(["chunk",t,s,i[s].payload]));e.ack+this._window>=i.length&&n.push(["end",t,i.length]),n._multiple=!0,this._handleSend(n)},a.prototype._complete=function(t){v.log("Completed called for",t);var e=this,i=this._incoming[t].chunks,n=new Blob(i);v.blobToArrayBuffer(n,function(t){e.onmessage(v.unpack(t))}),delete this._incoming[t]},a.higherBandwidthSDP=function(t){var e=navigator.appVersion.match(/Chrome\/(.*?) /);if(e&&(e=parseInt(e[1].split(".").shift()),31>e)){var i=t.split("b=AS:30"),n="b=AS:102400";if(i.length>1)return i[0]+n+i[1]}return t},a.prototype.onmessage=function(){},t.Reliable=a,t.RTCSessionDescription=window.mozRTCSessionDescription||window.RTCSessionDescription,t.RTCPeerConnection=window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection,t.RTCIceCandidate=window.mozRTCIceCandidate||window.RTCIceCandidate;var d={iceServers:[{url:"stun:stun.l.google.com:19302"}]},m=1,v={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(t){var e=parseInt(t,10);v.logLevel=isNaN(parseInt(t,10))?t?3:0:e,v.log=v.warn=v.error=v.noop,v.logLevel>0&&(v.error=v._printWith("ERROR")),v.logLevel>1&&(v.warn=v._printWith("WARNING")),v.logLevel>2&&(v.log=v._print)},setLogFunction:function(t){t.constructor!==Function?v.warn("The log function you passed in is not a function. Defaulting to regular logs."):v._print=t},_printWith:function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t),v._print.apply(v,e)}},_print:function(){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var i=0,n=e.length;n>i;i++)e[i]instanceof Error&&(e[i]="("+e[i].name+") "+e[i].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)},defaultConfig:d,browser:function(){return window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported"}(),supports:function(){if("undefined"==typeof RTCPeerConnection)return{};var t,e,i=!0,n=!0,o=!1,s=!1,r=!!window.webkitRTCPeerConnection;try{t=new RTCPeerConnection(d,{optional:[{RtpDataChannels:!0}]})}catch(a){i=!1,n=!1}if(i)try{e=t.createDataChannel("_PEERJSTEST")}catch(a){i=!1}if(i){try{e.binaryType="blob",o=!0}catch(a){}var u=new RTCPeerConnection(d,{});try{var c=u.createDataChannel("_PEERJSRELIABLETEST",{});s=c.reliable}catch(a){}u.close()}if(n&&(n=!!t.addStream),!r&&i){var h=new RTCPeerConnection(d,{optional:[{RtpDataChannels:!0}]});h.onnegotiationneeded=function(){r=!0,v&&v.supports&&(v.supports.onnegotiationneeded=!0)};{h.createDataChannel("_PEERJSNEGOTIATIONTEST")}setTimeout(function(){h.close()},1e3)}return t&&t.close(),{audioVideo:n,data:i,binaryBlob:o,binary:s,reliable:s,sctp:s,onnegotiationneeded:r}}(),validateId:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},validateKey:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},debug:!1,inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},pack:BinaryPack.pack,unpack:BinaryPack.unpack,log:function(){if(v.debug){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var i=0,n=e.length;n>i;i++)e[i]instanceof Error&&(e[i]="("+e[i].name+") "+e[i].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)}},setZeroTimeout:function(t){function e(e){n.push(e),t.postMessage(o,"*")}function i(e){e.source==t&&e.data==o&&(e.stopPropagation&&e.stopPropagation(),n.length&&n.shift()())}var n=[],o="zero-timeout-message";return t.addEventListener?t.addEventListener("message",i,!0):t.attachEvent&&t.attachEvent("onmessage",i),e}(this),chunk:function(t){for(var e=[],i=t.size,n=index=0,o=Math.ceil(i/v.chunkedMTU);i>n;){var s=Math.min(i,n+v.chunkedMTU),r=t.slice(n,s),a={__peerData:m,n:index,data:r,total:o};e.push(a),n=s,index+=1}return m+=1,e},blobToArrayBuffer:function(t,e){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsArrayBuffer(t)},blobToBinaryString:function(t,e){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsBinaryString(t)},binaryStringToArrayBuffer:function(t){for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=255&t.charCodeAt(i);return e.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}};t.util=v,v.inherits(u,r),u.prototype._retrieveId=function(){var t=this,e=new XMLHttpRequest,i=this.options.secure?"https://":"http://",n=i+this.options.host+":"+this.options.port+"/"+this.options.key+"/id",o="?ts="+(new Date).getTime()+Math.random();n+=o,e.open("get",n,!0),e.onerror=function(e){v.error("Error retrieving ID",e),t._abort("server-error","Could not get an ID from the server")},e.onreadystatechange=function(){return 4===e.readyState?200!==e.status?(e.onerror(),void 0):(t._initialize(e.responseText),void 0):void 0},e.send(null)},u.prototype._initialize=function(t){this.id=t,this.socket.start(this.id)},u.prototype._handleMessage=function(t){var e=t.type,i=t.payload,n=t.src;switch(e){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",i.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":v.log("Received leave message from",n),this._cleanupPeer(n);break;case"EXPIRE":this.emit("error",new Error("Could not connect to peer "+n));break;case"OFFER":var o=i.connectionId,s=this.getConnection(n,o);if(s)v.warn("Offer received for existing Connection ID:",o);else{if("media"===i.type){var s=new h(n,this,{connectionId:o,_payload:i,metadata:i.metadata});this._addConnection(n,s),this.emit("call",s)}else{if("data"!==i.type)return v.warn("Received malformed connection type:",i.type),void 0;s=new c(n,this,{connectionId:o,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(n,s),this.emit("connection",s)}for(var r=this._getMessages(o),a=0,u=r.length;u>a;a+=1)s.handleMessage(r[a])}break;default:if(!i)return v.warn("You received a malformed message from "+n+" of type "+e),void 0;var l=i.connectionId,s=this.getConnection(n,l);s&&s.pc?s.handleMessage(t):l?this._storeMessage(l,t):v.warn("You received an unrecognized message:",t)}},u.prototype._storeMessage=function(t,e){this._lostMessages[t]||(this._lostMessages[t]=[]),this._lostMessages[t].push(e)},u.prototype._getMessages=function(t){var e=this._lostMessages[t];return e?(delete this._lostMessages[t],e):[]},u.prototype.connect=function(t,e){if(this.disconnected)return v.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emit("error",new Error("Cannot connect to new Peer after disconnecting from server.")),void 0;var i=new c(t,this,e);return this._addConnection(t,i),i},u.prototype.call=function(t,e,i){if(this.disconnected)return v.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emit("error",new Error("Cannot connect to new Peer after disconnecting from server.")),void 0;if(!e)return v.error("To call a peer, you must provide a stream from your browser's `getUserMedia`."),void 0;i=i||{},i._stream=e;var n=new h(t,this,i);return this._addConnection(t,n),n},u.prototype._addConnection=function(t,e){this.connections[t]||(this.connections[t]=[]),this.connections[t].push(e)},u.prototype.getConnection=function(t,e){var i=this.connections[t];if(!i)return null;for(var n=0,o=i.length;o>n;n++)if(i[n].id===e)return i[n];return null},u.prototype._delayedAbort=function(t,e){var i=this;v.setZeroTimeout(function(){i._abort(t,e)})},u.prototype._abort=function(t,e){v.error("Aborting. Error:",e);var i=new Error(e);i.type=t,this.destroy(),this.emit("error",i)},u.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},u.prototype._cleanup=function(){if(this.connections)for(var t=Object.keys(this.connections),e=0,i=t.length;i>e;e++)this._cleanupPeer(t[e]);this.emit("close")},u.prototype._cleanupPeer=function(t){for(var e=this.connections[t],i=0,n=e.length;n>i;i+=1)e[i].close()},u.prototype.disconnect=function(){var t=this;v.setZeroTimeout(function(){t.disconnected||(t.disconnected=!0,t.open=!1,t.socket&&t.socket.close(),t.id=null)})},t.Peer=u,v.inherits(c,r),c._idPrefix="dc_",c.prototype.initialize=function(t){this._dc=this.dataChannel=t,this._configureDataChannel()},c.prototype._configureDataChannel=function(){var t=this;v.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){v.log("Data channel connection success"),t.open=!0,t.emit("open")},!v.supports.sctp&&this.reliable&&(this._reliable=new a(this._dc,v.debug)),this._reliable?this._reliable.onmessage=function(e){t.emit("data",e)}:this._dc.onmessage=function(e){t._handleDataMessage(e)},this._dc.onclose=function(){v.log("DataChannel closed for:",t.peer),t.close()}},c.prototype._handleDataMessage=function(t){var e=this,i=t.data,n=i.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(n===Blob)return v.blobToArrayBuffer(i,function(t){i=v.unpack(t),e.emit("data",i)}),void 0;if(n===ArrayBuffer)i=v.unpack(i);else if(n===String){var o=v.binaryStringToArrayBuffer(i);i=v.unpack(o)}}else"json"===this.serialization&&(i=JSON.parse(i));if(i.__peerData){var s=i.__peerData,r=this._chunkedData[s]||{data:[],count:0,total:i.total};return r.data[i.n]=i.data,r.count+=1,r.total===r.count&&(i=new Blob(r.data),this._handleDataMessage({data:i}),delete this._chunkedData[s]),this._chunkedData[s]=r,void 0}this.emit("data",i)},c.prototype.close=function(){this.open&&(this.open=!1,g.cleanup(this),this.emit("close"))},c.prototype.send=function(t,e){if(!this.open)return this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages.")),void 0;if(this._reliable)return this._reliable.send(t),void 0;var i=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(t));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var n=v.pack(t),o=v.chunkedBrowsers[this._peerBrowser]||v.chunkedBrowsers[v.browser];if(o&&!e&&n.size>v.chunkedMTU)return this._sendChunks(n),void 0;v.supports.sctp?v.supports.binaryBlob?this._bufferedSend(n):v.blobToArrayBuffer(n,function(t){i._bufferedSend(t)}):v.blobToBinaryString(n,function(t){i._bufferedSend(t)})}else this._bufferedSend(t)},c.prototype._bufferedSend=function(t){(this._buffering||!this._trySend(t))&&(this._buffer.push(t),this.bufferSize=this._buffer.length)},c.prototype._trySend=function(t){try{this._dc.send(t)}catch(e){this._buffering=!0;var i=this;return setTimeout(function(){i._buffering=!1,i._tryBuffer()},100),!1}return!0},c.prototype._tryBuffer=function(){if(0!==this._buffer.length){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},c.prototype._sendChunks=function(t){for(var e=v.chunk(t),i=0,n=e.length;n>i;i+=1){var t=e[i];this.send(t,!0)}},c.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":this._peerBrowser=e.browser,g.handleSDP(t.type,this,e.sdp);break;case"CANDIDATE":g.handleCandidate(this,e.candidate);break;default:v.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},v.inherits(h,r),h._idPrefix="mc_",h.prototype.addStream=function(t){v.log("Receiving stream",t),this.remoteStream=t,this.emit("stream",t)},h.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":g.handleSDP(t.type,this,e.sdp),this.open=!0;break;case"CANDIDATE":g.handleCandidate(this,e.candidate);break;default:v.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},h.prototype.answer=function(t){if(this.localStream)return v.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?"),void 0;this.options._payload._stream=t,this.localStream=t,g.startConnection(this,this.options._payload);for(var e=this.provider._getMessages(this.id),i=0,n=e.length;n>i;i+=1)this.handleMessage(e[i]);this.open=!0},h.prototype.close=function(){this.open&&(this.open=!1,g.cleanup(this),this.emit("close"))};var g={pcs:{data:{},media:{}},queue:[]};g._idPrefix="pc_",g.startConnection=function(t,e){var i=g._getPeerConnection(t,e);if("media"===t.type&&e._stream&&i.addStream(e._stream),t.pc=i,e.originator){if("data"===t.type){var n={};v.supports.sctp||(n={reliable:e.reliable});var o=i.createDataChannel(t.label,n);t.initialize(o)}v.supports.onnegotiationneeded||g._makeOffer(t)}else g.handleSDP("OFFER",t,e.sdp)},g._getPeerConnection=function(t,e){g.pcs[t.type]||v.error(t.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),g.pcs[t.type][t.peer]||(g.pcs[t.type][t.peer]={});{var i;g.pcs[t.type][t.peer]}return e.pc&&(i=g.pcs[t.type][t.peer][e.pc]),i&&"stable"===i.signalingState||(i=g._startPeerConnection(t)),i},g._startPeerConnection=function(t){v.log("Creating RTCPeerConnection.");var e=g._idPrefix+v.randomToken(),i={};"data"!==t.type||v.supports.sctp?"media"===t.type&&(i={optional:[{DtlsSrtpKeyAgreement:!0}]}):i={optional:[{RtpDataChannels:!0}]};var n=new RTCPeerConnection(t.provider.options.config,i);return g.pcs[t.type][t.peer][e]=n,g._setupListeners(t,n,e),n},g._setupListeners=function(t,e){var i=t.peer,n=t.id,o=t.provider;v.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&(v.log("Received ICE candidates for:",t.peer),o.socket.send({type:"CANDIDATE",payload:{candidate:e.candidate,type:t.type,connectionId:t.id},dst:i}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"disconnected":case"failed":v.log("iceConnectionState is disconnected, closing connections to "+i),t.close();break;case"completed":e.onicecandidate=v.noop}},e.onicechange=e.oniceconnectionstatechange,v.log("Listening for `negotiationneeded`"),e.onnegotiationneeded=function(){v.log("`negotiationneeded` triggered"),"stable"==e.signalingState?g._makeOffer(t):v.log("onnegotiationneeded triggered when not stable. Is another connection being established?")},v.log("Listening for data channel"),e.ondatachannel=function(t){v.log("Received data channel");var e=t.channel,s=o.getConnection(i,n);s.initialize(e)},v.log("Listening for remote stream"),e.onaddstream=function(t){v.log("Received remote stream");var e=t.stream;o.getConnection(i,n).addStream(e)}},g.cleanup=function(t){v.log("Cleaning up PeerConnection to "+t.peer);var e=t.pc;!!e&&("closed"!==e.readyState||"closed"!==e.signalingState)&&(e.close(),t.pc=null)},g._makeOffer=function(t){var e=t.pc;e.createOffer(function(i){v.log("Created offer."),!v.supports.sctp&&"data"===t.type&&t.reliable&&(i.sdp=a.higherBandwidthSDP(i.sdp)),e.setLocalDescription(i,function(){v.log("Set localDescription: offer","for:",t.peer),t.provider.socket.send({type:"OFFER",payload:{sdp:i,type:t.type,label:t.label,connectionId:t.id,reliable:t.reliable,serialization:t.serialization,metadata:t.metadata,browser:v.browser},dst:t.peer})},function(e){t.provider.emit("error",e),v.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emit("error",e),v.log("Failed to createOffer, ",e)},t.options.constraints)},g._makeAnswer=function(t){var e=t.pc;e.createAnswer(function(i){v.log("Created answer."),!v.supports.sctp&&"data"===t.type&&t.reliable&&(i.sdp=a.higherBandwidthSDP(i.sdp)),e.setLocalDescription(i,function(){v.log("Set localDescription: answer","for:",t.peer),t.provider.socket.send({type:"ANSWER",payload:{sdp:i,type:t.type,connectionId:t.id,browser:v.browser},dst:t.peer})},function(e){t.provider.emit("error",e),v.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emit("error",e),v.log("Failed to create answer, ",e)})},g.handleSDP=function(t,e,i){i=new RTCSessionDescription(i);var n=e.pc;v.log("Setting remote description",i),n.setRemoteDescription(i,function(){v.log("Set remoteDescription:",t,"for:",e.peer),"OFFER"===t&&g._makeAnswer(e)},function(t){e.provider.emit("error",t),v.log("Failed to setRemoteDescription, ",t)})},g.handleCandidate=function(t,e){var i=e.candidate,n=e.sdpMLineIndex;t.pc.addIceCandidate(new RTCIceCandidate({sdpMLineIndex:n,candidate:i})),v.log("Added ICE candidate for:",t.peer)},v.inherits(l,r),l.prototype.start=function(t){this.id=t;var e=v.randomToken();this._httpUrl+="/"+t+"/"+e,this._wsUrl+="&id="+t+"&token="+e,this._startXhrStream(),this._startWebSocket()},l.prototype._startWebSocket=function(){var t=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(e){var i;try{i=JSON.parse(e.data)}catch(n){return v.log("Invalid server message",e.data),void 0}t.emit("message",i)},this._socket.onopen=function(){t._timeout&&(clearTimeout(t._timeout),setTimeout(function(){t._http.abort(),t._http=null},5e3)),t._sendQueuedMessages(),v.log("Socket open")})},l.prototype._startXhrStream=function(t){try{var e=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=t||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onreadystatechange=function(){2==this.readyState&&this.old&&(this.old.abort(),delete this.old),this.readyState>2&&200==this.status&&this.responseText&&e._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(i){v.log("XMLHttpRequest not available; defaulting to WebSockets")}},l.prototype._handleStream=function(t){var e=t.responseText.split("\n");if(t._buffer)for(;t._buffer.length>0;){var i=t._buffer.shift(),n=e[i];try{n=JSON.parse(n)}catch(o){t._buffer.shift(i);break}this.emit("message",n)}var s=e[t._index];if(s)if(t._index+=1,t._index===e.length)t._buffer||(t._buffer=[]),t._buffer.push(t._index-1);else{try{s=JSON.parse(s)}catch(o){return v.log("Invalid server message",s),void 0}this.emit("message",s)}},l.prototype._setHTTPTimeout=function(){var t=this;this._timeout=setTimeout(function(){var e=t._http;t._wsOpen()?e.abort():(t._startXhrStream(e._streamIndex+1),t._http.old=e)},25e3)},l.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},l.prototype._sendQueuedMessages=function(){for(var t=0,e=this._queue.length;e>t;t+=1)this.send(this._queue[t])},l.prototype.send=function(t){if(!this.disconnected){if(!this.id)return this._queue.push(t),void 0;if(!t.type)return this.emit("error","Invalid message"),void 0;var e=JSON.stringify(t);if(this._wsOpen())this._socket.send(e);else{var i=new XMLHttpRequest,n=this._httpUrl+"/"+t.type.toLowerCase();i.open("post",n,!0),i.setRequestHeader("Content-Type","application/json"),i.send(e)}}},l.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)}}(this),define("lib/peer.min",function(){}),function(t,e){"function"==typeof define&&define.amd?define("notify",[],function(){return e(t,document)}):t.Notify=e(t,document)}(this,function(t){function e(t,e){if(this.title="string"==typeof t?t:null,this.options={icon:"",body:"",tag:"",notifyShow:null,notifyClose:null,notifyClick:null,notifyError:null,permissionGranted:null,permissionDenied:null},this.permission=null,this.isSupported()){if(!this.title)throw new Error("Notify(): first arg (title) must be a string.");if("object"==typeof e){for(var i in e)e.hasOwnProperty(i)&&(this.options[i]=e[i]);"function"==typeof this.options.notifyShow&&(this.onShowCallback=this.options.notifyShow),"function"==typeof this.options.notifyClose&&(this.onCloseCallback=this.options.notifyClose),"function"==typeof this.options.notifyClick&&(this.onClickCallback=this.options.notifyClick),"function"==typeof this.options.notifyError&&(this.onErrorCallback=this.options.notifyError),"function"==typeof this.options.permissionGranted&&(this.onPermissionGrantedCallback=this.options.permissionGranted),"function"==typeof this.options.permissionDenied&&(this.onPermissionDeniedCallback=this.options.permissionDenied)}}}return e.prototype.needsPermission=function(){return"Notification"in t&&"granted"===Notification.permission?!1:"mozNotification"in navigator?!1:!0},e.prototype.requestPermission=function(){var e=this;t.Notification.requestPermission(function(t){switch(e.permission=t,e.permission){case"granted":e.onPermissionGranted();break;case"denied":e.onPermissionDenied()}})},e.prototype.show=function(){this.isSupported()&&("Notification"in t?(this.myNotify=new Notification(this.title,{body:this.options.body,tag:this.options.tag,icon:this.options.icon}),this.myNotify.addEventListener("show",this,!1),this.myNotify.addEventListener("error",this,!1)):(this.myNotify=navigator.mozNotification.createNotification(this.title,this.options.body),this.myNotify.show()),this.myNotify.addEventListener("close",this,!1),this.myNotify.addEventListener("click",this,!1))},e.prototype.onShowNotification=function(){this.onShowCallback&&this.onShowCallback()},e.prototype.onCloseNotification=function(){this.onCloseCallback&&this.onCloseCallback(),this.destroy()},e.prototype.onClickNotification=function(){this.onClickCallback&&this.onClickCallback()},e.prototype.onErrorNotification=function(){this.onErrorCallback&&this.onErrorCallback(),this.destroy()},e.prototype.onPermissionGranted=function(){this.onPermissionGrantedCallback&&this.onPermissionGrantedCallback()
},e.prototype.onPermissionDenied=function(){this.onPermissionDeniedCallback&&this.onPermissionDeniedCallback()},e.prototype.destroy=function(){"Notification"in t&&(this.myNotify.removeEventListener("show",this,!1),this.myNotify.removeEventListener("error",this,!1)),this.myNotify.removeEventListener("close",this,!1),this.myNotify.removeEventListener("click",this,!1)},e.prototype.isSupported=function(){return"Notification"in t||"mozNotification"in navigator?!0:!1},e.prototype.handleEvent=function(t){switch(t.type){case"show":this.onShowNotification(t);break;case"close":this.onCloseNotification(t);break;case"click":this.onClickNotification(t);break;case"error":this.onErrorNotification(t)}},e}),define("lib/notify",function(){}),function(t){t.oauthpopup=function(e){if(!e||!e.path)throw new Error("options.path must not be empty");e=t.extend({windowName:"ConnectWithOAuth",windowOptions:"location=0,status=0,width=800,height=400",callback:function(){window.location.reload()}},e);var i=window.open(e.path,e.windowName,e.windowOptions),n=window.setInterval(function(){i.closed&&(window.clearInterval(n),e.callback())},1e3)},t.fn.oauthpopup=function(e){$this=t(this),$this.click(t.oauthpopup.bind(this,e))}}(Zepto),define("lib/oauthpopup",function(){}),define("famous/Entity",["require","exports","module"],function(t,e,i){function n(t){var e=r.length;return s(e,t),e}function o(t){return r[t]}function s(t,e){r[t]=e}var r=[];i.exports={register:n,get:o,set:s}}),define("famous/EventHandler",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this.downstream=[],this.downstreamFn=[],this.owner=this}function o(t,e){for(var i=!1,n=0;n<this.downstream.length;n++)i=this.downstream[n].emit(t,e)||i;for(var n=0;n<this.downstreamFn.length;n++)i=this.downstreamFn[n](t,e)||i;return i}n.prototype.emit=function(t,e){e||(e={});var i=this.listeners[t],n=!1;if(i)for(var s=0;s<i.length;s++)i[s].call(this.owner,e)&&(n=!0);return o.call(this,t,e)||n},n.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.unbind=function(t,e){var i=this.listeners[t].indexOf(e);i>=0&&this.listeners[t].splice(i,1)},n.prototype.pipe=function(t){var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe"):t.emit("pipe"),t},n.prototype.unpipe=function(t){var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe"):t.emit("unpipe"),t):!1},n.prototype.bindThis=function(t){this.owner=t},n.setInputHandler=function(t,e){t.emit=e.emit.bind(e)},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.unbind=e.unbind.bind(e)},i.exports=n}),define("famous/Matrix",["require","exports","module"],function(t,e,i){var n={};n.precision=1e-6,n.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n.multiply4x4=function o(t,e){var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return i[0]=t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12],i[1]=t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+t[3]*e[13],i[2]=t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+t[3]*e[14],i[3]=t[0]*e[3]+t[1]*e[7]+t[2]*e[11]+t[3]*e[15],i[4]=t[4]*e[0]+t[5]*e[4]+t[6]*e[8]+t[7]*e[12],i[5]=t[4]*e[1]+t[5]*e[5]+t[6]*e[9]+t[7]*e[13],i[6]=t[4]*e[2]+t[5]*e[6]+t[6]*e[10]+t[7]*e[14],i[7]=t[4]*e[3]+t[5]*e[7]+t[6]*e[11]+t[7]*e[15],i[8]=t[8]*e[0]+t[9]*e[4]+t[10]*e[8]+t[11]*e[12],i[9]=t[8]*e[1]+t[9]*e[5]+t[10]*e[9]+t[11]*e[13],i[10]=t[8]*e[2]+t[9]*e[6]+t[10]*e[10]+t[11]*e[14],i[11]=t[8]*e[3]+t[9]*e[7]+t[10]*e[11]+t[11]*e[15],i[12]=t[12]*e[0]+t[13]*e[4]+t[14]*e[8]+t[15]*e[12],i[13]=t[12]*e[1]+t[13]*e[5]+t[14]*e[9]+t[15]*e[13],i[14]=t[12]*e[2]+t[13]*e[6]+t[14]*e[10]+t[15]*e[14],i[15]=t[12]*e[3]+t[13]*e[7]+t[14]*e[11]+t[15]*e[15],arguments.length<=2?i:o.apply(null,[i].concat(Array.prototype.slice.call(arguments,2)))},n.multiply=function s(t,e){if(!t||!e)return t||e;var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];return i[0]=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],i[1]=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],i[2]=t[0]*e[2]+t[1]*e[6]+t[2]*e[10],i[4]=t[4]*e[0]+t[5]*e[4]+t[6]*e[8],i[5]=t[4]*e[1]+t[5]*e[5]+t[6]*e[9],i[6]=t[4]*e[2]+t[5]*e[6]+t[6]*e[10],i[8]=t[8]*e[0]+t[9]*e[4]+t[10]*e[8],i[9]=t[8]*e[1]+t[9]*e[5]+t[10]*e[9],i[10]=t[8]*e[2]+t[9]*e[6]+t[10]*e[10],i[12]=t[12]*e[0]+t[13]*e[4]+t[14]*e[8]+e[12],i[13]=t[12]*e[1]+t[13]*e[5]+t[14]*e[9]+e[13],i[14]=t[12]*e[2]+t[13]*e[6]+t[14]*e[10]+e[14],arguments.length<=2?i:s.apply(null,[i].concat(Array.prototype.slice.call(arguments,2)))},n.move=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},n.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],o=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],s=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return n.move(e,[i,o,s])},n.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},n.scale=function(t,e,i){return void 0===i&&(i=1),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},n.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},n.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},n.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},n.rotate=function(t,e,i){var n=Math.cos(t),o=Math.sin(t),s=Math.cos(e),r=Math.sin(e),a=Math.cos(i),u=Math.sin(i),c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];return c[0]=s*a,c[1]=n*u+o*r*a,c[2]=o*u-n*r*a,c[4]=-s*u,c[5]=n*a-o*r*u,c[6]=o*a+n*r*u,c[8]=r,c[9]=-o*s,c[10]=n*s,c},n.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),o=1-n,s=t[0]*t[0]*o,r=t[0]*t[1]*o,a=t[0]*t[2]*o,u=t[1]*t[1]*o,c=t[1]*t[2]*o,h=t[2]*t[2]*o,l=t[0]*i,p=t[1]*i,f=t[2]*i,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];return d[0]=s+n,d[1]=r+f,d[2]=a-p,d[4]=r-f,d[5]=u+n,d[6]=c+l,d[8]=a+p,d[9]=c-l,d[10]=h+n,d},n.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),o=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),s=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return n.move(e,[i,o,s])},n.formatCSS=function(t){for(var e=t.slice(0),i=0;i<e.length;i++)e[i]<1e-6&&e[i]>-1e-6&&(e[i]=0);return"matrix3d("+e.join()+")"},n.skew=function(t,e,i){return[1,0,0,0,Math.tan(i),1,0,0,Math.tan(e),Math.tan(t),1,0,0,0,0,1]},n.getTranslate=function(t){return[t[12],t[13],t[14]]},n.inverse=function(t){var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],i=t[5]*t[10]-t[6]*t[9],n=t[4]*t[10]-t[6]*t[8],o=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],r=t[0]*t[10]-t[2]*t[8],a=t[0]*t[9]-t[1]*t[8],u=t[1]*t[6]-t[2]*t[5],c=t[0]*t[6]-t[2]*t[4],h=t[0]*t[5]-t[1]*t[4],l=t[0]*i-t[1]*n+t[2]*o,p=1/l;return e[0]=p*i,e[1]=-p*s,e[2]=p*u,e[4]=-p*n,e[5]=p*r,e[6]=-p*c,e[8]=p*o,e[9]=-p*a,e[10]=p*h,e[12]=-t[12]*e[0]-t[13]*e[4]-t[14]*e[8],e[13]=-t[12]*e[1]-t[13]*e[5]-t[14]*e[9],e[14]=-t[12]*e[2]-t[13]*e[6]-t[14]*e[10],e},n.interpret=function(t){function e(t){return 2==t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function i(t){return Math.sqrt(e(t))}function o(t){return 0>t?-1:1}var s=[t[0],t[1],t[2]],r=o(s[0]),a=i(s),u=[s[0]+r*a,s[1],s[2]],c=2/e(u),h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];h[0]=1-c*u[0]*u[0],h[5]=1-c*u[1]*u[1],h[10]=1-c*u[2]*u[2],h[1]=-c*u[0]*u[1],h[2]=-c*u[0]*u[2],h[6]=-c*u[1]*u[2],h[4]=h[1],h[8]=h[2],h[9]=h[6];var l=n.multiply(t,h),p=[l[5],l[6]],f=o(p[0]),d=i(p),m=[p[0]+f*d,p[1]],v=2/e(m),g=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];g[5]=1-v*m[0]*m[0],g[10]=1-v*m[1]*m[1],g[6]=-v*m[0]*m[1],g[9]=g[6];var y=n.multiply(h,g),b=n.multiply(t,y),w=n.scale(b[0]<0?-1:1,b[5]<0?-1:1,b[10]<0?-1:1);b=n.multiply(w,b),y=n.multiply(y,w);var S={};return S.translate=n.getTranslate(t),S.rotate=[Math.atan2(-y[6],y[10]),Math.asin(y[2]),Math.atan2(-y[1],y[0])],S.rotate[0]||(S.rotate[0]=0,S.rotate[2]=Math.atan2(y[4],y[5])),S.scale=[b[0],b[5],b[10]],S.skew=[Math.atan(b[9]/S.scale[2]),Math.atan(b[8]/S.scale[2]),Math.atan(b[4]/S.scale[0])],Math.abs(S.rotate[0])+Math.abs(S.rotate[2])>1.5*Math.PI&&(S.rotate[1]=Math.PI-S.rotate[1],S.rotate[1]>Math.PI&&(S.rotate[1]-=2*Math.PI),S.rotate[1]<-Math.PI&&(S.rotate[1]+=2*Math.PI),S.rotate[0]<0?S.rotate[0]+=Math.PI:S.rotate[0]-=Math.PI,S.rotate[2]<0?S.rotate[2]+=Math.PI:S.rotate[2]-=Math.PI),S},n.build=function(t){var e=n.scale(t.scale[0],t.scale[1],t.scale[2]),i=n.skew(t.skew[0],t.skew[1],t.skew[2]),o=n.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return n.move(n.multiply(e,i,o),t.translate)},n.equals=function(t,e){if(t===e)return!0;if(!t||!e)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},n.normalizeRotation=function(t){var e=t.slice(0);for((e[0]==Math.PI/2||e[0]==-Math.PI/2)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>Math.PI/2&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<-Math.PI/2&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},n.vecMultiply=function(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+e[12],t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+e[13],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+e[14]]},n.applyPerspective=function(t,e){var i=e/(e-t[2]);return[i*t[0],i*t[1]]},i.exports=n}),define("app/custom/Surface",["require","exports","module","famous/Entity","famous/EventHandler","famous/Matrix"],function(t,e,i){function o(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=void 0,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=void 0,this._opacity=1,this._origin=void 0,this._size=void 0,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new f,this.eventHandler.bindThis(this),this.id=p.register(this),t&&this.setOptions(t),this._currTarget=void 0}function s(t){for(var e=this.surfaceEvents,i=0;i<e.length;i++)t.addEventListener(e[i],this.eventForwarder)}function r(t){for(var e=this.surfaceEvents,i=0;i<e.length;i++)t.removeEventListener(e[i],this.eventForwarder)}function a(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function u(t){for(var e in this.properties)t.style[e]=this.properties[e]}function c(t){for(var e in this.properties)t.style[e]=""}function h(t,e){return t||e?t&&e?t[0]==e[0]&&t[1]==e[1]:!1:!0}function l(t){return(100*t[0]).toFixed(6)+"% "+(100*t[1]).toFixed(6)+"%"}var p=t("famous/Entity"),f=t("famous/EventHandler"),d=t("famous/Matrix"),m=void 0!==document.body.style.webkitTransform;o.prototype.surfaceEvents=["touchstart","touchmove","touchend","touchcancel","click","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","wheel","keyup","keydown"],o.prototype.elementType="div",o.prototype.elementClass="surface",o.prototype.on=function(t,e){this.eventHandler.on(t,e)},o.prototype.unbind=function(t,e){this.eventHandler.unbind(t,e)},o.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this.eventHandler.emit(t,e);return i&&e.stopPropagation&&e.stopPropagation(),i},o.prototype.pipe=function(t){return this.eventHandler.pipe(t)},o.prototype.pipeEvents=function(){return console.warn("pipeEvents is deprecated; use pipe instead"),this.pipe.apply(this,arguments)},o.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},o.prototype.render=function(){return this.id},o.prototype.setProperties=function(t){for(n in t)this.properties[n]=t[n];this._stylesDirty=!0},o.prototype.getProperties=function(){return this.properties},o.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},o.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0)},o.prototype.setClasses=function(t){for(var e=[],i=0;i<this.classList.length;i++)t.indexOf(this.classList[i])<0&&e.push(this.classList[i]);for(var i=0;i<e.length;i++)this.removeClass(e[i]);for(var i=0;i<t.length;i++)this.addClass(t[i])},o.prototype.getClassList=function(){return this.classList},o.prototype.setContent=function(t){this.content!=t&&(this.content=t,this._contentDirty=!0)},o.prototype.getContent=function(){return this.content},o.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)};var v,g,y;v=m?function(t,e){t.style.webkitTransform=d.formatCSS(e)}:function(t,e){t.style.transform=d.formatCSS(e)},g=m?function(t,e){t.style.webkitTransformOrigin=l(e)}:function(t,e){t.style.transformOrigin=l(e)},y=m?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0},o.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);s.call(this,e),g(e,[0,0]),this._currTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=void 0,this._opacity=void 0,this._origin=void 0,this._size=void 0},o.prototype.commit=function(t,e,i,n,o){this._currTarget||this.setup(t.getAllocator());var s=this._currTarget;if(this.size){var r=o;o=this.size.slice(0),void 0===o[0]&&r[0]&&(o[0]=r[0]),void 0===o[1]&&r[1]&&(o[1]=r[1])}if(h(this._size,o)||(this._size=o.slice(0),this._sizeDirty=!0),!e&&this._matrix)return this._matrix=void 0,this._opacity=0,y(s),void 0;if(this._opacity!==i&&(this._opacity=i,s.style.opacity=Math.min(i,.999999)),!h(this._origin,n)||!d.equals(this._matrix,e)){e||(e=d.identity),n||(n=[0,0]),this._origin=n.slice(0),this._matrix=e;var c=e;n&&(c=d.moveThen([-this._size[0]*n[0],-this._size[1]*n[1]],e)),v(s,c)}if(this._classesDirty||this._stylesDirty||this._sizeDirty||this._contentDirty){if(this._classesDirty){a.call(this,s);for(var l=this.getClassList(),p=0;p<l.length;p++)s.classList.add(l[p]);this._classesDirty=!1}this._stylesDirty&&(u.call(this,s),this._stylesDirty=!1),this._sizeDirty&&(this._size&&(s.style.width=this._size[0]!==!0?this._size[0]+"px":"",s.style.height=this._size[1]!==!0?this._size[1]+"px":""),this._sizeDirty=!1),this._contentDirty&&(this.deploy(s),this._contentDirty=!1)}},o.prototype.cleanup=function(t){var e=this._currTarget;this.recall(e),e.style.width="",e.style.height="",this._size=void 0,c.call(this,e);var i=this.getClassList();a.call(this,e);for(var n=0;n<i.length;n++)e.classList.remove(i[n]);if(this.elementClass)if(this.elementClass instanceof Array)for(var n=0;n<this.elementClass.length;n++)e.classList.remove(this.elementClass[n]);else e.classList.remove(this.elementClass);r.call(this,e),this._currTarget=void 0,t.deallocate(e),y(e)},o.prototype.deploy=function(t){var e=this.getContent();"string"==typeof e?t.innerHTML=e:t.appendChild(e)},o.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},o.prototype.getSize=function(t){return t?this._size:this.size||this._size},o.prototype.setSize=function(t){this.size=t?t.slice(0,2):void 0,this._sizeDirty=!0},i.exports=o}),define("app/custom/ConversationSurface",["require","exports","module","./Surface"],function(t,e,i){function n(){o.apply(this,arguments),this.setSize([void 0,!0])}var o=t("./Surface");n.prototype=Object.create(o.prototype),n.prototype.surfaceEvents=o.prototype.surfaceEvents.concat(["load"]),n.prototype.deploy=function(t){o.prototype.deploy.apply(this,arguments),this.__size=[t.offsetWidth,t.offsetHeight]},n.prototype.getSize=function(){return this.__size||this._size||this.size},i.exports=n}),define("famous/Utility",["require","exports","module"],function(t,e,i){var n={};n.Curve={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.Direction={X:0,Y:1,Z:2},n.Origin={tl:[0,0],t:[.5,0],tr:[1,0],l:[0,.5],c:[.5,.5],r:[1,.5],bl:[0,1],b:[.5,1],br:[1,1]},n.after=function(t,e){var i=t;return function(){i--,0===i&&e.apply(this,arguments)}},n.loadURL=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()},n.transformInFrontMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1],n.transformInFront={render:function(t){return{transform:n.transformInFrontMatrix,target:t}}},n.transformBehindMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-1,1],n.transformBehind={render:function(t){return{transform:n.transformBehindMatrix,target:t}}},n.customizeComponent=function(t,e,i){var n=function(n){t.call(this,e),n&&this.setOptions(n),i&&i.call(this)};return n.prototype=Object.create(t.prototype),n},i.exports=n}),define("famous/MultipleTransition",["require","exports","module","./Utility"],function(t,e,i){function n(t){this.method=t,this._instances=[],this.state=[]}var o=t("./Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,e,i){for(var n=o.after(t.length,i),s=0;s<t.length;s++)this._instances[s]||(this._instances[s]=new this.method),this._instances[s].set(t[s],e,n)},n.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=n}),define("famous/TweenTransition",["require","exports","module","famous/Utility"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0}function o(t,e,i){return(1-i)*t+i*e}function s(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function r(t,e){var i={curve:e.curve};return e.duration&&(i.duration=e.duration),e.speed&&(i.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(i.duration=t.duration),t.curve&&(i.curve=t.curve),t.speed&&(i.speed=t.speed)),"string"==typeof i.curve&&(i.curve=n.getCurve(i.curve)),i}var a=t("famous/Utility");n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:a.Curve.linear,duration:500,speed:0};var u={};n.registerCurve=function(t,e){return u[t]?!1:(u[t]=e,!0)},n.unregisterCurve=function(t){return u[t]?(delete u[t],!0):!1},n.getCurve=function(t){return u[t]},n.getCurves=function(){return u},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),void 0;if(this._startValue=s(this.get()),e=r(e,this.options),e.speed){var n=this._startValue;if(n instanceof Object){var o=0;for(var a in n)o+=(t[a]-n[a])*(t[a]-n[a]);e.duration=Math.sqrt(o)/e.speed}else e.duration=Math.abs(t-n)/e.speed}this._startTime=Date.now(),this._endValue=s(t),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=i},n.prototype.reset=function(t){if(this._callback){var e=this._callback;this._callback=void 0,e()}this.state=s(t),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._endValue=this.state,this._active=!1},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this._active=!1;else if(0>e)this.state=this._startValue;else{var i=e/this._duration;if(this.state instanceof Object)for(var n in this.state)this.state[n]=o(this._startValue[n],this._endValue[n],this._curve(i));else this.state=o(this._startValue,this._endValue,this._curve(i))}}}else if(this._callback){var s=this._callback;this._callback=void 0,s()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",a.Curve.linear),n.registerCurve("easeIn",a.Curve.easeIn),n.registerCurve("easeOut",a.Curve.easeOut),n.registerCurve("easeInOut",a.Curve.easeInOut),n.registerCurve("easeOutBounce",a.Curve.easeOutBounce),n.registerCurve("spring",a.Curve.spring),i.exports=n}),define("famous/Transitionable",["require","exports","module","./Utility","./MultipleTransition","./TweenTransition"],function(t,e,i){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function o(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return this.set(this._engineInstance),void 0;this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,i=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(e=n.method,"string"==typeof e&&(e=a[e])):e=r,this._currentMethod!==e&&(this._engineInstance=!(i instanceof Object)||e.SUPPORTS_MULTIPLE===!0||i.length<=e.SUPPORTS_MULTIPLE?new e:new s(e),this._currentMethod=e),this._engineInstance.reset(this.state),this._engineInstance.set(i,n,o.bind(this))}var s=(t("./Utility"),t("./MultipleTransition")),r=t("./TweenTransition"),a={};n.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),void 0;var n=[t,e];this.actionQueue.push(n),this.callbackQueue.push(i),this.currentAction||o.call(this)},n.prototype.reset=function(t){this._currentMethod=null,this._engineInstance=null,this.state=t,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,e){this.set(this._engineInstance,{duration:t,curve:function(){return 0}},e)},n.prototype.get=function(t){return this._engineInstance&&(this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){this.set(this.get())},i.exports=n}),define("famous/Modifier",["require","exports","module","./Matrix","./Transitionable","./Utility"],function(t,e,i){function n(t){var e=o.identity,i=1,n=void 0,r=void 0;arguments.length>1||arguments[0]instanceof Array?(void 0!==arguments[0]&&(e=arguments[0]),void 0!==arguments[1]&&(i=arguments[1]),n=arguments[2],r=arguments[3]):t&&(t.transform&&(e=t.transform),void 0!==t.opacity&&(i=t.opacity),t.origin&&(n=t.origin),t.size&&(r=t.size)),this.transformTranslateState=new s([0,0,0]),this.transformRotateState=new s([0,0,0]),this.transformSkewState=new s([0,0,0]),this.transformScaleState=new s([1,1,1]),this.opacityState=new s(i),this.originState=new s([0,0]),this.sizeState=new s([0,0]),this._originEnabled=!1,this._sizeEnabled=!1,this.setTransform(e),this.setOpacity(i),this.setOrigin(n),this.setSize(r)}var o=t("./Matrix"),s=t("./Transitionable"),r=t("./Utility");n.prototype.getTransform=function(){return this.isActive()?o.build({translate:this.transformTranslateState.get(),rotate:this.transformRotateState.get(),skew:this.transformSkewState.get(),scale:this.transformScaleState.get()}):this.getFinalTransform()},n.prototype.getFinalTransform=function(){return this._finalTransform},n.prototype.setTransform=function(t,e,i){var n=i?r.after(4,i):void 0;if(e){if(this._transformDirty){var s=o.interpret(this.getFinalTransform());this.transformTranslateState.set(s.translate),this.transformRotateState.set(s.rotate),this.transformSkewState.set(s.skew),this.transformScaleState.set(s.scale),this._transformDirty=!1}var a=o.interpret(t);this.transformTranslateState.set(a.translate,e,n),this.transformRotateState.set(a.rotate,e,n),this.transformSkewState.set(a.skew,e,n),this.transformScaleState.set(a.scale,e,n)}else this.transformTranslateState.halt(),this.transformRotateState.halt(),this.transformSkewState.halt(),this.transformScaleState.halt(),this._transformDirty=!0;this._finalTransform=t},n.prototype.getOpacity=function(){return this.opacityState.get()},n.prototype.setOpacity=function(t,e,i){this.opacityState.set(t,e,i)},n.prototype.getOrigin=function(){return this._originEnabled?this.originState.get():void 0},n.prototype.setOrigin=function(t,e,i){this._originEnabled=!!t,t||(t=[0,0]),t instanceof Array||(t=r.origins[t]),this.originState.set(t,e,i)},n.prototype.getSize=function(){return this._sizeEnabled?this.sizeState.get():void 0},n.prototype.setSize=function(t,e,i){this._sizeEnabled=!!t,t||(t=[0,0]),this.sizeState.set(t,e,i)},n.prototype.setDefaultTransition=function(t){this.transformTranslateState.setDefault(t),this.transformRotateState.setDefault(t),this.transformSkewState.setDefault(t),this.transformScaleState.setDefault(t),this.opacityState.setDefault(t),this.originState.setDefault(t),this.sizeState.setDefault(t)},n.prototype.halt=function(){this.transformTranslateState.halt(),this.transformRotateState.halt(),this.transformSkewState.halt(),this.transformScaleState.halt(),this.opacityState.halt(),this.originState.halt(),this.sizeState.halt()},n.prototype.isActive=function(){return this.transformTranslateState.isActive()||this.transformRotateState.isActive()||this.transformSkewState.isActive()||this.transformScaleState.isActive()},n.prototype.render=function(t){return{transform:this.getTransform(),opacity:this.getOpacity(),origin:this.getOrigin(),size:this.getSize(),target:t}},i.exports=n}),define("famous/SpecParser",["require","exports","module","./Matrix"],function(t,e,i){function n(){this.reset()}function o(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var s=t("./Matrix");n.parse=function(t,e){var i=new n,o=i.parse(t);return e?(e(o),void 0):o},n.prototype.parse=function(t){return this.reset(),this._parseSpec(t,s.identity,1,[0,0],void 0,s.identity),this.result},n.prototype.reset=function(){this.result={}},n.prototype._parseSpec=function(t,e,i,n,r,a){if(void 0==t);else if("number"==typeof t){var u=t,c=r?[n[0]*r[0],n[1]*r[1],0]:[0,0,0];e||(e=s.identity),this.result[u]=[s.move(e,o(c,a)),i,n,r]}else if(t instanceof Array)for(var h=0;h<t.length;h++)this._parseSpec(t[h],e,i,n,r,a);else if(void 0!==t.target){var l=t.target,p=e,f=i,d=n,m=r;void 0!==t.opacity&&(f=i*t.opacity),t.transform&&(p=s.multiply(t.transform,e)),t.origin&&(d=t.origin),t.size&&(m=t.size,void 0===m[0]&&(m[0]=r[0]),void 0===m[1]&&(m[1]=r[1]),r||(r=m),d||(d=[0,0]),p||(p=s.identity),p=s.move(p,o([d[0]*r[0],d[1]*r[1],0],a)),p=s.moveThen([-d[0]*m[0],-d[1]*m[1],0],p),a=e?e:s.identity,d=[0,0]),this._parseSpec(l,p,f,d,m,a)}},i.exports=n}),define("famous/RenderNode",["require","exports","module","./Entity","./SpecParser","./Matrix"],function(t,e,i){function n(t){this.modifiers=[],this.object=void 0,t&&this.set(t),this._hasCached=!1,this._resultCache={},this._prevResults={}}function o(t,e,i){var n=r.parse(t);for(var a in n){var u=s.get(a),c=n[a];c.unshift(e);var h=u.commit.apply(u,c);h?o(h,e,i):i[a]=c}}{var s=t("./Entity"),r=t("./SpecParser");t("./Matrix")}n.prototype.get=function(){return this.object},n.prototype.set=function(t){this.object=t},n.prototype.link=function(t){if(t instanceof Array)this.set(t);else{var e=this.get();e?e instanceof Array?this.modifiers.unshift(t):(this.modifiers.unshift(e),this.set(t)):this.set(t)}return this},n.prototype.add=function(t){this.get()instanceof Array||this.set([]);var e=new n(t);return this.get().push(e),e},n.prototype.mod=function(t){return this.modifiers.push(t),this},n.prototype.commit=function(t,e,i,n,r){var a=this.render(void 0,this._hasCached);if(a!==!0){for(var u in this._prevResults)if(!(u in this._resultCache)){var c=s.get(u);c.cleanup&&c.cleanup(t.getAllocator())}this._prevResults=this._resultCache,this._resultCache={},o({transform:e,size:r,origin:n,opacity:i,target:a},t,this._resultCache),this._hasCached=!0}},n.prototype.render=function(t){var e=t,i=this.get();if(i)if(i.render)e=i.render(t);else{var n=i.length-1;for(e=new Array(n);n>=0;)e[n]=i[n].render(),n--}for(var o=this.modifiers.length,n=0;o>n;n++)e=this.modifiers[n].render(e);return e},i.exports=n}),define("famous-animation/Easing",["require","exports","module"],function(t,e,i){var n={linear:function(t,e,i,n){return t*(i/n)+e},linearNorm:function(t){return t},inQuad:function(t,e,i,n){return i*(t/=n)*t+e},inQuadNorm:function(t){return t*t},outQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},outQuadNorm:function(t){return-(t-=1)*t+1},inOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},inOutQuadNorm:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},inCubicNorm:function(t){return t*t*t},outCubic:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},outCubicNorm:function(t){return--t*t*t+1},inOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},inOutCubicNorm:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},inQuartNorm:function(t){return t*t*t*t},outQuart:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},outQuartNorm:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},inOutQuartNorm:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},inQuintNorm:function(t){return t*t*t*t*t},outQuint:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},outQuintNorm:function(t){return--t*t*t*t*t+1},inOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},inOutQuintNorm:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},inSineNorm:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},outSineNorm:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},inOutSineNorm:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t,e,i,n){return 0==t?e:i*Math.pow(2,10*(t/n-1))+e},inExpoNorm:function(t){return 0==t?0:Math.pow(2,10*(t-1))},outExpo:function(t,e,i,n){return t==n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},outExpoNorm:function(t){return 1==t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t,e,i,n){return 0==t?e:t==n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e},inOutExpoNorm:function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},inCircNorm:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},outCircNorm:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},inOutCircNorm:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t,e,i,n){var o=1.70158,s=0,r=i;if(0==t)return e;if(1==(t/=n))return e+i;if(s||(s=.3*n),r<Math.abs(i)){r=i;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(i/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/s))+e},inElasticNorm:function(t){var e=1.70158,i=0,n=1;return 0==t?0:1==t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},outElastic:function(t,e,i,n){var o=1.70158,s=0,r=i;if(0==t)return e;if(1==(t/=n))return e+i;if(s||(s=.3*n),r<Math.abs(i)){r=i;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(i/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*n-o)*Math.PI/s)+i+e},outElasticNorm:function(t){var e=1.70158,i=0,n=1;return 0==t?0:1==t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},inOutElastic:function(t,e,i,n){var o=1.70158,s=0,r=i;
if(0==t)return e;if(2==(t/=n/2))return e+i;if(s||(s=.3*n*1.5),r<Math.abs(i)){r=i;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(i/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/s)+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/s)*.5+i+e},inOutElasticNorm:function(t){var e=1.70158,i=0,n=1;return 0==t?0:2==(t/=.5)?1:(i||(i=.3*1.5),e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)},inBack:function(t,e,i,n,o){return void 0==o&&(o=1.70158),i*(t/=n)*t*((o+1)*t-o)+e},inBackNorm:function(t,e){return void 0==e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e,i,n,o){return void 0==o&&(o=1.70158),i*((t=t/n-1)*t*((o+1)*t+o)+1)+e},outBackNorm:function(t,e){return void 0==e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e,i,n,o){return void 0==o&&(o=1.70158),(t/=n/2)<1?i/2*t*t*(((o*=1.525)+1)*t-o)+e:i/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+e},inOutBackNorm:function(t,e){return void 0==e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t,e,i,o){return i-n.outBounce(o-t,0,i,o)+e},inBounceNorm:function(t){return 1-n.outBounceNorm(1-t)},outBounce:function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},outBounceNorm:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t,e,i,o){return o/2>t?.5*n.inBounce(2*t,0,i,o)+e:.5*n.outBounce(2*t-o,0,i,o)+.5*i+e},inOutBounceNorm:function(t){return.5>t?.5*n.inBounceNorm(2*t):.5*n.outBounceNorm(2*t-1)+.5}};i.exports=n}),define("app/custom/InComingTransform",["require","exports","module","famous/Matrix","famous/Modifier","famous/RenderNode","famous/Utility","famous-animation/Easing"],function(t,e,i){function n(){this.options={inTransform:o.scale(.001,.001,.001),inOpacity:1,inOrigin:[.5,.5],outTransform:o.scale(.001,.001,.001),outOpacity:1,outOrigin:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:{duration:500,curve:s.inQuintNorm()},outTransition:{duration:500,curve:s.outQuintNorm()},overlap:!0}}var o=t("famous/Matrix"),s=(t("famous/Modifier"),t("famous/RenderNode"),t("famous/Utility"),t("famous-animation/Easing"));i.exports=n}),define("app/custom/LightBox",["require","exports","module","famous/Matrix","famous/Modifier","famous/RenderNode","famous/Utility"],function(t,e,i){function n(t){this.options={inTransform:o.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],outTransform:o.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[]}var o=t("famous/Matrix"),s=t("famous/Modifier"),r=t("famous/RenderNode"),a=t("famous/Utility");n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.inTransform&&(this.options.inTransform=t.inTransform),void 0!==t.inOpacity&&(this.options.inOpacity=t.inOpacity),void 0!==t.inOrigin&&(this.options.inOrigin=t.inOrigin),void 0!==t.outTransform&&(this.options.outTransform=t.outTransform),void 0!==t.outOpacity&&(this.options.outOpacity=t.outOpacity),void 0!==t.outOrigin&&(this.options.outOrigin=t.outOrigin),void 0!==t.showTransform&&(this.options.showTransform=t.showTransform),void 0!==t.showOpacity&&(this.options.showOpacity=t.showOpacity),void 0!==t.showOrigin&&(this.options.showOrigin=t.showOrigin),void 0!==t.inTransition&&(this.options.inTransition=t.inTransition),void 0!==t.outTransition&&(this.options.outTransition=t.outTransition),void 0!==t.overlap&&(this.options.overlap=t.overlap)},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,i)),void 0;this.hide()}this._showing=!0,t.options&&this.setOptions(t.options);var n=new s({transform:this.options.inTransform,opacity:this.options.inOpacity,origin:this.options.inOrigin}),o=new r;o.link(n).link(t),this.nodes.push(o),this.transforms.push(n);var u=i?a.after(3,i):void 0;e||(e=this.options.inTransition),n.setTransform(this.options.showTransform,e,u),n.setOpacity(this.options.showOpacity,e,u),n.setOrigin(this.options.showOrigin,e,u)},n.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var i=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],o=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(i),1),this.transforms.splice(this.transforms.indexOf(n),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),n.setTransform(this.options.outTransform,t,o),n.setOpacity(this.options.outOpacity,t,o),n.setOrigin(this.options.outOrigin,t,o)}},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=n}),define("app/custom/MouseSync",["require","exports","module","famous/EventHandler"],function(t,e,i){function n(t,e){this.targetGet=t,this.options={direction:void 0,rails:!1,scale:1,stallTime:50,propogate:!0},e?this.setOptions(e):this.setOptions(this.options),this.input=new u,this.output=new u,u.setInputHandler(this,this.input),u.setOutputHandler(this,this.output),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0,this.input.on("mousedown",o.bind(this)),this.input.on("mousemove",s.bind(this)),this.input.on("mouseup",r.bind(this)),this.options.propogate?this.input.on("mouseleave",a.bind(this)):this.input.on("mouseleave",r.bind(this))}function o(t){t.preventDefault(),this._prevCoord=[t.clientX,t.clientY],this._prevTime=Date.now(),this._prevVel=void 0!==this.options.direction?0:[0,0],this.output.emit("start")}function s(t){if(this._prevCoord){var e=this._prevCoord,i=this._prevTime,o=[t.clientX,t.clientY],s=Date.now(),r=o[0]-e[0],a=o[1]-e[1];this.options.rails&&(Math.abs(r)>Math.abs(a)?a=0:r=0);var u,c,h=Math.max(s-i,8),l=r/h,p=a/h,f=this.targetGet(),d=this.options.scale;this.options.direction==n.DIRECTION_X?(u=f+d*r,c=d*l):this.options.direction==n.DIRECTION_Y?(u=f+d*a,c=d*p):(u=[f[0]+d*r,f[1]+d*a],c=[d*l,d*p]),this.output.emit("update",{ap:[o[0],o[1]],p:u,v:c}),this._prevCoord=o,this._prevTime=s,this._prevVel=c}}function r(){if(this._prevCoord){var t=this._prevTime,e=Date.now();e-t>this.options.stallTime&&(this._prevVel=void 0==this.options.direction?[0,0]:0);var i=this.targetGet();this.output.emit("end",{p:i,v:this._prevVel}),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0}}function a(){if(this._prevCoord){var t=function(t){s.call(this,t)}.bind(this),e=function(i){r.call(this,i),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}.bind(this);document.addEventListener("mousemove",t),document.addEventListener("mouseup",e)}}var u=t("famous/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime),void 0!==t.propogate&&(this.options.propogate=t.propogate)},i.exports=n}),define("app/custom/Templates",["require","exports","module"],function(t,e,i){function n(t,e,i){var n='<div class="onoffswitch">';return n+='<input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="'+t+'" ',e&&(n+="checked "),i&&(n+="disabled "),n+='><label class="onoffswitch-label',i&&(n+=" disabled"),n+='" for="'+t+'">',n+='<div class="onoffswitch-inner"></div>',n+='<div class="onoffswitch-switch"></div>',n+="</label>",n+="</div>"}function o(t){t.id||(t.id="toggleButton"+Math.floor(1e5*Math.random())),t.classes||(t.classes=[]);var e='<div class="onoffbutton '+t.classes.join(" ")+'">';return e+='<input type="checkbox" name="onoffbutton" class="onoffbutton-checkbox"',t.id&&(e+=' id="'+t.id+'" '),t.checked&&(e+="checked"),e+='><label class="onoffbutton-label" for="'+t.id+'"',t.size&&(e+='style="width:'+t.size[0]+"px;",e+="line-height:"+t.size[1]+'px;"'),e+=">",e+='<div class="onoffbutton-on"',t.onBackgroundColor&&(e+='style="background-color:'+t.onBackgroundColor+';"'),e+=">"+t.onContent+"</div>",e+='<div class="onoffbutton-off"',t.offBackgroundColor&&(e+='style="background-color:'+t.offBackgroundColor+';"'),e+=">"+t.offContent+"</div>",e+="</label>",e+="</div>"}function s(t){t.id||(t.id="button"+Math.floor(1e5*Math.random())),t.classes||(t.classes=[]);var e='<button class="button '+t.classes.join(" ")+'" style="';return t.size&&(e+="width:"+t.size[0]+"px;",e+="height:"+t.size[1]+"px;",e+="line-height:"+t.size[1]+"px;"),e+='">'+t.content+"</button>"}function r(){var t='<button class="delete-button fa fa-trash-o fa-lg"></button>';return t}function a(t){var e='<button class="favorite-button fa fa-star fa-lg';return t&&(e+=" active"),e+='"></button>'}function u(t){var e='<i class="arrow fa fa-angle-right fa-lg import-contact" id="'+t+'"></i>';return e}function c(t){var e='<i class="fa fa-plus add-button" id="'+t+'"></i>';return e}function h(t){var e='<i class="fa fa-times remove-button" id="'+t+'"></i>';return e}function l(){var t='<div class="recent-toggle"><input type="radio" id="all" name="recents-toggle" value="all" checked>';return t+='<label for="all" class="first" id="recent-toggle">all</label>',t+='<input type="radio" id="missed" name="recents-toggle" value="missed">',t+='<label for="missed" class="last" id="recent-toggle">missed</label></div>'}i.exports={toggleSwitch:n,toggleButton:o,deleteButton:r,addButton:c,removeButton:h,nextButton:u,favoriteButton:a,recentsToggle:l,button:s}}),define("famous-sync/TouchTracker",["require","exports","module","famous/EventHandler"],function(t,e,i){function n(t){this.selective=t,this.touchHistory={},this.eventHandler=new c(!0)}function o(t,e,i,n){var o={};for(var s in t)o[s]=t[s];return{touch:o,origin:e,timestamp:+Date.now(),count:n,history:i}}function s(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=o(i,t.origin,void 0,t.touches.length);this.eventHandler.emit("trackstart",n),this.selective||this.touchHistory[i.identifier]||this.track(n)}}function r(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=this.touchHistory[i.identifier];if(n){var s=o(i,t.origin,n,t.touches.length);this.touchHistory[i.identifier].push(s),this.eventHandler.emit("trackmove",s)}}}function a(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=this.touchHistory[i.identifier];if(n){var s=o(i,t.origin,n,t.touches.length);this.eventHandler.emit("trackend",s),delete this.touchHistory[i.identifier]}}}function u(){for(var t in this.touchHistory){var e=this.touchHistory[t];this.eventHandler.emit("trackend",{touch:e[e.length-1].touch,timestamp:+Date.now(),count:0,history:e}),delete this.touchHistory[t]}}var c=t("famous/EventHandler");n.prototype.track=function(t){this.touchHistory[t.touch.identifier]=[t]},n.prototype.emit=function(t,e){return"touchstart"==t?s.call(this,e):"touchmove"==t?r.call(this,e):"touchend"==t?a.call(this,e):"touchcancel"==t?a.call(this,e):"unpipe"==t?u.call(this):void 0},n.prototype.on=function(t,e){return this.eventHandler.on(t,e)},n.prototype.unbind=function(t,e){return this.eventHandler.unbind(t,e)},n.prototype.pipe=function(t){return this.eventHandler.pipe(t)},n.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},i.exports=n}),define("app/custom/TouchSync",["require","exports","module","famous-sync/TouchTracker","famous/EventHandler"],function(t,e,i){function n(t,e){this.targetGet=t,this.output=new u,this.touchTracker=new a,this.options={direction:void 0,rails:!1,scale:1},e?this.setOptions(e):this.setOptions(this.options),u.setOutputHandler(this,this.output),u.setInputHandler(this,this.touchTracker),this.touchTracker.on("trackstart",o.bind(this)),this.touchTracker.on("trackmove",s.bind(this)),this.touchTracker.on("trackend",r.bind(this))}function o(t){this.output.emit("start",{count:t.count,touch:t.touch.identifier})}function s(t){var e=t.history,i=e[e.length-2].timestamp,o=e[e.length-1].timestamp,s=e[e.length-2].touch,r=e[e.length-1].touch,a=r.pageX-s.pageX,u=r.pageY-s.pageY;this.options.rails&&(Math.abs(a)>Math.abs(u)?u=0:a=0);var c=Math.max(o-i,8),h=a/c,l=u/c;if(e.length>2)var p=e[e.length-3].touch,f=(r.pageX-2*s.pageX+p.pageX)/(c*c),d=(r.pageY-2*s.pageY+p.pageY)/(c*c);else var f=0,d=0;var m,v,g,y=this.targetGet(),b=this.options.scale;this.options.direction==n.DIRECTION_X?(m=y+b*a,v=b*h,g=b*l):this.options.direction==n.DIRECTION_Y?(m=y+b*u,v=b*l,g=b*d):(m=[y[0]+b*a,y[1]+b*u],v=[b*h,b*l],g=[b*f,b*d]),this.output.emit("update",{ap:[r.pageX,r.pageY],p:m,v:v,a:g,touch:t.touch.identifier})}function r(t){var e=void 0!==this.options.direction?0:[0,0],i=t.history,o=t.count,s=this.targetGet();if(i.length>1){var r=i[i.length-2].timestamp,a=i[i.length-1].timestamp,u=i[i.length-2].touch,c=i[i.length-1].touch,h=c.pageX-u.pageX,l=c.pageY-u.pageY;this.options.rails&&(Math.abs(h)>Math.abs(l)?l=0:h=0);var e,p=Math.max(a-r,1),f=h/p,d=l/p,m=this.options.scale;e=this.options.direction==n.DIRECTION_X?m*f:this.options.direction==n.DIRECTION_Y?m*d:[m*f,m*d]}this.output.emit("end",{p:s,v:e,count:o,touch:t.touch.identifier})}var a=t("famous-sync/TouchTracker"),u=t("famous/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.getOptions=function(){return this.options},i.exports=n}),define("app/custom/UpDownTransform",["require","exports","module","famous/Matrix","famous/Modifier","famous/RenderNode","famous/Utility","famous-animation/Easing"],function(t,e,i){function n(){this.options={inTransform:o.translate(0,1500,0),inOpacity:1,inOrigin:[.5,.5],outTransform:o.translate(0,600,0),outOpacity:1,outOrigin:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:{duration:500,curve:s.inQuadNorm()},outTransition:{duration:100,curve:s.outQuintNorm()},overlap:!0}}var o=t("famous/Matrix"),s=(t("famous/Modifier"),t("famous/RenderNode"),t("famous/Utility"),t("famous-animation/Easing"));i.exports=n}),define("famous/Surface",["require","exports","module","./Entity","./EventHandler","./Matrix"],function(t,e,i){function o(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=void 0,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=void 0,this._opacity=1,this._origin=void 0,this._size=void 0,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new f,this.eventHandler.bindThis(this),this.id=p.register(this),t&&this.setOptions(t),this._currTarget=void 0}function s(t){for(var e=this.surfaceEvents,i=0;i<e.length;i++)t.addEventListener(e[i],this.eventForwarder)}function r(t){for(var e=this.surfaceEvents,i=0;i<e.length;i++)t.removeEventListener(e[i],this.eventForwarder)}function a(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function u(t){for(var e in this.properties)t.style[e]=this.properties[e]}function c(t){for(var e in this.properties)t.style[e]=""}function h(t,e){return t||e?t&&e?t[0]==e[0]&&t[1]==e[1]:!1:!0}function l(t){return(100*t[0]).toFixed(6)+"% "+(100*t[1]).toFixed(6)+"%"}var p=t("./Entity"),f=t("./EventHandler"),d=t("./Matrix"),m=void 0!==document.body.style.webkitTransform;o.prototype.surfaceEvents=["touchstart","touchmove","touchend","touchcancel","click","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","mousewheel","wheel"],o.prototype.elementType="div",o.prototype.elementClass="surface",o.prototype.on=function(t,e){this.eventHandler.on(t,e)},o.prototype.unbind=function(t,e){this.eventHandler.unbind(t,e)},o.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this.eventHandler.emit(t,e);return i&&e.stopPropagation&&e.stopPropagation(),i},o.prototype.pipe=function(t){return this.eventHandler.pipe(t)},o.prototype.pipeEvents=function(){return console.warn("pipeEvents is deprecated; use pipe instead"),this.pipe.apply(this,arguments)},o.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},o.prototype.render=function(){return this.id},o.prototype.setProperties=function(t){for(n in t)this.properties[n]=t[n];this._stylesDirty=!0},o.prototype.getProperties=function(){return this.properties},o.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},o.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0)},o.prototype.setClasses=function(t){for(var e=[],i=0;i<this.classList.length;i++)t.indexOf(this.classList[i])<0&&e.push(this.classList[i]);for(var i=0;i<e.length;i++)this.removeClass(e[i]);for(var i=0;i<t.length;i++)this.addClass(t[i])},o.prototype.getClassList=function(){return this.classList},o.prototype.setContent=function(t){this.content!=t&&(this.content=t,this._contentDirty=!0)},o.prototype.getContent=function(){return this.content},o.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)};var v,g,y;v=m?function(t,e){t.style.webkitTransform=d.formatCSS(e)}:function(t,e){t.style.transform=d.formatCSS(e)},g=m?function(t,e){t.style.webkitTransformOrigin=l(e)}:function(t,e){t.style.transformOrigin=l(e)},y=m?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0},o.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);s.call(this,e),g(e,[0,0]),this._currTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=void 0,this._opacity=void 0,this._origin=void 0,this._size=void 0},o.prototype.commit=function(t,e,i,n,o){this._currTarget||this.setup(t.getAllocator());var s=this._currTarget;if(this.size){var r=o;o=this.size.slice(0),void 0===o[0]&&r[0]&&(o[0]=r[0]),void 0===o[1]&&r[1]&&(o[1]=r[1])}if(h(this._size,o)||(this._size=o.slice(0),this._sizeDirty=!0),!e&&this._matrix)return this._matrix=void 0,this._opacity=0,y(s),void 0;if(this._opacity!==i&&(this._opacity=i,s.style.opacity=Math.min(i,.999999)),!h(this._origin,n)||!d.equals(this._matrix,e)){e||(e=d.identity),n||(n=[0,0]),this._origin=n.slice(0),this._matrix=e;var c=e;n&&(c=d.moveThen([-this._size[0]*n[0],-this._size[1]*n[1]],e)),v(s,c)}if(this._classesDirty||this._stylesDirty||this._sizeDirty||this._contentDirty){if(this._classesDirty){a.call(this,s);for(var l=this.getClassList(),p=0;p<l.length;p++)s.classList.add(l[p]);this._classesDirty=!1}this._stylesDirty&&(u.call(this,s),this._stylesDirty=!1),this._sizeDirty&&(this._size&&(s.style.width=this._size[0]!==!0?this._size[0]+"px":"",s.style.height=this._size[1]!==!0?this._size[1]+"px":""),this._sizeDirty=!1),this._contentDirty&&(this.deploy(s),this._contentDirty=!1)}},o.prototype.cleanup=function(t){var e=this._currTarget;this.recall(e),e.style.width="",e.style.height="",this._size=void 0,c.call(this,e);var i=this.getClassList();a.call(this,e);for(var n=0;n<i.length;n++)e.classList.remove(i[n]);if(this.elementClass)if(this.elementClass instanceof Array)for(var n=0;n<this.elementClass.length;n++)e.classList.remove(this.elementClass[n]);else e.classList.remove(this.elementClass);r.call(this,e),this._currTarget=void 0,t.deallocate(e),y(e)},o.prototype.deploy=function(t){var e=this.getContent();"string"==typeof e?t.innerHTML=e:t.appendChild(e)},o.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},o.prototype.getSize=function(t){return t?this._size:this.size||this._size},o.prototype.setSize=function(t){this.size=t?t.slice(0,2):void 0,this._sizeDirty=!0},i.exports=o}),define("famous/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function o(){this.eventOutput=new s,this.eventOutput.bindThis(this),s.setOutputHandler(this,this.eventOutput)}var s=t("./EventHandler");n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)!(n in t&&"object"==typeof t[n])||t[n]instanceof Array||"object"!=typeof i[n]||i[n]instanceof Array?this.set(n,i[n]):(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()}))}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return this._value[t]},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.value=function(){return this._value},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.unbind=function(){return o.call(this),this.unbind.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous/View",["require","exports","module","./RenderNode","./EventHandler","./OptionsManager"],function(t,e,i){function n(t){this.node=new o,this.eventInput=new s,this.eventOutput=new s,s.setInputHandler(this,this.eventInput),s.setOutputHandler(this,this.eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this.optionsManager=new r(this.options),t&&this.setOptions(t)}var o=t("./RenderNode"),s=t("./EventHandler"),r=t("./OptionsManager");n.DEFAULT_OPTIONS=null,n.prototype.getOptions=function(){return this.optionsManager.value()},n.prototype.setOptions=function(t){this.optionsManager.patch(t)},n.prototype._add=function(){return this.node.add.apply(this.node,arguments)},n.prototype._link=function(){return this.node.link.apply(this.node,arguments)},n.prototype.render=function(){return this.node.render.apply(this.node,arguments)},n.prototype.getSize=function(){var t=this.node.get();return t.getSize?t.getSize.apply(t,arguments):this.options.size},i.exports=n}),define("famous-utils/TimeAgo",["require","exports","module"],function(t,e,i){function n(t){var e=Date.now(),i=e-t,n=6e4,o=60*n,s=24*o;if(n>i)return"Just Now";if(o>i){var r=~~(i/n);return r+"m"}if(s>i){var a=~~(i/o);return a+"h"}var u=~~(i/s);return u+"d"}i.exports={parse:n}}),define("app/custom/contactItemWidget",["require","exports","module","famous/Surface","famous/View","famous-utils/TimeAgo"],function(t,e,i){function n(t){s.apply(this,arguments),this.surface=new o({size:this.options.size,classes:this.options.classes}),t&&this.setOptions(t),this.surface.pipe(this.eventInput),this.optionsManager.on("change",function(t){if("content"==t.id)this.setContent(t.value);else{var e={};e[t.id]=t.value,this.surface.setOptions(e)}}.bind(this)),this.node.link(this.surface)}var o=t("famous/Surface"),s=t("famous/View"),r=t("famous-utils/TimeAgo");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={classes:["feedItem"],size:[void 0,80],content:{icon:void 0,source:void 0,time:void 0,text:""}},n.prototype.setContent=function(t){this.options.content=t;var e=.6*this.options.size[1],i='<img src="'+t.icon+'" class="icon" width="'+e+'" height="'+e+'" />',n='<p class="source">'+t.source+"</p>",o='<p class="time">'+r.parse(t.time)+"</p>",s='<p class="text">'+t.text+"</p>";this.surface.setContent(i+o+n+s)},i.exports=n}),define("app/models/Call",["require","exports","module"],function(t,e,i){i.exports=Backbone.Model.extend({defaults:{firstname:"John",lastname:"Doe",email:"",pictureUrl:"https://fbcdn-profile-a.akamaihd.net/hprofile-ak-prn2/c145.0.413.413/s320x320/168996_10150157179925337_3944102_n.jpg"}})}),define("app/models/CallCollection",["require","exports","module","app/models/Call","lib/backboneLocalStorage"],function(t,e,i){var n=t("app/models/Call");t("lib/backboneLocalStorage"),i.exports=Backbone.Collection.extend({localStorage:new Backbone.LocalStorage("colabeo-call-collection"),model:n,missed:function(){return this.filter(function(t){return!t.get("success")&&"incoming"==t.get("type")})},all:function(){return this.filter(function(){return!0})},comparator:function(t){return-1*t.get("time")}})}),define("app/models/Contact",["require","exports","module"],function(t,e,i){i.exports=Backbone.Model.extend({toggleFavorite:function(){this.set({favorite:!this.get("favorite")})}})}),define("app/models/ContactCollection",["require","exports","module","app/models/Contact"],function(t,e,i){var n=t("app/models/Contact");i.exports=Backbone.Firebase.Collection.extend({model:n,favorites:function(){return this.filter(function(t){return t.get("favorite")})},searchContact:function(t){return this.filter(function(e){return-1!=e.get("firstname").toUpperCase().indexOf(t)||-1!=e.get("lastname").toUpperCase().indexOf(t)?e.get("firstname"):void 0})},searchContactByEmail:function(t){return this.filter(function(e){return-1!=e.get("email").toUpperCase().indexOf(t)?e.get("email"):void 0})},comparator:function(t){var e=t.get("lastname"),i=t.get("firstname");return/^[a-zA-Z]+$/.test(e[0])||(e="zzzz"+e),(e+" "+i).toUpperCase()}})}),define("app/models/Conversation",["require","exports","module"],function(t,e,i){i.exports=Backbone.Model.extend({})}),define("app/models/ConversationCollection",["require","exports","module","app/models/Conversation","lib/backboneLocalStorage"],function(t,e,i){var n=t("app/models/Conversation");t("lib/backboneLocalStorage"),i.exports=Backbone.Collection.extend({localStorage:new Backbone.LocalStorage("colabeo-chat-colection"),model:n,comparator:function(t){return 1*t.get("time")}})}),define("app/models/Settings",["require","exports","module","lib/backboneLocalStorage"],function(t,e,i){t("lib/backboneLocalStorage"),i.exports=Backbone.Model.extend({localStorage:new Backbone.LocalStorage("colabeo-settings-1"),defaults:{cid:"default",email:"default@colabeo.com",linkAccounts:{facebook:!1,google:!1,linkedin:!1,github:!1,yammer:!1},firstname:"John",lastname:"Colabeo",notification:!1,camera:!1,video:!0,audio:!0,blur:void 0,userDatabaseUrl:"https://colabeo.firebaseio.com/users/",callDatabaseUrl:"https://colabeo.firebaseio.com/calls/",pHost:"dashboard.colabeo.com",pPort:9e3,pSecure:!0}})}),define("app/models/SocialContactCollection",["require","exports","module","app/models/Contact"],function(t,e,i){var n=t("app/models/Contact");i.exports=Backbone.Collection.extend({model:n,parse:function(t){var e=t.map(function(t){if(!t.firstname){var e=t.name.split(" ");t.lastname=e.pop(),t.firstname=e.join(" ")}return t});return e},searchContact:function(t){return this.filter(function(e){return-1!=e.get("firstname").toUpperCase().indexOf(t)||-1!=e.get("lastname").toUpperCase().indexOf(t)?e.get("firstname"):void 0})},comparator:function(t){var e=t.get("lastname"),i=t.get("firstname");return/^[a-zA-Z]+$/.test(e[0])||(e="zzzz"+e),(e+" "+i).toUpperCase()}})}),define("famous-views/HeaderFooterLayout",["require","exports","module","famous/Entity","famous/RenderNode","famous/Matrix"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._entityId=o.register(this),this._header=new s,this._footer=new s,this._content=new s,this.id={header:this._header,footer:this._footer,content:this._content}}var o=t("famous/Entity"),s=t("famous/RenderNode"),r=t("famous/Matrix");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DEFAULT_OPTIONS={direction:n.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},n.prototype.render=function(){return this._entityId},n.prototype.setOptions=function(t){for(var e in n.DEFAULT_OPTIONS)void 0!==t[e]&&(this.options[e]=t[e])},n.prototype.commit=function(t,e,i,o,s){function a(t,e){var i=t.get();if(!i||!i.getSize)return e;var n=i.getSize();return n[this.options.direction]||e}function u(t){return this.options.direction==n.DIRECTION_X?r.translate(t,0,0):r.translate(0,t,0)}function c(t){return this.options.direction==n.DIRECTION_X?[t,s[1]]:[s[0],t]}var h=void 0!==this.options.headerSize?this.options.headerSize:a.call(this,this._header,this.options.defaultHeaderSize),l=void 0!==this.options.footerSize?this.options.footerSize:a.call(this,this._footer,this.options.defaultFooterSize),p=s[this.options.direction]-h-l,f=[.5,.5],d=[.5,.5];f[this.options.direction]=0,d[this.options.direction]=1;var m=[{origin:f,size:c.call(this,h),target:this._header.render()},{transform:u.call(this,h),origin:f,size:c.call(this,p),target:this._content.render()},{origin:d,size:c.call(this,l),target:this._footer.render()}];e=r.move(e,[-s[0]*o[0],-s[1]*o[1],0]);var v={transform:e,opacity:i,origin:o,size:s,target:m};return v},i.exports=n}),define("famous-views/LightBox",["require","exports","module","famous/Matrix","famous/Modifier","famous/RenderNode","famous/Utility"],function(t,e,i){function n(t){this.options={inTransform:o.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],outTransform:o.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],showTransform:o.identity,showOpacity:1,showOrigin:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[]}var o=t("famous/Matrix"),s=t("famous/Modifier"),r=t("famous/RenderNode"),a=t("famous/Utility");n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.inTransform&&(this.options.inTransform=t.inTransform),void 0!==t.inOpacity&&(this.options.inOpacity=t.inOpacity),void 0!==t.inOrigin&&(this.options.inOrigin=t.inOrigin),void 0!==t.outTransform&&(this.options.outTransform=t.outTransform),void 0!==t.outOpacity&&(this.options.outOpacity=t.outOpacity),void 0!==t.outOrigin&&(this.options.outOrigin=t.outOrigin),void 0!==t.showTransform&&(this.options.showTransform=t.showTransform),void 0!==t.showOpacity&&(this.options.showOpacity=t.showOpacity),void 0!==t.showOrigin&&(this.options.showOrigin=t.showOrigin),void 0!==t.inTransition&&(this.options.inTransition=t.inTransition),void 0!==t.outTransition&&(this.options.outTransition=t.outTransition),void 0!==t.overlap&&(this.options.overlap=t.overlap)},n.prototype.show=function(t,e,i){if(!t)return this.hide(i);if(e instanceof Function&&(i=e,e=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,i)),void 0;this.hide()}this._showing=!0;var n=new s({transform:this.options.inTransform,opacity:this.options.inOpacity,origin:this.options.inOrigin}),o=new r;o.link(n).link(t),this.nodes.push(o),this.transforms.push(n);var u=i?a.after(3,i):void 0;e||(e=this.options.inTransition),n.setTransform(this.options.showTransform,e,u),n.setOpacity(this.options.showOpacity,e,u),n.setOrigin(this.options.showOrigin,e,u)},n.prototype.hide=function(t,e){if(this._showing){this._showing=!1,t instanceof Function&&(e=t,t=void 0);var i=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],o=a.after(3,function(){this.nodes.splice(this.nodes.indexOf(i),1),this.transforms.splice(this.transforms.indexOf(n),1),e&&e.call(this)}.bind(this));t||(t=this.options.outTransition),n.setTransform(this.options.outTransform,t,o),n.setOpacity(this.options.outOpacity,t,o),n.setOrigin(this.options.outOrigin,t,o)
}},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t.push(this.nodes[e].render());return t},i.exports=n}),define("famous-views/EdgeSwapper",["require","exports","module","famous/Entity","famous/EventHandler","famous/Matrix","./LightBox"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this._currTarget=void 0,this._size=[window.innerWidth,window.innerHeight],this.lightbox=new a(this.options),this.eventInput=new s,s.setInputHandler(this,this.eventInput),this.id=o.register(this),t&&this.setOptions(t)}var o=t("famous/Entity"),s=t("famous/EventHandler"),r=t("famous/Matrix"),a=t("./LightBox");n.DEFAULT_OPTIONS={inOrigin:[0,0],outOrigin:[0,0],showOrigin:[0,0],inTransform:r.translate(window.innerWidth,0,0),outTransform:r.translate(window.innerWidth,0,0)},n.prototype.show=function(t){this._currTarget&&this.eventInput.unpipe(this._currTarget),this._currTarget=t,this._currTarget&&(this._currTarget.setSize&&this._currTarget.setSize(this._size),this._currTarget.emit&&this.eventInput.pipe(this._currTarget)),this.lightbox.show.apply(this.lightbox,arguments)},n.prototype.setOptions=function(t){this.lightbox.setOptions(t)},n.prototype.render=function(){return this.id},n.prototype.commit=function(t,e,i,n,o){return(o[0]!=this._size[0]||o[1]!=this._size[1])&&(this._size=o,this.lightbox.setOptions({inTransform:r.translate(this._size[0],0,0),outTransform:r.translate(this._size[0],0,0)}),this._currTarget&&this._currTarget.setSize&&this._currTarget.setSize(o)),{transform:e,opacity:i,origin:n,size:o,target:this.lightbox.render()}},i.exports=n}),define("famous/ViewSequence",["require","exports","module"],function(t,e,i){function n(t,e,i){this.array=t||[],this.index=e||0,this.loop=i||!1,this._prev=void 0,this._prevIndex=void 0,this._next=void 0,this._nextIndex=void 0}function o(t){for(var e=this.index,i=this;i&&e<this.array.length;)i.index+=t,void 0!==i._prevIndex&&(i._prevIndex+=t),void 0!==i._nextIndex&&(i._nextIndex+=t),i=i._next}n.prototype._createPrevious=function(){var t=new this.constructor(this.array,this._prevIndex,this.loop);return t._next=this,t._nextIndex=this.index,t},n.prototype._createNext=function(){var t=new this.constructor(this.array,this._nextIndex,this.loop);return t._prev=this,t._prevIndex=this.index,t},n.prototype.getPrevious=function(){var t=this.index-1;if(0==this.index){if(!this.loop)return void 0;t=this.array.length-1}return this._prev&&this._prevIndex==t||(this._prevIndex=t,this._prev=this._createPrevious()),this._prev},n.prototype.getNext=function(){var t=this.index+1;if(t>=this.array.length){if(!this.loop)return void 0;t=0}return this._next&&this._nextIndex==t||(this._nextIndex=t,this._next=this._createNext()),this._next},n.prototype.toString=function(){return this.index},n.prototype.unshift=function(){if(this._prev&&0!==this.index)this._prev.unshift.apply(this._prev,arguments);else{var t=arguments.length;this.array.unshift.apply(this.array,arguments),o.call(this,t)}},n.prototype.push=function(){this.array.push.apply(this.array,arguments)},n.prototype.splice=function(t,e){if(this._prev&&this.index!==t)this._prev.splice.apply(this._prev,arguments);else{var i=this.index>=t?arguments.length-2-e:0;this.array.splice.apply(this.array,arguments),i&&o.call(this,i)}},n.prototype.get=function(){return this.array[this.index]},n.prototype.getSize=function(){var t=this.get();if(t)return t.getSize?t.getSize.apply(t,arguments):void 0},n.prototype.render=function(){var t=this.get();if(t)return t.render.apply(t,arguments)},i.exports=n}),define("famous-views/GridLayout",["require","exports","module","famous/Entity","famous/RenderNode","famous/Matrix","famous/ViewSequence"],function(t,e,i){function n(t){this.options={size:[1,1]},t&&this.setOptions(t),this.id=o.register(this),this._targetPositionsCache=[],this._targetSizesCache=[],this._contextSizeCache=[0,0],this._gridSizeCache=[0,0]}var o=t("famous/Entity"),s=(t("famous/RenderNode"),t("famous/Matrix")),r=t("famous/ViewSequence");n.prototype.render=function(){return this.id},n.prototype.setOptions=function(t){void 0!==t.size&&(this.options.size=t.size)},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new r(t)),this.sequence=t},n.prototype.commit=function(t,e,i,n,o){var r=this.options.size[1],a=this.options.size[0];if(o[0]!=this._contextSizeCache[0]||o[1]!==this._contextSizeCache[1]||r!==this._gridSizeCache[0]||a!==this._gridSizeCache[1])for(var u=o[1]/r,c=o[0]/a,h=0;r>h;h++)for(var l=Math.round(u*h),p=0;a>p;p++){var f=Math.round(c*p),d=h*a+p;this._targetPositionsCache[d]=s.translate(f,l),this._targetSizesCache[d]=[Math.round(c*(p+1))-f,Math.round(u*(h+1))-l]}for(var m=this.sequence,v=[],d=0;m&&d<this._targetPositionsCache.length;){var g=m.get();g&&(v[d]={transform:this._targetPositionsCache[d],size:this._targetSizesCache[d],target:g.render()}),m=m.getNext(),d++}o&&(e=s.move(e,[-o[0]*n[0],-o[1]*n[1],0]));var y={transform:e,opacity:i,origin:n,size:o,target:v};return y},i.exports=n}),define("famous-views/Fader",["require","exports","module","famous/Transitionable"],function(t,e,i){function n(t,e){this.options={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0,visibilityThreshold:0},t&&this.setOptions(t),e||(e=0),this.transitionHelper=new o(e)}var o=t("famous/Transitionable");n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.cull&&(this.options.cull=t.cull),void 0!==t.transition&&(this.options.transition=t.transition),void 0!==t.pulseInTransition&&(this.options.pulseInTransition=t.pulseInTransition),void 0!==t.pulseOutTransition&&(this.options.pulseOutTransition=t.pulseOutTransition),void 0!==t.visibilityThreshold&&(this.options.visibilityThreshold=t.visibilityThreshold)},n.prototype.show=function(t){this.set(1,this.options.transition,t)},n.prototype.hide=function(t){this.set(0,this.options.transition,t)},n.prototype.pulse=function(t,e){void 0===t&&(t=1);var i=this.transitionHelper.get();this.transitionHelper.set(t,this.options.pulseInTransition),this.transitionHelper.set(i,this.options.pulseOutTransition,e)},n.prototype.set=function(t,e,i){this.transitionHelper.halt(),this.transitionHelper.set(t,e,i)},n.prototype.render=function(t){var e=this.transitionHelper.get();return this.options.cull&&!e?void 0:{opacity:e,target:t}},n.prototype.isVisible=function(){var t=this.options.visibilityThreshold;return t>=1?1==this.transitionHelper.get():this.transitionHelper.get()>t},i.exports=n}),define("famous-views/ImageFader",["require","exports","module","famous/RenderNode","./Fader","famous/Matrix"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.nodes=[],this.faders=[],this.mode=-1,t&&this.setOptions(t)}var o=t("famous/RenderNode"),s=t("./Fader"),r=t("famous/Matrix");n.DEFAULT_OPTIONS={crossfade:!1},n.prototype.getMode=function(){return this.mode},n.prototype.setMode=function(t,e,i){if(this.mode=t,this.options.crossfade){for(var n=0;n<this.faders.length;n++)this.faders[n].set(0,e);this.faders[t].set(1,e,i)}else this.faders[t].set(1,e,function(){if(this.mode==t){for(var e=0;e<this.faders.length;e++)e!=t&&this.faders[e].set(0);i&&i()}}.bind(this))},n.prototype.forMode=function(t){return this.nodes[t]||(this.nodes[t]=new o,this.faders[t]=new s(this.options)),this.nodes[t]},n.prototype.setOptions=function(t){void 0!==t.crossfade&&(this.options.crossfade=t.crossfade)},n.behindMatrix=r.translate(0,0,-.01),n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++){var i=this.faders[e].render(this.nodes[e].render());e!=this.mode&&(i={transform:n.behindMatrix,target:i}),t[e]=i}return t},i.exports=n}),define("famous-widgets/ToggleButton",["require","exports","module","famous/Surface","famous/EventHandler","famous-views/ImageFader"],function(t,e,i){function n(t){this.options={content:"",offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:n.TOGGLE,crossfade:!1},this.eventOutput=new s,s.setOutputHandler(this,this.eventOutput),this.offSurface=new o,this.offSurface.on("click",function(){this.options.toggleMode!==n.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this.eventOutput),this.onSurface=new o,this.onSurface.on("click",function(){this.options.toggleMode!==n.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this.eventOutput),this.arbiter=new r({crossfade:this.options.crossfade}),this.arbiter.forMode(n.OFF).link(this.offSurface),this.arbiter.forMode(n.ON).link(this.onSurface),this.arbiter.setMode(n.OFF),this.selected=!1,t&&this.setOptions(t)}var o=t("famous/Surface"),s=t("famous/EventHandler"),r=t("famous-views/ImageFader");n.OFF=0,n.ON=1,n.TOGGLE=2,n.prototype.select=function(){this.selected=!0,this.arbiter.setMode(n.ON,this.options.inTransition),this.eventOutput.emit("select")},n.prototype.deselect=function(){this.selected=!1,this.arbiter.setMode(n.OFF,this.options.outTransition),this.eventOutput.emit("deselect")},n.prototype.isSelected=function(){return this.selected},n.prototype.setOptions=function(t){void 0!==t.content&&(this.options.content=t.content,this.offSurface.setContent(this.options.content),this.onSurface.setContent(this.options.content)),t.offClasses&&(this.options.offClasses=t.offClasses,this.offSurface.setClasses(this.options.offClasses)),t.onClasses&&(this.options.onClasses=t.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==t.size&&(this.options.size=t.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==t.toggleMode&&(this.options.toggleMode=t.toggleMode),void 0!==t.outTransition&&(this.options.outTransition=t.outTransition),void 0!==t.inTransition&&(this.options.inTransition=t.inTransition),void 0!==t.crossfade&&(this.options.crossfade=t.crossfade,this.arbiter.setOptions({crossfade:this.options.crossfade}))},n.prototype.getSize=function(){return this.options.size},n.prototype.render=function(){return this.arbiter.render()},i.exports=n}),define("famous-widgets/NavigationBar",["require","exports","module","famous/EventHandler","famous/Utility","famous/View","famous-views/GridLayout","./ToggleButton"],function(t,e,i){function n(){a.apply(this,arguments),this.layout=new u,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._link(this.layout),this.optionsManager.on("change",o.bind(this))}function o(t){var e=t.id,i=t.value;if("direction"===e)this.layout.setOptions({size:s.call(this.buttons.length,this.options.direction)});else if("buttons"===e)for(var n in this.buttons)this.buttons[n].setOptions(i);else if("sections"===e)for(var e in this.options.sections)this.defineSection(e,this.options.sections[e])}function s(t,e){return e===r.Direction.X?[t,1]:[1,t]}var r=(t("famous/EventHandler"),t("famous/Utility")),a=t("famous/View"),u=t("famous-views/GridLayout"),c=t("./ToggleButton");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={sections:[],widget:c,size:[void 0,50],direction:r.Direction.X,buttons:{toggleMode:c.ON}},n.prototype.defineSection=function(t,e){var i,n=this._buttonIds[t];if(void 0===n){n=this.buttons.length,this._buttonIds[t]=n;var o=this.options.widget;i=new o,this.buttons[n]=i,this.layout.setOptions({size:s(this.buttons.length,this.options.direction)})}else i=this.buttons[n],i.unbind("select",this._buttonCallbacks[t]);this.options.buttons&&i.setOptions(this.options.buttons),i.setOptions(e),this._buttonCallbacks[t]=this.select.bind(this,t),i.on("select",this._buttonCallbacks[t])},n.prototype.select=function(t){var e=this._buttonIds[t];this.buttons[e]&&this.buttons[e].isSelected()?this.eventOutput.emit("select",{id:t}):this.buttons[e]&&this.buttons[e].select();for(var i=0;i<this.buttons.length;i++)i!=e&&this.buttons[i].deselect()},i.exports=n}),define("famous-widgets/TitleBar",["require","exports","module","famous/Matrix","famous/Surface","famous-views/LightBox"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.lightbox=new r,this._surfaces={},t&&this.setOptions(t)}var o=t("famous/Matrix"),s=t("famous/Surface"),r=t("famous-views/LightBox");n.DEFAULT_OPTIONS={widget:s,inOrigin:[.5,0],outOrigin:[.5,0],showOrigin:[.5,0],inTransition:!0,outTransition:!0,size:[void 0,50],look:void 0},n.prototype.show=function(t){var e=this.options.widget;if(!(t in this._surfaces)){var i=new e({size:this.options.size});i.setOptions(this.options.look),i.setContent(t),this._surfaces[t]=i}this.lightbox.show(this._surfaces[t])},n.prototype.getSize=function(){return this.options.size},n.prototype.setOptions=function(t){if(this.lightbox.setOptions(t),t.widget&&(this.options.widget=t.widget,this._surfaces={}),t.look&&(this.options.look=t.look),t.size){this.options.size=t.size;var e=o.translate(0,-this.options.size[1]);this.lightbox.setOptions({inTransform:e,outTransform:e})}},n.prototype.render=function(){return this.lightbox.render()},i.exports=n}),define("app/App",["require","exports","module","famous/View","famous/EventHandler","famous/OptionsManager","famous/RenderNode","famous/Utility","famous/Matrix","famous-views/HeaderFooterLayout","famous-views/EdgeSwapper","famous-widgets/NavigationBar","famous-widgets/TitleBar"],function(t,e,i){function n(){o.apply(this,arguments),this.layout=new c,this.header=new p(this.options.header),this.navigation=new l(this.options.navigation),this.contentArea=new h(this.options.content),this.layout.id.header.link(this.header),this.layout.id.footer.link(a.transformInFront).link(this.navigation),this.layout.id.content.link(a.transformBehind).link(this.contentArea),this.eventInput.pipe(this.contentArea),s.setOutputHandler(this,this.navigation),this.eventInput=new s,s.setInputHandler(this,this.eventInput),this.eventOutput=new s,s.setOutputHandler(this,this.eventOutput),this._currentSection=void 0,this._sections={},this._sectionTitles={},this.options.sections&&this.initSections(this.options.sections),this.navigation.on("select",function(t){$("body").removeClass("editing"),this._currentSection=t.id,this.header.show(this._sectionTitles[t.id]),this.contentArea.show(this._sections[t.id].get())}.bind(this)),this._link(this.layout)}var o=t("famous/View"),s=t("famous/EventHandler"),r=(t("famous/OptionsManager"),t("famous/RenderNode")),a=t("famous/Utility"),u=t("famous/Matrix"),c=t("famous-views/HeaderFooterLayout"),h=t("famous-views/EdgeSwapper"),l=t("famous-widgets/NavigationBar"),p=t("famous-widgets/TitleBar");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={header:{size:[void 0,50],inTransition:!0,outTransition:!0,look:{size:[void 0,50],classes:["header"]}},navigation:{size:[void 0,50],direction:a.Direction.X,buttons:{onClasses:["navigation","on"],offClasses:["navigation","off"],inTransition:!0,outTransition:!0}},content:{inTransition:!0,outTransition:!0,overlap:!0},inTransform:u.identity,outTransform:u.identity,inOpacity:0,outOpacity:0,inTransition:{duration:500},outTransition:{duration:200}},n.prototype.getState=function(){return this._currentSection},n.prototype.section=function(t){return t in this._sections||(this._sections[t]=new r,this._sections[t].setOptions=function(e){this._sectionTitles[t]=e.title,this.navigation.defineSection(t,{content:'<span class="icon">'+e.navigation.icon+"</span><br />"+e.navigation.caption})}.bind(this)),this._sections[t]},n.prototype.select=function(t){return this._currentSection=t,t in this._sections?(this.navigation.select(t),!0):!1},n.prototype.initSections=function(t){_.each(t,function(t){var e=t.title;this.section(e).setOptions({title:t.title,navigation:t.navigation}),this.section(e).link(t),t.pipe&&t.pipe(this.eventInput)}.bind(this))},n.prototype.onHeaderClick=function(t){this.header._surfaces[t.id].eventHandled=!0,this.header._surfaces[t.id].on("click",function(t){switch(t.target.id){case"clear-button":this.eventOutput.emit("clearRecent");break;case"add-contact":this.eventOutput.emit("editContact");break;case"edit-contact":$("body").toggleClass("editing");break;case"recent-toggle":this.eventOutput.emit("loadRecent",t)}}.bind(this)),this.header._surfaces[t.id].pipe(this.eventOutput)},i.exports=n}),define("famous/ElementAllocator",["require","exports","module"],function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.removeChild(e.firstChild));this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),define("famous/Context",["require","exports","module","./RenderNode","./EventHandler","./SpecParser","./ElementAllocator","./Matrix","./Transitionable"],function(t,e,i){function n(t){this.container=t,this.allocator=new a(t),this.srcNode=new s,this.eventHandler=new r,this._size=[window.innerWidth,window.innerHeight],this.perspectiveState=new c(0),this._perspective=void 0,this.eventHandler.on("resize",function(){this._size=o(this.container)}.bind(this))}function o(t){return[t.clientWidth,t.clientHeight]}var s=t("./RenderNode"),r=t("./EventHandler"),a=(t("./SpecParser"),t("./ElementAllocator")),u=t("./Matrix"),c=t("./Transitionable");n.prototype.getAllocator=function(){return this.allocator},n.prototype.link=function(t){return this.srcNode.link(t)},n.prototype.add=function(t){return this.srcNode.add(t)},n.prototype.mod=function(t){return this.srcNode.mod(t)},n.prototype.migrate=function(t){t!==this.container&&(this.container=t,this.allocator.migrate(t))},n.prototype.getSize=function(){return this._size},n.prototype.setSize=function(t){t||(t=o(this.container)),this._size=t},n.prototype.update=function(){var t=this.perspectiveState.get();t!==this._perspective&&(this.container.style.perspective=t?t.toFixed()+"px":"",this.container.style.webkitPerspective=t?t.toFixed():"",this._perspective=t),this.srcNode&&this.srcNode.commit(this,u.identity,1,[0,0],this._size)},n.prototype.getOutputTransform=function(t){var e=this.parsedCache;if(e){var i=t.id,n={transform:e.transforms[i],opacity:e.opacities[i]};if(e.origins[i]&&(n.origin=e.origins[i]),e.groups[i]){var o=e.groups[i];n.transform=u.multiply(n.transform,e.groupTransforms[o]),e.groupOpacities[o]&&(n.opacity*=e.groupOpacities[o])}return n}},n.prototype.getPerspective=function(){return this.perspectiveState.get()},n.prototype.setPerspective=function(t,e,i){return this.perspectiveState.set(t,e,i)},n.prototype.emit=function(t,e){return this.eventHandler.emit(t,e)},n.prototype.on=function(t,e){return this.eventHandler.on(t,e)},n.prototype.unbind=function(t,e){return this.eventHandler.unbind(t,e)},n.prototype.pipe=function(t){return this.eventHandler.pipe(t)},n.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},i.exports=n}),define("famous-utils/Time",["require","exports","module","famous/Engine"],function(t,e,i){function n(t,e){var i=Date.now(),n=function(){var n=Date.now();n-i>=e&&(t(),i=Date.now())};return u.on("prerender",n),n}function o(t){u.unbind("prerender",t)}function s(t,e,i){var n=Date.now(),o=function(){var s=Date.now(),r=(s-n)/t;return s-n>=t?(e(1),u.unbind("prerender",o),i&&i(),void 0):(e(r),void 0)};u.on("prerender",o)}function r(t,e){var i=Date.now(),n=function(){var o=Date.now();return o-i>=e?(u.unbind("prerender",n),t(),void 0):void 0};return u.on("prerender",n),n}function a(t){u.unbind("prerender",t)}var u=t("famous/Engine");i.exports={setInterval:n,removeInterval:o,executeOver:s,setTimeout:r,removeTimeout:a}}),define("famous-utils/Utils",["require","exports","module","./Time","famous/Matrix"],function(t,e,i){var n=t("./Time"),o=t("famous/Matrix"),s={rad2deg:function(t){return 57.2957795*t},deg2rad:function(t){return.0174532925*t},distance:function(t,e,i,n){var o=i-t,s=n-e;return Math.sqrt(o*o+s*s)},distance3D:function(t,e,i,n,o,s){var r=n-t,a=o-e,u=s-i;return Math.sqrt(r*r+a*a+u*u)},map:function(t,e,i,n,o,s){var r=(t-e)/(i-e)*(o-n)+n;return s&&(o>n?r>o?r=o:n>r&&(r=n):o>r?r=o:r>n&&(r=n)),r},limit:function(t,e,i){return t=Math.min(t,i),t=Math.max(t,e)},perspective:function(t,e,i,n){var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=1/Math.tan(t/2),r=1/(i-n);return o[0]=s/e,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(n+i)*r,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*n*i*r,o[15]=0,o},ortho:function(t,e,i,n,o,s){var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a=-(e+t)/(e-t),u=-(n+i)/(n-i),c=-(s+o)/(s-o);return r[0]=2/(e-t),r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2/(n-i),r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=-2/(s-o),r[11]=-1,r[12]=a,r[13]=u,r[14]=c,r[15]=1,r},normalFromFM:function(t,e){var i=e[0],n=e[1],o=e[2],s=e[3],r=e[4],a=e[5],u=e[6],c=e[7],h=e[8],l=e[9],p=e[10],f=e[11],d=e[12],m=e[13],v=e[14],g=e[15],y=i*a-n*r,b=i*u-o*r,w=i*c-s*r,S=n*u-o*a,_=n*c-s*a,x=o*c-s*u,C=h*m-l*d,O=h*v-p*d,T=h*g-f*d,k=l*v-p*m,E=l*g-f*m,I=p*g-f*v,M=y*I-b*E+w*k+S*T-_*O+x*C;return M?(M=1/M,t[0]=(a*I-u*E+c*k)*M,t[1]=(u*T-r*I-c*O)*M,t[2]=(r*E-a*T+c*C)*M,t[3]=(o*E-n*I-s*k)*M,t[4]=(i*I-o*T+s*O)*M,t[5]=(n*T-i*E-s*C)*M,t[6]=(m*x-v*_+g*S)*M,t[7]=(v*w-d*x-g*b)*M,t[8]=(d*_-m*w+g*y)*M,t):null},clamp:function(t,e,i){return e>t?e:t>i?i:t},color:function(t,e,i,n){return"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"},backgroundTransparent:function(){return{backgroundColor:"transparent"}},backgroundColor:function(t,e,i,n){return{backgroundColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderRadius:function(t){return{borderRadius:t+"px"}},borderTopWidth:function(t){return{borderTopWidth:t+"px"}},borderBottomWidth:function(t){return{borderBottomWidth:t+"px"}},borderLeftWidth:function(t){return{borderLeftWidth:t+"px"}},borderRightWidth:function(t){return{borderRightWidth:t+"px"}},borderWidth:function(t){return{borderWidth:t+"px"}},borderColor:function(t,e,i,n){return 0==n?{borderColor:"transparent"}:{borderColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderTopColor:function(t,e,i,n){return 0==n?{borderTopColor:"transparent"}:{borderTopColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderBottomColor:function(t,e,i,n){return 0==n?{borderBottomColor:"transparent"}:{borderBottomColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderRightColor:function(t,e,i,n){return 0==n?{borderRightColor:"transparent"}:{borderRightColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderLeftColor:function(t,e,i,n){return 0==n?{borderLeftColor:"transparent"}:{borderLeftColor:"rgba("+Math.floor(t)+","+Math.floor(e)+","+Math.floor(i)+","+n+")"}},borderStyle:function(t){return{borderStyle:t}},borderTopStyle:function(t){return{borderTopStyle:t}},borderBottomStyle:function(t){return{borderBottomStyle:t}},borderRightStyle:function(t){return{borderRightStyle:t}},borderLeftStyle:function(t){return{borderLeftStyle:t}},colorHSL:function(t,e,i,n){return"hsla("+Math.floor(t)+","+Math.floor(e)+"%,"+Math.floor(i)+"%,"+n+")"},backgroundTransparent:function(){return{backgroundColor:"transparent"}},backgroundColorHSL:function(t,e,i,n){return{backgroundColor:"hsla("+Math.floor(t)+","+Math.floor(e)+"%,"+Math.floor(i)+"%,"+n+")"}},backfaceVisible:function(t){return t===!0?{"backface-visibility":"visible","-webkit-backface-visibility":"visible",MozBackfaceVisibility:"visible","-ms-backface-visibility":"visible"}:{"backface-visibility":"hidden","-webkit-backface-visibility":"hidden",MozBackfaceVisibility:"hidden","-ms-backface-visibility":"hidden"}},clipCircle:function(t,e,i){return{"-webkit-clip-path":"circle("+t+"px,"+e+"px,"+i+"px)"}},getWidth:function(){return window.innerWidth},getHeight:function(){return window.innerHeight},getCenter:function(){return[.5*s.getWidth(),.5*s.getHeight()]},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?!0:!1},isString:function(t){return"string"==typeof t||t instanceof String},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},extend:function(t,e){for(var i in e)t[i]=e[i];return t},getDevicePixelRatio:function(){return window.devicePixelRatio?window.devicePixelRatio:1},supportsWebGL:function(){return/Android|Chrome|Mozilla/i.test(navigator.appCodeName)&&window.WebGLRenderingContext?!0:!1},getSurfacePosition:function(t){function e(t){var n=o(t);if(""!==n&&void 0!==n){var s=i(n);r[0]+=s[0],r[1]+=s[1],r[2]+=s[2]}t.parentElement!==document.body&&e(t.parentNode)}function i(t){var e=[];t=n(t),e[0]=parseInt(t[12].replace(" ","")),e[1]=parseInt(t[13].replace(" ","")),e[2]=parseInt(t[14].replace(" ",""));for(var i=0;i<e.length;i++)"undefined"==typeof e[i]&&(e[i]=0);return e}function n(t){return t=t.replace("matrix3d(",""),t=t.replace(")",""),t.split(",")}function o(t){var e=t.style.webkitTransform||t.style.transform;return e}var s=t._currTarget,r=[0,0,0];return s?(e(s),r):void 0},getCenterMatrix:function(t,e,i){return void 0==i&&(i=0),o.translate(t[0]-.5*e[0],t[1]-.5*e[1],i)},debounce:function(t,e){var i,o,s,r,a;return function(){o=this,a=arguments,s=new Date;var u=function(){var c=new Date-s;e>c?i=n.setTimeout(u,e-c):(i=null,r=t.apply(o,a))};return i||(i=n.setTimeout(u,e)),r}},hasUserMedia:function(){return!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)},getUserMedia:function(){return navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia},isWebkit:function(){return!!window.webkitURL}};i.exports=s}),define("famous/Engine",["require","exports","module","./Context","./EventHandler","famous-utils/Utils"],function(t,e,i){function n(){var t=Date.now();if(k&&k>t-O)return requestAnimationFrame(n),void 0;T=t-O,O=t,E.emit("prerender");for(var e=0;e<x.length;e++)x[e].call(this);for(x=[];C.length&&Date.now()-t<I;)C.shift().call(this);for(var e=0;e<_.length;e++)_[e].update();E.emit("postrender"),requestAnimationFrame(n)}function o(){return S.isMobile()&&document.activeElement&&"INPUT"==document.activeElement.nodeName?("message"==document.activeElement.name&&s(),void 0):(s(),void 0)}function s(){window.scrollTo(0,0);for(var t=0;t<_.length;t++)_[t].emit("resize");E.emit("resize")}function r(t){"INPUT"==t.target.tagName?($(t.target).focus(),this._input=t.target):"send-text-button"!=t.target.className&&this._input&&($(this._input).blur(),this._input=null)}function a(t){return E.pipe(t)}function u(t){return E.unpipe(t)}function c(t,e){E.on(t,e)}function h(t,e){E.emit(t,e)}function l(t,e){E.unbind(t,e)}function p(){return 1e3/T}function f(t){k=Math.floor(1e3/t)}function d(t){void 0===t?(t=document.createElement("div"),t.classList.add("container"),document.body.appendChild(t)):t instanceof Element||(t=document.createElement("div"),console.warn("Tried to create context on non-existent element"));var e=new b(t);return _.push(e),e}function m(t){x.push(t)}function v(t){return M[t]}function g(t){var e=M.length;return M[e]=t,e}function y(t){C.push(t)}var b=t("./Context"),w=t("./EventHandler"),S=t("famous-utils/Utils"),_=[],x=[],C=[],O=Date.now(),T=void 0,k=void 0,E=new w,I=10,M=[];requestAnimationFrame(n),window.addEventListener("resize",o,!1),o(),c("click",r.bind(this)),window.addEventListener("touchmove",function(t){t.preventDefault()},!1);for(var z=["touchstart","touchmove","touchend","touchcancel","click","keydown","keyup","keypress","mouseup","mousedown","mousemove","mouseover","mouseout","mousewheel","wheel","resize"],A=0;A<z.length;A++){var F=z[A];document.body.addEventListener(F,function(t){E.emit(t.type,t,!1)},!1)}i.exports={on:c,defer:y,emit:h,unbind:l,pipe:a,unpipe:u,createContext:d,getFPS:p,setFPSCap:f,nextTick:m,getEntity:v,registerEntity:g}}),define("views/CameraView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","famous/Modifier","famous/Matrix"],function(t,e,i){function n(t){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.localVideoSurface=new s({content:'<div class="camera local-video blur off"><video muted="true" autoplay poster="content/images/transparent.png"></video></div>'}),this.remoteVideoSurface=new s({properties:{zIndex:-3},content:'<div class="camera remote-video"><video autoplay poster="content/images/transparent.png"></video></div>'}),this.localVideoSurface.pipe(this.eventOutput),this.remoteVideoSurface.pipe(this.eventOutput),this.transform=new a({origin:[.9,.1]}),this._add(new a({transform:u.translate(0,0,-5)})).link(this.remoteVideoSurface),this._add(this.transform).link(this.localVideoSurface),this.turnOff()}var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=t("famous/Modifier"),u=t("famous/Matrix");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.turnOn=function(){$(".remote-video").show(),this.transform.setTransform(u.move(u.scale(.25,.25),[0,0,-5]),{duration:500})},n.prototype.turnOff=function(){$(".remote-video").hide(),this.transform.setTransform(u.move(u.scale(1,1),[0,0,-5]),{duration:500})},i.exports=n}),define("famous-physics/math/Vector",["require","exports","module"],function(t,e,i){function n(t,e,i){return 1===arguments.length?this.set(t):(this.x=t||0,this.y=e||0,this.z=i||0),this}var o=new n(0,0,0);n.prototype.add=function(t,e){return e=e||o,e.setXYZ(this.x+(t.x||0),this.y+(t.y||0),this.z+(t.z||0))},n.prototype.sub=function(t,e){return e=e||o,e.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t,e){return e=e||o,e.setXYZ(t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t,e){return this.mult(1/t,e)},n.prototype.cross=function(t,e){return e=e||o,e.setXYZ(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},n.prototype.equals=function(t){return t.x==this.x&&t.y==this.y&&t.z==this.z},n.prototype.rotateX=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(i,-s*a+n*r,s*r-n*a)},n.prototype.rotateY=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(-s*a+i*r,n,s*r+i*a)},n.prototype.rotateZ=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(-n*a+i*r,n*r+i*a,s)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t,e){t=void 0!==t?t:1,e=e||o;var i=1e-7,n=this.norm();return Math.abs(n)>i?this.mult(t/n,e):e.setXYZ(t,0,0)},n.prototype.clone=function(){return new n(this)},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.set=function(t){return t instanceof Array?this.setFromArray(t):(this.x=t.x,this.y=t.y,this.z=t.z||0),this!==o&&o.clear(),this},n.prototype.setFromArray=function(t){this.x=t[0],this.y=t[1],this.z=t[2]||0},n.prototype.put=function(t){t.set(o)},n.prototype.setXYZ=function(t,e,i){return o.clear(),this.x=t,this.y=e,this.z=i,this},n.prototype.clear=function(){this.x=0,this.y=0,this.z=0},n.prototype.cap=function(t,e){if(1/0===t)return this;e=e||o;var i=this.norm();return i>t?this.normalize(t,e):this},n.prototype.project=function(t,e){return e=e||o,t.mult(this.dot(t),e)},n.prototype.reflectAcross=function(t,e){return e=e||o,t.normalize(),this.sub(this.project(t).mult(2),e)},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.get=function(){return this.toArray()},i.exports=n}),define("famous-physics/bodies/Particle",["require","exports","module","famous/RenderNode","famous-physics/math/Vector","famous/Matrix"],function(t,e,i){function n(t){t=t||{},this.p=t.p?new s(t.p):new s(0,0,0),this.v=t.v?new s(t.v):new s(0,0,0),this.f=t.f?new s(t.f):new s(0,0,0),this.m=void 0!==t.m?t.m:1,this.restitution=void 0!==t.restitution?t.restitution:.5,this.dissipation=void 0!==t.dissipation?t.dissipation:0,this.axis=void 0!==t.axis?t.axis:void 0,this.setImmunity(t.immunity||n.IMMUNITIES.NONE),this.mInv=1/this.m,this.size=[0,0,0],this.node=void 0,this.spec={size:[0,0],target:{origin:[.5,.5],transform:void 0,target:void 0}}
}var o=t("famous/RenderNode"),s=t("famous-physics/math/Vector"),r=t("famous/Matrix");n.AXIS={X:1,Y:2,Z:4},n.IMMUNITIES={NONE:0,POSITION:1,VELOCITY:2,ROTATION:4,AGENTS:8,UPDATE:16};for(var a in n.IMMUNITIES)n.IMMUNITIES.ALL|=n.IMMUNITIES[a];n.prototype.setPos=function(t){this.p.set(t)},n.prototype.getPos=function(){return this.p.get()},n.prototype.setVel=function(t){this.hasImmunity(n.IMMUNITIES.VELOCITY)||this.v.set(t)},n.prototype.getVel=function(){return this.v.get()},n.prototype.setMass=function(t){this.m=t,this.mInv=1/t},n.prototype.getMass=function(){return this.m},n.prototype.addImmunity=function(t){"string"==typeof t&&(t=n.IMMUNITIES[t.toUpperCase()]),this.immunity|=t},n.prototype.removeImmunity=function(t){"string"==typeof t&&(t=n.IMMUNITIES[t.toUpperCase()]),this.immunity&=~t},n.prototype.setImmunity=function(t){"string"==typeof t&&(t=n.IMMUNITIES[t.toUpperCase()]),this.immunity=t},n.prototype.hasImmunity=function(t){return"string"==typeof t&&(t=n.IMMUNITIES[t.toUpperCase()]),this.getImmunity()&t},n.prototype.getImmunity=function(){return this.immunity},n.prototype.reset=function(t,e){t=t||[0,0,0],e=e||[0,0,0],this.setPos(t),this.setVel(e)},n.prototype.applyForce=function(t){this.hasImmunity(n.IMMUNITIES.AGENTS)||this.f.set(this.f.add(t))},n.prototype.applyImpulse=function(t){this.hasImmunity(n.IMMUNITIES.AGENTS)||this.setVel(this.v.add(t.mult(this.mInv)))},n.prototype.getEnergy=function(){return.5*this.m*this.v.normSquared()},n.prototype.getTransform=function(){var t=this.p,e=this.axis;return void 0!==e&&(e&~n.AXIS.X&&(t.x=0),e&~n.AXIS.Y&&(t.y=0),e&~n.AXIS.Z&&(t.z=0)),r.translate(t.x,t.y,t.z)},n.prototype.link=function(t){return this.node||(this.node=new o),this.node.link(t)},n.prototype.add=function(t){return this.node||(this.node=new o),this.node.add(t)},n.prototype.replace=function(t){this.node.object=t},n.prototype.render=function(t){return t=void 0!==t?t:this.node.render(),this.spec.target.transform=this.getTransform(),this.spec.target.target=t,this.spec},i.exports=n}),define("famous-physics/math/Quaternion",["require","exports","module"],function(t,e,i){function n(t,e,i,n){return 1==arguments.length?this.set(t):(this.w=void 0!==t?t:1,this.x=e||0,this.y=i||0,this.z=n||0),this}var o=new n(1,0,0,0);n.prototype.add=function(t,e){return e=e||o,e.setWXYZ(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t,e){return e=e||o,e.setWXYZ(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.scalarDivide=function(t,e){return e=e||o,this.scalarMult(1/t,e)},n.prototype.scalarMult=function(t,e){return e=e||o,e.setWXYZ(this.w*t,this.x*t,this.y*t,this.z*t)},n.prototype.multiply=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=this.w,a=t.x,u=t.y,c=t.z,h=t.w;return e.setWXYZ(r*h-i*a-n*u-s*c,r*a+i*h+n*c-s*u,r*u-i*c+n*h+s*a,r*c+i*u-n*a+s*h)},n.prototype.vectorMultiply=function(t,e){return e=e||o,t.w=0,e.set(this.inverse().multiply(t).multiply(this))},n.prototype.inverse=function(t){return t=t||o,this.conj().scalarDivide(this.normSquared(),t)},n.prototype.negate=function(t){return t=t||o,this.scalarMult(-1,t)},n.prototype.conj=function(t){return t=t||o,t.setWXYZ(this.w,-this.x,-this.y,-this.z)},n.prototype.normalize=function(t){t=t||o;var e=this.norm();return Math.abs(e)<1e-7?t.setWXYZ(1,0,0,0):this.scalarDivide(e,t)},n.prototype.makeFromAngleAndAxis=function(t,e){e.normalize(1,e);var i=.5*t,n=Math.sin(i);return this.x=n*e.x,this.y=n*e.y,this.z=n*e.z,this.w=Math.cos(i),this},n.prototype.getAngle=function(){return 2*Math.acos(this.w)},n.prototype.getAxis=function(){var t=this.w;if(t>=1)return[0,0,0];var e=1/Math.sqrt(1-t*t);return[e*this.x,e*this.y,this.z]},n.prototype.setWXYZ=function(t,e,i,n){return o.clear(),this.w=t,this.x=e,this.y=i,this.z=n,this},n.prototype.set=function(t){return t instanceof Array?(this.w=t[0],this.x=t[1],this.y=t[2],this.z=t[3]):(this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z),this!==o&&o.clear(),this},n.prototype.put=function(t){t.set(o)},n.prototype.clone=function(){return new n(this)},n.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},n.prototype.isEqual=function(t){return t.w==this.w&&t.x==this.x&&t.y==this.y&&t.z==this.z},n.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.isZero=function(){return!(this.x||this.y||this.z||1!=this.w)},n.prototype.zeroRotation=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},n.prototype.getMatrix=function(){var t=1/this.norm(),e=this.x*t,i=this.y*t,n=this.z*t,o=this.w*t;return[1-2*i*i-2*n*n,-2*e*i-2*n*o,2*e*n-2*i*o,0,-2*e*i+2*n*o,1-2*e*e-2*n*n,-2*i*n-2*e*o,0,2*e*n+2*i*o,-2*i*n+2*e*o,1-2*e*e-2*i*i,0,0,0,0,1]};var s=1e-5;n.prototype.slerp=function(t,e,i){i=i||o;var n,r,a,u,c;return r=this.dot(t),0>r&&(r*=-1),1-r>s?(n=Math.acos(r),a=Math.sin(n),u=Math.sin((1-e)*n)/a,c=Math.sin(e*n)/a):(u=1-e,c=e),this.scalarMult(u/c).add(t).mult(c,i)},i.exports=n}),define("famous-physics/bodies/Body",["require","exports","module","./Particle","famous-physics/math/Vector","famous-physics/math/Quaternion","famous/Matrix"],function(t,e,i){function n(t){o.call(this,t),this.q=t.q?new r(t.q):new r,this.w=t.w?new s(t.w):new s,this.L=t.L?new s(t.L):new s,this.t=t.t?new s(t.t):new s,this.I=[1,0,0,1,0,0,1,0,0],this.Iinv=[1,0,0,1,0,0,1,0,0],this.w.w=0,this.pWorld=new s}var o=t("./Particle"),s=t("famous-physics/math/Vector"),r=t("famous-physics/math/Quaternion"),a=t("famous/Matrix");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.IMMUNITIES=o.IMMUNITIES,n.prototype.updateAngularVelocity=function(){var t=this.Iinv,e=this.L,i=e.x,n=e.y,o=e.z,s=t[0],r=t[1],a=t[2];this.w.setXYZ(s[0]*i+s[1]*n+s[2]*o,r[0]*i+r[1]*n+r[2]*o,a[0]*i+a[1]*n+a[2]*o)},n.prototype.toWorldCoordinates=function(t){var e=this.q;return t.w=0,this.pWorld.set(e.inverse().multiply(t).multiply(e))},n.prototype.getEnergy=function(){var t=this.w,e=this.I,i=t.x,n=t.y,o=t.z,s=this.I[0],r=e[1],a=e[2];return.5*(this.m*this.v.normSquared()+s[0]*i*i+s[1]*i*n+s[2]*i*o+r[0]*n*i+r[1]*n*n+r[2]*n*o+a[0]*o*i+a[1]*o*n+a[2]*o*o)},n.prototype.reset=function(t,e,i,n){this.setPos(t||[0,0,0]),this.setVel(e||[0,0,0]),this.w.clear(),this.setOrientation(i||[1,0,0,0]),this.setAngularMomentum(n||[0,0,0])},n.prototype.setOrientation=function(t){this.q.set(t)},n.prototype.setAngularMomentum=function(t){this.L.set(t)},n.prototype.applyForce=function(t,e){this.hasImmunity(n.IMMUNITIES.AGENTS)||(this.f.set(this.f.add(t)),void 0!==e&&this.applyTorque(e.cross(t)))},n.prototype.applyTorque=function(t){this.hasImmunity(n.IMMUNITIES.ROTATION)||this.t.set(this.t.add(t))},n.prototype.getTransform=function(){return a.move(this.q.getMatrix(),this.p.get())},i.exports=n}),define("famous-physics/bodies/Circle",["require","exports","module","./Body"],function(t,e,i){function n(t){o.call(this,t),t=t||{},this.r=t.r||0,this.size=[2*this.r,2*this.r];var e=this.r,i=this.m;this.I=[[.25*i*e*e,0,0],[0,.25*i*e*e,0],[0,0,.5*i*e*e]],this.Iinv=[[4/(i*e*e),0,0],[0,4/(i*e*e),0],[0,0,2/(i*e*e)]]}var o=t("./Body");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.IMMUNITIES=o.IMMUNITIES,i.exports=n}),define("famous-physics/bodies/Rectangle",["require","exports","module","./Body"],function(t,e,i){function n(t){o.call(this,t),t=t||{},this.size=t.size||[0,0];var e=this.size[0],i=this.size[1];this.I=[[i*i/12,0,0],[0,e*e/12,0],[0,0,(e*e+i*i)/12]],this.Iinv=[[12/(i*i),0,0],[0,12/(e*e),0],[0,0,12/(e*e+i*i)]]}var o=t("./Body");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.IMMUNITIES=o.IMMUNITIES,i.exports=n}),define("famous-physics/forces/Force",["require","exports","module","famous-physics/math/Vector"],function(t,e,i){function n(){this.force=new o}var o=t("famous-physics/math/Vector");n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(){},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init&&t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},n.prototype.getEnergy=function(){return 0},i.exports=n}),define("famous-physics/constraints/Constraint",["require","exports","module"],function(t,e,i){function n(){}n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(){},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init&&t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},i.exports=n}),define("famous-physics/integrator/SymplecticEuler",["require","exports","module"],function(t,e,i){function n(t){this.opts={velocityCap:1/0,angularVelocityCap:1/0},t&&this.setOpts(t)}n.prototype.integrateVelocity=function(t,e){var i=t.v,n=t.m,o=t.f;o.isZero()||(t.setVel(i.add(o.mult(e/n))),o.clear())},n.prototype.integratePosition=function(t,e){var i=t.p,n=t.v;n.isZero()||(n.set(n.cap(this.opts.velocityCap)),t.setPos(i.add(n.mult(e))))},n.prototype.integrateAngularMomentum=function(t,e){var i=t.L,n=t.t;n.isZero()||(n.set(n.cap(this.opts.angularVelocityCap)),i.add(n.mult(e)).put(i),n.clear())},n.prototype.integrateOrientation=function(t,e){var i=t.q,n=t.w;n.isZero()||(i.set(i.add(i.multiply(n).scalarMult(.5*e))),i.set(i.normalize()))},n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},i.exports=n}),define("famous-physics/PhysicsEngine",["require","exports","module","famous-physics/bodies/Particle","famous-physics/bodies/Body","famous-physics/bodies/Circle","famous-physics/bodies/Rectangle","famous-physics/forces/Force","famous-physics/constraints/Constraint","famous-physics/integrator/SymplecticEuler"],function(t,e,i){function n(t){this.opts={speed:1,steps:1,velocityCap:1/0,angularVelocityCap:1/0,constraintSteps:1,constraintTolerance:1e-4},t&&this.setOpts(t),this._particles=[],this._agents={},this._forces=[],this._constraints=[],this._playing=!0,this._buffer=0,this._timestep=1e3/60/this.opts.steps,this._prevTime=void 0,this._currTime=void 0,this._integrator=new I({velocityCap:this.opts.velocityCap,angularVelocityCap:this.opts.angularVelocityCap}),this._currAgentId=0,this.BODIES=n.BODIES}function o(){return Date.now()}function s(t,e,i){return void 0===e&&(e=this.getParticles()),e instanceof Array||(e=[e]),this._agents[this._currAgentId]={agent:t,targets:e,source:i},r.call(this,t).push(this._currAgentId),this._currAgentId++}function r(t){return t instanceof k?this._forces:t instanceof E?this._constraints:void 0}function a(t){return this._agents[t]}function u(t){var e=a.call(this,this._forces[t]);e.agent.applyForce(e.targets,e.source)}function c(t,e){var i=this._agents[this._constraints[t]];return i.agent.applyConstraint(i.targets,i.source,e)}function h(){for(var t=this._forces.length-1;t>-1;t--)u.call(this,t)}function l(t){var e=1/0,i=0;for(this.opts.constraintTolerance;i<this.opts.constraintSteps;){e=0;for(var n=this._constraints.length-1;n>-1;n--)e+=c.call(this,n,t);i++}}function p(t,e){t.hasImmunity(x.IMMUNITIES.UPDATE)||this._integrator.integrateVelocity(t,e)}function f(t){t.hasImmunity(x.IMMUNITIES.ROTATION)||t instanceof C&&t.updateAngularVelocity()}function d(t,e){t.hasImmunity(x.IMMUNITIES.ROTATION)||t instanceof C&&this._integrator.integrateAngularMomentum(t,e)}function m(t,e){t.hasImmunity(x.IMMUNITIES.UPDATE)||this._integrator.integratePosition(t,e)}function v(t,e){t.hasImmunity(x.IMMUNITIES.ROTATION)||t instanceof C&&this._integrator.integrateOrientation(t,e)}function g(t){this.forEachParticle(p,t)}function y(t){this.forEachParticle(m,t)}function b(){this.forEachParticle(f)}function w(t){this.forEachParticle(d,t)}function S(t){this.forEachParticle(v,t)}function _(t){h.call(this),g.call(this,t),w.call(this,t),b.call(this,t),l.call(this,t),y.call(this,t),S.call(this,t)}var x=t("famous-physics/bodies/Particle"),C=t("famous-physics/bodies/Body"),O=t("famous-physics/bodies/Circle"),T=t("famous-physics/bodies/Rectangle"),k=t("famous-physics/forces/Force"),E=t("famous-physics/constraints/Constraint"),I=t("famous-physics/integrator/SymplecticEuler");n.BODIES={POINT:x,BODY:C,CIRCLE:O,RECTANGLE:T},n.IMMUNITIES=x.IMMUNITIES,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]&&(this.opts[e]=t[e])},n.prototype.addBody=function(t){return this._particles.push(t),t},n.prototype.createParticle=function(t){return this.addBody(new x(t))},n.prototype.createBody=function(t){var e=t.shape||n.BODIES.POINT;return this.addBody(new e(t))},n.prototype.remove=function(t){var e=this._particles.indexOf(t);if(e>-1){for(var i=0;i<Object.keys(this._agents);i++)this.detachFrom(i,t);this._particles.splice(e,1)}},n.prototype.attach=function(t,e,i){if(t instanceof Array){for(var n=[],o=0;o<t.length;o++)n[o]=s.call(this,t[o],e,i);return n}return s.call(this,t,e,i)},n.prototype.attachTo=function(t,e){a.call(this,t).targets.push(e)},n.prototype.detach=function(t){var e=this.getAgent(t),i=r.call(this,e),n=i.indexOf(t);i.splice(n,1),delete this._agents[t]},n.prototype.detachFrom=function(t,e){var i=a.call(this,t);if(i.source===e)this.detach(t);else{var n=i.targets,o=n.indexOf(e);o>-1&&n.splice(o,1)}},n.prototype.detachAll=function(){this._agents={},this._forces=[],this._constraints=[],this._currAgentId=0},n.prototype.getAgent=function(t){return a.call(this,t).agent},n.prototype.getParticles=function(){return this._particles},n.prototype.getParticlesExcept=function(t){var e=[];return this.forEachParticle(function(i){-1===t.indexOf(i)&&e.push(i)}),e},n.prototype.getPos=function(t){return(t||this._particles[0]).getPos()},n.prototype.getVel=function(t){return(t||this._particles[0]).getVel()},n.prototype.getTransform=function(t){return(t||this._particles[0]).getTransform()},n.prototype.setPos=function(t,e){(e||this._particles[0]).setPos(t)},n.prototype.setVel=function(t,e){(e||this._particles[0]).setVel(t)},n.prototype.forEachParticle=function(t,e){for(var i=this.getParticles(),n=0,o=i.length;o>n;n++)t.call(this,i[n],e)},n.prototype.step=function(){if(this._playing){this._prevTime||(this._prevTime=o()),this._currTime=o();var t=this._currTime-this._prevTime;this._prevTime=this._currTime,0!=t&&_.call(this,this.opts.speed*this._timestep)}},n.prototype.render=function(t){this.step();var e=[];return this.forEachParticle(function(i){e.push(i.render(t))}),e},n.prototype.play=function(){this._prevTime=o(),this._playing=!0},n.prototype.pause=function(){this._playing=!1},n.prototype.toggle=function(){this._playing?this.pause():this.play()},n.prototype.reverseTime=function(){this.opts.speed*=-1},n.prototype.reverseVelocities=function(){this.forEachParticle(function(t){t.v.mult(-1,t.v)})},i.exports=n}),define("famous-physics/forces/Drag",["require","exports","module","famous-physics/forces/Force"],function(t,e,i){function n(t){this.opts={strength:.01,forceFunction:n.FORCE_FUNCTIONS.LINEAR},t&&this.setOpts(t),o.call(this)}var o=t("famous-physics/forces/Force");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},n.prototype.applyForce=function(t){for(var e=this.opts.strength,i=this.opts.forceFunction,n=this.force,o=0;o<t.length;o++){var s=t[o];i(s.v).mult(-e).put(n),s.applyForce(n)}},n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},i.exports=n}),define("famous-physics/forces/Spring",["require","exports","module","famous-physics/forces/Force","famous-physics/math/Vector","famous/EventHandler"],function(t,e,i){function n(t){this.opts={period:300,dampingRatio:.1,length:0,lMin:0,lMax:1/0,anchor:void 0,forceFunction:n.FORCE_FUNCTIONS.HOOK,restTolerance:1e-5},t&&this.setOpts(t),this.eventOutput=void 0,this._atRest=!1,this.init(),h.call(this),this.disp=new l(0,0,0)}function o(t){this.forceFunction=t}function s(){var t=this.opts;t.stiffness=Math.pow(2*Math.PI/t.period,2)}function r(){var t=this.opts;t.damping=4*Math.PI*t.dampingRatio/t.period}function a(t,e){return.5*t*e*e}function u(t,e){t<this.opts.restTolerance?(this._atRest||this.eventOutput.emit("atRest",{particle:e}),this._atRest=!0):this._atRest=!1}function c(){this.eventOutput=new p,this.eventOutput.bindThis(this),p.setOutputHandler(this,this.eventOutput)}var h=t("famous-physics/forces/Force"),l=t("famous-physics/math/Vector"),p=t("famous/EventHandler");n.prototype=Object.create(h.prototype),n.prototype.constructor=h,n.FORCE_FUNCTIONS={FENE:function(t,e){var i=.99*e,n=Math.max(Math.min(t,i),-i);return n/(1-n*n/(e*e))},HOOK:function(t){return t}},n.prototype.init=function(){o.call(this,this.opts.forceFunction),s.call(this),r.call(this)},n.prototype.applyForce=function(t,e){for(var i=this.force,n=this.disp,o=this.opts,s=o.stiffness,r=o.damping,c=o.length,h=o.lMax,l=o.anchor||e.p,p=0;p<t.length;p++){var f=t[p];n.set(l.sub(f.p));var d=n.norm()-c;if(0==d)return;var m=f.m;if(s*=m,r*=m,i.set(n.normalize(s*this.forceFunction(d,h))),r&&(e?i.set(i.add(f.v.sub(e.v).mult(-r))):i.set(i.add(f.v.mult(-r)))),f.applyForce(i),e&&e.applyForce(i.mult(-1)),this.eventOutput){var v=f.getEnergy()+a(s,d);u.call(this,v,f)}}},n.prototype.getEnergy=function(t,e){var i=this.opts,n=i.length,o=i.anchor||e.p,s=i.stiffness,r=o.sub(t.p).norm()-n;return.5*s*r*r},n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor.p instanceof l&&(this.opts.anchor=t.anchor.p),t.anchor instanceof l&&(this.opts.anchor=t.anchor),t.anchor instanceof Array&&(this.opts.anchor=new l(t.anchor))),void 0!==t.period&&(this.opts.period=t.period),void 0!==t.dampingRatio&&(this.opts.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.opts.length=t.length),void 0!==t.lMin&&(this.opts.lMin=t.lMin),void 0!==t.lMax&&(this.opts.lMax=t.lMax),void 0!==t.forceFunction&&(this.opts.forceFunction=t.forceFunction),void 0!==t.restTolerance&&(this.opts.restTolerance=t.restTolerance),this.init()},n.prototype.setAnchor=function(t){void 0===this.opts.anchor&&(this.opts.anchor=new l),this.opts.anchor.set(t)},n.prototype.on=function(){return c.call(this),this.on.apply(this,arguments)},n.prototype.unbind=function(){return c.call(this),this.unbind.apply(this,arguments)},n.prototype.pipe=function(){return c.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return c.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous-sync/TouchSync",["require","exports","module","./TouchTracker","famous/EventHandler"],function(t,e,i){function n(t,e){this.targetGet=t,this.output=new u,this.touchTracker=new a,this.options={direction:void 0,rails:!1,scale:1},e?this.setOptions(e):this.setOptions(this.options),u.setOutputHandler(this,this.output),u.setInputHandler(this,this.touchTracker),this.touchTracker.on("trackstart",o.bind(this)),this.touchTracker.on("trackmove",s.bind(this)),this.touchTracker.on("trackend",r.bind(this))}function o(t){this.output.emit("start",{count:t.count,touch:t.touch.identifier})}function s(t){var e=t.history,i=e[e.length-2].timestamp,o=e[e.length-1].timestamp,s=e[e.length-2].touch,r=e[e.length-1].touch,a=r.pageX-s.pageX,u=r.pageY-s.pageY;this.options.rails&&(Math.abs(a)>Math.abs(u)?u=0:a=0);var c=Math.max(o-i,8),h=a/c,l=u/c;if(e.length>2)var p=e[e.length-3].touch,f=(r.pageX-2*s.pageX+p.pageX)/(c*c),d=(r.pageY-2*s.pageY+p.pageY)/(c*c);else var f=0,d=0;var m,v,g,y=this.targetGet(),b=this.options.scale;this.options.direction==n.DIRECTION_X?(m=y+b*a,v=b*h,g=b*l):this.options.direction==n.DIRECTION_Y?(m=y+b*u,v=b*l,g=b*d):(m=[y[0]+b*a,y[1]+b*u],v=[b*h,b*l],g=[b*f,b*d]),this.output.emit("update",{p:m,v:v,a:g,touch:t.touch.identifier})}function r(t){var e=void 0!==this.options.direction?0:[0,0],i=t.history,o=t.count,s=this.targetGet();if(i.length>1){var r=i[i.length-2].timestamp,a=i[i.length-1].timestamp,u=i[i.length-2].touch,c=i[i.length-1].touch,h=c.pageX-u.pageX,l=c.pageY-u.pageY;this.options.rails&&(Math.abs(h)>Math.abs(l)?l=0:h=0);var e,p=Math.max(a-r,1),f=h/p,d=l/p,m=this.options.scale;e=this.options.direction==n.DIRECTION_X?m*f:this.options.direction==n.DIRECTION_Y?m*d:[m*f,m*d]}this.output.emit("end",{p:s,v:e,count:o,touch:t.touch.identifier})}var a=t("./TouchTracker"),u=t("famous/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.getOptions=function(){return this.options},i.exports=n}),define("famous-sync/ScrollSync",["require","exports","module","famous/EventHandler","famous/Engine"],function(t,e,i){function n(t,e){this.targetGet=t,this.options={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50},e?this.setOptions(e):this.setOptions(this.options),this.input=new r,this.output=new r,r.setInputHandler(this,this.input),r.setOutputHandler(this,this.output),this._prevTime=void 0,this._prevVel=void 0,this._lastFrame=void 0,this.input.on("mousewheel",s.bind(this)),this.input.on("wheel",s.bind(this)),this.inProgress=!1,this._loopBound=!1}function o(){var t=Date.now();if(this.inProgress&&t-this._prevTime>this.options.stallTime){var e=this.targetGet();this.inProgress=!1;var i=0;Math.abs(this._prevVel)>=this.options.minimumEndSpeed&&(i=this._prevVel),this.output.emit("end",{p:e,v:i,slip:!0})}}function s(t){t.preventDefault(),this.inProgress||(this.inProgress=!0,this.output.emit("start",{slip:!0}),this._loopBound||(a.on("prerender",o.bind(this)),this._loopBound=!0));var e=this._prevTime,i=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,s=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY,r=Date.now();this.options.rails&&(Math.abs(i)>Math.abs(s)?s=0:i=0);var u,c,h=Math.max(r-e,8),l=i/h,p=s/h,f=this.targetGet(),d=this.options.scale;this.options.direction==n.DIRECTION_X?(u=f+d*i,c=d*l):this.options.direction==n.DIRECTION_Y?(u=f+d*s,c=d*p):(u=[f[0]+d*i,f[1]+d*s],c=[d*l,d*p]),this.output.emit("update",{p:u,v:c,slip:!0}),this._prevTime=r,this._prevVel=c}var r=t("famous/EventHandler"),a=t("famous/Engine");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.minimumEndSpeed&&(this.options.minimumEndSpeed=t.minimumEndSpeed),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime)},i.exports=n}),define("famous-sync/GenericSync",["require","exports","module","famous/EventHandler","./TouchSync","./ScrollSync"],function(t,e,i){function n(t,e){this.targetGet=t,this.eventInput=new s,s.setInputHandler(this,this.eventInput),this.eventOutput=new s,s.setOutputHandler(this,this.eventOutput),this._handlers=void 0,this.options={syncClasses:u},this._handlerOptions=this.options,e&&this.setOptions(e),this._handlers||o.call(this)}function o(){if(this._handlers)for(var t=0;t<this._handlers.length;t++)this.eventInput.unpipe(this._handlers[t]),this._handlers[t].unpipe(this.eventOutput);this._handlers=[];for(var t=0;t<this.options.syncClasses.length;t++){var e=this.options.syncClasses[t];this._handlers[t]=new e(this.targetGet,this._handlerOptions),this.eventInput.pipe(this._handlers[t]),this._handlers[t].pipe(this.eventOutput)}}var s=t("famous/EventHandler"),r=t("./TouchSync"),a=t("./ScrollSync"),u=[r,a];n.register=function(t){u.indexOf(t)<0&&u.push(t)},n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DIRECTION_Z=2,n.prototype.setOptions=function(t){if(this._handlerOptions=t,t.syncClasses&&(this.options.syncClasses=t.syncClasses,o.call(this)),this._handlers)for(var e=0;e<this._handlers.length;e++)this._handlers[e].setOptions(this._handlerOptions)},i.exports=n}),define("famous/Group",["require","exports","module","./Context","./Matrix","./Surface"],function(t,e,i){function n(t){r.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new o(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0],this._origin=void 0,this._originTransfer={render:function(t){return{origin:this._origin,target:t}}.bind(this)}}var o=t("./Context"),s=t("./Matrix"),r=t("./Surface");n.SIZE_ZERO=[0,0],n.prototype=Object.create(r.prototype),n.prototype.elementType="div",n.prototype.elementClass="group",n.prototype.link=function(){var t=this.context.link(this._originTransfer);return t.link.apply(t,arguments)},n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.mod=function(){return this.context.mod.apply(this.context,arguments)},n.prototype.render=function(){return r.prototype.render.call(this)},n.prototype.deploy=function(t){this.context.migrate(t)},n.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},n.prototype.commit=function(t,e,i,o,a){e=s.moveThen([-o[0]*a[0],-o[1]*a[1],0],e);var u=r.prototype.commit.call(this,t,e,i,o,n.SIZE_ZERO);return this._origin=o,(a[0]!=this._groupSize[0]||a[1]!=this._groupSize[1])&&(this.context.setSize(a),this._groupSize[0]=a[0],this._groupSize[1]=a[1]),this.context.update(),u},i.exports=n}),define("famous-views/Scrollview",["require","exports","module","famous/Utility","famous-physics/PhysicsEngine","famous-physics/bodies/Particle","famous-physics/forces/Drag","famous-physics/forces/Spring","famous/Matrix","famous/EventHandler","famous-sync/GenericSync","famous/ViewSequence","famous/Group","famous/Entity"],function(t,e,i){function n(t){this.options={direction:b.Direction.Y,rails:!0,defaultItemSize:[100,100],itemSpacing:0,clipSize:void 0,margin:void 0,drag:.001,edgeGrip:.5,edgePeriod:300,edgeDamp:1,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:1/0,pageSwitchSpeed:1,speedLimit:10},this.physicsEngine=new w,this.particle=new S,this.physicsEngine.addBody(this.particle),this.spring=new x({anchor:[0,0,0]}),this.drag=new _,this.sync=new T(function(){return-this.getPosition()}.bind(this),{direction:this.options.direction==b.Direction.X?T.DIRECTION_X:T.DIRECTION_Y}),this.eventInput=new O,this.eventOutput=new O,this.sync.pipe(this.eventInput),this.sync.pipe(this.eventOutput),O.setOutputHandler(this,this.eventOutput),this._outputFunction=void 0,this._masterOutputFunction=void 0,this.setOutputFunction(),this.touchCount=0,this._springAttached=!1,this.currSpring=void 0,this._onEdge=0,this._springPosition=0,this._touchVelocity=void 0,this._earlyEnd=!1,this._masterOffset=0,this._lastFrameNode=void 0,t?this.setOptions(t):this.setOptions({}),a.call(this),this.group=new E,this.group.link({render:y.bind(this)}),this._entityId=I.register(this),this._contextSize=[window.innerWidth,window.innerHeight],this._offsets={}}function o(t){this.touchCount=t.count,void 0===t.count&&(this.touchCount=1),c.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function s(t){var e=-t.p,i=-t.v;this._onEdge&&t.slip&&(0>i&&this._onEdge<0||i>0&&this._onEdge>0?this._earlyEnd||(r.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(i)>Math.abs(this.particle.getVel()[0])&&o.call(this,t)),this._earlyEnd||(this._touchVelocity=i,this.setPosition(e))}function r(t){if(this.touchCount=t.count||0,!this.touchCount){c.call(this),this._onEdge&&(this._springAttached=!0),u.call(this);var e=-t.v,i=this.options.speedLimit;t.slip&&(i*=this.options.edgeGrip),-i>e?e=-i:e>i&&(e=i),this.setVelocity(e),this._touchVelocity=void 0}}function a(){this.eventInput.on("start",o.bind(this)),this.eventInput.on("update",s.bind(this)),this.eventInput.on("end",r.bind(this))}function u(){this._springAttached?this.physicsEngine.attach([this.spring],this.particle):this.physicsEngine.attach([this.drag],this.particle)}function c(){this._springAttached=!1,this.physicsEngine.detachAll()}function h(t){return t||(t=this.options.defaultItemSize),t[this.options.direction==b.Direction.X?0:1]}function l(t){this._springPosition+=t,this.setPosition(this.getPosition()+t),this.spring.setOpts({anchor:[this._springPosition,0,0]})}function p(){for(var t=!1;!t&&this.getPosition()<0;){var e=this.node.getPrevious?this.node.getPrevious():void 0;if(e){var i=e.getSize?e.getSize():this.options.defaultItemSize,n=h.call(this,i)+this.options.itemSpacing;l.call(this,n),this._masterOffset-=n,this.node=e}else t=!0}for(var o=this.node&&this.node.getSize?this.node.getSize():this.options.defaultItemSize;!t&&this.getPosition()>=h.call(this,o)+this.options.itemSpacing;){var s=this.node.getNext?this.node.getNext():void 0;if(s){var n=h.call(this,o)+this.options.itemSpacing;l.call(this,-n),this._masterOffset+=n,this.node=s,o=this.node.getSize?this.node.getSize():this.options.defaultItemSize}else t=!0}Math.abs(this._masterOffset)>g.call(this)+this.options.margin&&(this._masterOffset=0)}function f(t){!this._onEdge&&t?(this.sync.setOptions({scale:this.options.edgeGrip}),this.touchCount||this._springAttached||(this._springAttached=!0,this.physicsEngine.attach([this.spring],this.particle))):this._onEdge&&!t&&(this.sync.setOptions({scale:1}),this._springAttached&&(c.call(this),u.call(this))),this._onEdge=t}function d(){if(0==this.touchCount&&!this._springAttached&&!this._onEdge&&this.options.paginated&&Math.abs(this.getVelocity())<this.options.pageStopSpeed){var t=this.node.getSize?this.node.getSize():this.options.defaultItemSize,e=Math.abs(this.getVelocity())>this.options.pageSwitchSpeed,i=this.getVelocity()>0,n=this.getPosition()>.5*h.call(this,t);(e&&i||!e&&n)&&this.goToNextPage(),m.call(this,0,{period:this.options.pagePeriod,damp:this.options.pageDamp}),this._springAttached=!0,this.physicsEngine.attach([this.spring],this.particle)}}function m(t,e){e||(e={period:this.options.edgePeriod,damp:this.options.edgeDamp}),this._springPosition=t,this.spring.setOpts({anchor:[this._springPosition,0,0],period:e.period,dampingRatio:e.damp})}function v(t,e,i){var n=t.getSize?t.getSize():this.options.defaultItemSize;n||(n=this.options.defaultItemSize);var o=this._outputFunction(e);return i.push({transform:o,target:t.render()}),n[this.options.direction==b.Direction.X?0:1]}function g(){return this.options.clipSize?this.options.clipSize:h.call(this,this._contextSize)}function y(){var t={};if(this.node){var e=this.getPosition(),i=[],n=0,o=0,s=this.node;for(t[s]=0;s&&o-e<g.call(this)+this.options.margin;)o+=v.call(this,s,o+this._masterOffset,i)+this.options.itemSpacing,s=s.getNext?s.getNext():void 0,t[s]=o,!s&&o-e-this.options.itemSpacing<=g.call(this)&&(this._onEdge||m.call(this,o-g.call(this)-this.options.itemSpacing),n=1);if(s=this.node&&this.node.getPrevious?this.node.getPrevious():void 0,o=0,s){var r=s.getSize?s.getSize():this.options.defaultItemSize;o-=h.call(this,r)+this.options.itemSpacing}else 0>=e&&(this._onEdge||m.call(this,0),n=-1);for(;s&&o-e>-(g.call(this)+this.options.margin);)if(t[s]=o,v.call(this,s,o+this._masterOffset,i),s=s.getPrevious?s.getPrevious():void 0){var r=s.getSize?s.getSize():this.options.defaultItemSize;o-=h.call(this,r)+this.options.itemSpacing}return this._offsets=t,f.call(this,n),d.call(this),this.options.paginated&&this._lastFrameNode!==this.node&&(this.eventOutput.emit("pageChange"),this._lastFrameNode=this.node),i}}var b=t("famous/Utility"),w=t("famous-physics/PhysicsEngine"),S=t("famous-physics/bodies/Particle"),_=t("famous-physics/forces/Drag"),x=t("famous-physics/forces/Spring"),C=t("famous/Matrix"),O=t("famous/EventHandler"),T=t("famous-sync/GenericSync"),k=t("famous/ViewSequence"),E=t("famous/Group"),I=t("famous/Entity");n.prototype.emit=function(t,e){"update"==t||"start"==t||"end"==t?this.eventInput.emit(t,e):this.sync.emit(t,e)},n.prototype.getPosition=function(t){var e=this.particle.getPos()[0];if(void 0===t)return e;var i=this._offsets[t];return void 0!==i?e-i:void 0},n.prototype.setPosition=function(t){this.particle.setPos([t,0,0])},n.prototype.getVelocity=function(){return this.touchCount?this._touchVelocity:this.particle.getVel()[0]},n.prototype.setVelocity=function(t){this.particle.setVel([t,0,0])},n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction,"x"===this.options.direction?this.options.direction=b.Direction.X:"y"===this.options.direction&&(this.options.direction=b.Direction.Y)),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.defaultItemSize&&(this.options.defaultItemSize=t.defaultItemSize),void 0!==t.itemSpacing&&(this.options.itemSpacing=t.itemSpacing),void 0!==t.clipSize&&(this.options.clipSize=t.clipSize),void 0!==t.margin&&(this.options.margin=t.margin),void 0!==t.drag&&(this.options.drag=t.drag),void 0!==t.friction&&(this.options.friction=t.friction),void 0!==t.edgeGrip&&(this.options.edgeGrip=t.edgeGrip),void 0!==t.edgePeriod&&(this.options.edgePeriod=t.edgePeriod),void 0!==t.edgeDamp&&(this.options.edgeDamp=t.edgeDamp),void 0!==t.paginated&&(this.options.paginated=t.paginated),void 0!==t.pageStopSpeed&&(this.options.pageStopSpeed=t.pageStopSpeed),void 0!==t.pageSwitchSpeed&&(this.options.pageSwitchSpeed=t.pageSwitchSpeed),void 0!==t.pagePeriod&&(this.options.pagePeriod=t.pagePeriod),void 0!==t.pageDamp&&(this.options.pageDamp=t.pageDamp),void 0!==t.speedLimit&&(this.options.speedLimit=t.speedLimit),void 0===this.options.margin&&(this.options.margin=.5*Math.max(window.innerWidth,window.innerHeight)),this.drag.setOpts({strength:this.options.drag}),this.spring.setOpts({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.sync.setOptions({rails:this.options.rails,direction:this.options.direction==b.Direction.X?T.DIRECTION_X:T.DIRECTION_Y})
},n.prototype.setOutputFunction=function(t,e){t||(t=function(t){return this.options.direction==b.Direction.X?C.translate(t,0):C.translate(0,t)}.bind(this),e=t),this._outputFunction=t,this._masterOutputFunction=e?e:function(e){return C.inverse(t(-e))}},n.prototype.goToPreviousPage=function(){var t=this.node.getPrevious?this.node.getPrevious():void 0;if(t){var e=h.call(this,this.node.getSize())+this.options.itemSpacing;this.setPosition(this.getPosition()+e),this.node=t;for(var i in this.offsets)this.offsets[i]+=e}return t},n.prototype.goToNextPage=function(){var t=this.node.getNext?this.node.getNext():void 0;if(t){var e=h.call(this,this.node.getSize())+this.options.itemSpacing;this.setPosition(this.getPosition()-e),this.node=t;for(var i in this.offsets)this.offsets[i]-=e}return t},n.prototype.getCurrentNode=function(){return this.node},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new k(t)),this.node=t,this._lastFrameNode=t},n.prototype.getSize=function(){return this.options.direction==b.Direction.X?[g.call(this),void 0]:[void 0,g.call(this)]},n.prototype.render=function(){return this.physicsEngine.step(),this._entityId},n.prototype.commit=function(t,e,i,n,o){this._contextSize=o,p.call(this);var s=this.getPosition(),r=this._masterOutputFunction(-(s+this._masterOffset));return{transform:C.moveThen([-n[0]*o[0],-n[1]*o[1],0],e),opacity:i,origin:n,size:o,target:{transform:r,origin:n,target:this.group.render()}}},i.exports=n}),define("views/contact/SocialItemView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous/Modifier"],function(t,e,i){function n(t,e){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput);var i=51;e&&(i=77),this.surface=new s({classes:["import-item","editable"],size:[void 0,i]}),this.surface.on("click",function(t){var e=$(t.target);e.hasClass("import-source")&&this.eventOutput.emit("goBack",this.model)}.bind(this)),this.template(e),this.surface.pipe(this.eventOutput),this.mod=new a({transform:void 0}),this._link(this.mod),this._link(this.surface)}var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates"),t("famous/Modifier"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(t){var e,i;this.model.get("firstname")||this.model.get("lastname")?(e=this.model.get("firstname")+" <b class='import-source'>"+this.model.get("lastname")+"</b>",i=this.model.get("firstname")[0]+this.model.get("lastname")[0]):e=this.model.get("email");var n='<div class="import-source">'+e+"</div>";t&&(n='<div class="first-char">'+t+"</div>"+n),this.surface.setContent(n)},i.exports=n}),define("views/contact/SocialView",["require","exports","module","famous/View","famous/Utility","app/custom/Surface","famous-views/Scrollview","views/contact/SocialItemView","famous-views/HeaderFooterLayout","famous/EventHandler","famous/Modifier","famous/Matrix","app/custom/TouchSync","famous-sync/GenericSync"],function(t,e,i){function n(t){o.call(this),this.searchBarSize=50,this.abcSurfaceWidth=30,this.abcSurfaceHeight=void 0,this.a2zString="ABCDEFGHIJKLMNOPQRSTUVWXYZ#",this.eventInput=new h,h.setInputHandler(this,this.eventInput),this.eventOutput=new h,h.setOutputHandler(this,this.eventOutput),this.headerFooterLayout=new c({headerSize:this.searchBarSize,footerSize:0}),this.searchSurface=new r({size:[void 0,this.searchBarSize],classes:["import-section-search-bar"],content:'<div><i class="fa fa-search"></i>   <input type="text" class="search-import" placeholder = "Search" ></div></div>',properties:{backgroundColor:"rgba(15,15,15,0.9)",color:"white",zIndex:2}}),this.abcSurface=new r({size:[this.abcSurfaceWidth,this.abcSurfaceHeight],classes:["abcButton"],content:'<button id="A">A</button><button id="B">B</button><button id="C">C</button><button id="D">D</button><button id="E">E</button><button id="F">F</button><button id="G">G</button><button id="H">H</button><button id="I">I</button><button id="J">J</button><button id="K">K</button><button id="L">L</button><button id="M">M</button><button id="N">N</button><button id="O">O</button><button id="P">P</button><button id="Q">Q</button><button id="R">R</button><button id="S">S</button><button id="T">T</button><button id="U">U</button><button id="V">V</button><button id="W">W</button><button id="X">X</button><button id="Y">Y</button><button id="Z">Z</button><button id="#">#</button>',properties:{backgroundColor:"rgba(160,160,160,0.0)",zIndex:2}}),this.abcMod=new l({origin:[1,0]}),this.collection=t.collection,this.scrollview=new a({direction:s.Direction.Y,margin:1e4}),this.headerFooterLayout.id.header.link(this.searchSurface),this.headerFooterLayout.id.content.add(this.scrollview),this.headerFooterLayout.id.content.add(this.abcMod).link(this.abcSurface),this.pipe(this.scrollview),this._add(this.headerFooterLayout),this.loadContacts(),this.searchSurface.on("keyup",function(t){this.loadContacts(t.target.value)}.bind(this)),this.abcSurface.on("mousemove",function(t){this.onAbcTouch(t)}.bind(this));var e=[0,0],i=new f(function(){return e},{syncClasses:[p]});this.abcSurface.pipe(i),i.on("update",function(t){var e=document.elementFromPoint(t.ap[0],t.ap[1]);if(void 0!=e.id&&""!=e.id){var i=this.a2zString.indexOf(e.id);i=this.a2zIndexArray[i],void 0!=i&&i!=this.curAbcIndex&&(this.curAbcIndex=i,this.scrollTo(i))}}.bind(this))}var o=t("famous/View"),s=t("famous/Utility"),r=t("app/custom/Surface"),a=t("famous-views/Scrollview"),u=t("views/contact/SocialItemView"),c=t("famous-views/HeaderFooterLayout"),h=t("famous/EventHandler"),l=t("famous/Modifier"),p=(t("famous/Matrix"),t("app/custom/TouchSync")),f=t("famous-sync/GenericSync");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.loadContacts=function(t){this.currentCollection=t?this.collection.searchContact(t.toUpperCase()):this.collection,this.firstChar=void 0,this.a2zIndexArray=[0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],this.currentCollection;for(var e=this.currentCollection.map(function(t){return this.getIndex(t)}.bind(this));-1!=this.a2zIndexArray.indexOf(-1);)this.a2zIndexArray[this.a2zIndexArray.indexOf(-1)]=this.a2zIndexArray[this.a2zIndexArray.indexOf(-1)-1];for(var i=_.last(this.a2zIndexArray),n=this.scrollview.getSize()[1]+40,o=i;o<e.length;o++)n-=e[o].getSize()[1];if(n>0){var s=new r({size:[void 0,n]});s.pipe(this.eventOutput),e.push(s)}this.scrollview.sequenceFrom(e)},n.prototype.onAbcTouch=function(t){this.abcButtons||(this.abcButtons=$(".abcButton button"));var e=this.abcButtons.indexOf(t.target);e=this.a2zIndexArray[e],void 0!=e&&e!=this.curAbcIndex&&(this.curAbcIndex=e,this.scrollTo(e))},n.prototype.getIndex=function(t){var e=!1;/^[a-zA-Z]+$/.test(t.get("lastname")[0])?t.get("lastname")&&this.firstChar!=t.get("lastname")[0].toUpperCase()&&(this.firstChar=t.get("lastname")[0].toUpperCase(),e=this.firstChar,this.getCurrentIndex(t)):"#"!=this.firstChar&&(this.firstChar="#",e="#",this.getCurrentIndex(t));var i=new u({model:t},e);return i.pipe(this.eventOutput),i},n.prototype.getCurrentIndex=function(t){var e=this.currentCollection.indexOf(t);this.a2zIndexArray[this.a2zString.indexOf(this.firstChar)]=e},n.prototype.scrollTo=function(t,e){0>t||(this.scrollview.setVelocity(0),this.scrollview.node.index=t,e||(e=0),this.scrollview.setPosition(e))},i.exports=n}),define("views/contact/ImportContactView",["require","exports","module","famous-views/HeaderFooterLayout","famous/Surface","famous/EventHandler","famous/Matrix","famous-animation/Easing","app/custom/UpDownTransform","views/contact/SocialView"],function(t,e,i){function n(t){o.call(this),this.collection=t.collection,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.header=new s({content:'<button class="left back-button">Back</button><div>'+t.title+" Contacts</div>",classes:["header"],size:[void 0,50],properties:{}}),this.content=new a({collection:this.collection}),this.id.header.link(this.header),this.id.content.link(this.content),this.header.pipe(this.eventOutput),this.content.pipe(this.eventOutput),this.header.on("click",function(t){var e=$(t.target);e.hasClass(".edit-button")&&this.submitForm()}.bind(this)),this.header.on("click",function(t){$(t.target).hasClass("back-button")&&this.eventOutput.emit("goBack")}.bind(this)),this.header.pipe(this.eventOutput)}var o=t("famous-views/HeaderFooterLayout"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("famous/Matrix"),t("famous-animation/Easing"),t("app/custom/UpDownTransform"),t("views/contact/SocialView"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,i.exports=n}),define("views/contact/AddContactView",["require","exports","module","famous-views/HeaderFooterLayout","famous/Surface","famous/EventHandler","famous/Matrix","famous-animation/Easing","app/custom/UpDownTransform","views/contact/ImportContactView","app/models/ContactCollection","famous/View","famous-views/EdgeSwapper","app/custom/Templates","app/models/SocialContactCollection","app/models/Contact","app/models/Call"],function(t,e,i){function n(t){function e(t){t&&t.attributes&&(this.getFormObject(),t.attributes.provider?this.formObject[t.attributes.provider]=t.attributes:this.formObject=_.extend(this.formObject,t.attributes),this.formObject.firstname=this.formObject.firstname?this.formObject.firstname:t.attributes.firstname,this.formObject.lastname=this.formObject.lastname?this.formObject.lastname:t.attributes.lastname,this.formObject.email=this.formObject.email?this.formObject.email:t.attributes.email,this.renderContact())}function i(t){l.show(this.headerFooterLayout,!0,function(){e.bind(this)(t)}.bind(this))}c.call(this),window.addContactView=this,this.formObject={},this.social={},this.headerFooterLayout=new o({headerSize:50,footerSize:0});var n=new a;void 0===t.inTransform&&(this.options.inTransform=n.options.inTransform),void 0===t.outTransform&&(this.options.outTransform=n.options.outTransform),void 0===t.inTransition&&(this.options.inTransition=n.options.inTransition),void 0===t.outTransition&&(this.options.outTransition=n.options.outTransition),void 0===t.inOpacity&&(this.options.inOpacity=n.options.inOpacity),void 0===t.outOpacity&&(this.options.outOpacity=n.options.outOpacity),this.options.showOrigin=[0,0],this.options.inOrigin=[0,0],this.options.outOrigin=[0,0],this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.header=new s({classes:["header"],size:[void 0,50],properties:{}}),this.content=new s({classes:["add-contact-view"],size:[void 0,void 0],properties:{padding:"20px",backgroundColor:"transparent"}}),this.headerFooterLayout.id.header.link(this.header),this.headerFooterLayout.id.content.link(this.content);var l=new h;this._link(l),l.show(this.headerFooterLayout),this.content.pipe(this.eventOutput),this.header.pipe(this.eventOutput),this.renderContact(),this.header.on("click",function(t){var e=$(t.target);e.hasClass("done-contact")?(this.submitForm(),$("body").removeClass("editing"),this.eventOutput.emit("showApp")):e.hasClass("close-button")&&this.eventOutput.emit("showApp")}.bind(this)),this.collection=t.collection,this.content.on("click",function(t){function e(){if(_.isArray(this.social[o].models)){var t=new u({title:_(o).capitalize(),collection:this.social[o]});t.pipe(this.eventOutput),l.show(t,!0)}}function i(){this.eventOutput.emit("onSocialLink",o),delete this.social[o]}var n=$(t.target);if(n.hasClass("import-contact")){var o=n[0].id;this.social[o]?e.bind(this)():(this.social[o]=new p,this.social[o].url="/contact/"+o,this.social[o].fetch({success:e.bind(this),error:i.bind(this)}))}else if(n.hasClass("remove-button")){var o=n[0].id;o&&delete this.formObject[o],this.renderContact()}}.bind(this)),this.eventOutput.on("goBack",i)}{var o=t("famous-views/HeaderFooterLayout"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("famous/Matrix"),t("famous-animation/Easing"),t("app/custom/UpDownTransform")),u=t("views/contact/ImportContactView"),c=(t("app/models/ContactCollection"),t("famous/View")),h=t("famous-views/EdgeSwapper"),l=t("app/custom/Templates"),p=t("app/models/SocialContactCollection"),f=t("app/models/Contact");t("app/models/Call")}n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.prototype.renderContact=function(){var t='<div class="initial">'+this.initial+"</div>";if(t+='<form role="form">',t+='<div class="form-group small">',t+='<input type="text" class="form-control" id="input-first-name" placeholder="First" name="firstname"',this.formObject.firstname&&(t+=' value="'+this.formObject.firstname+'"'),t+="></div>",t+='<div class="form-group small">',t+='<input type="text" class="form-control" id="input-last-name" placeholder="Last" name="lastname"',this.formObject.lastname&&(t+=' value="'+this.formObject.lastname+'"'),t+="></div>",t+='<div class="form-group small">',t+='<input type="email" class="form-control" id="input-email" placeholder="Email" name="email"',this.formObject.email&&(t+=' value="'+this.formObject.email+'"'),t+="></div>",t+='<div class="box">',t+='<div class="info import-contact" id="google"><i class="fa fa-google-plus-square fa-lg import-contact" id="google"></i>',this.formObject.google){var e=this.formObject.google;t+='<span class="import-contact" id="google">  '+e.firstname+" "+e.lastname+"</span>",t+=l.removeButton("google")+"</div>"}else t+='<span class="import-contact" id="google">  New Google Contact</span>',t+=l.nextButton("google")+"</div>";if(t+='<div class="info import-contact" id="facebook"><i class="fa fa-facebook-square fa-lg import-contact" id="facebook"></i>',this.formObject.facebook){var e=this.formObject.facebook;t+='<span class="import-contact" id="facebook">  '+e.firstname+" "+e.lastname+"</span>",t+=l.removeButton("facebook")+"</div>"}else t+='<span class="import-contact" id="facebook">  New Facebook Contact</span>',t+=l.nextButton("facebook")+"</div>";t+="</form>",this.content.setContent(t);var t='<button class="left close-button cancel-contact" id="close-button">Cancel</button><div>'+this.title+'</div><button class="right close-button done-contact">Done</button>';this.header.setContent(t)},n.prototype.getFormObject=function(){var t=$(".add-contact-view form").serializeArray(),e={};for(var i in t)t[i].name&&(e[t[i].name]=t[i].value);this.formObject=_.extend(this.formObject,e);for(var i in this.formObject)void 0===this.formObject[i]&&delete this.formObject[i];return this.formObject},n.prototype.submitForm=function(){var t=this.getFormObject();"Edit Contact"==this.title?this.model.set(t):this.collection.add(t),this.collection.trigger("sync")},n.prototype.setContact=function(t){t&&t instanceof f?(this.formObject=_.omit(t.attributes,"id"),this.title="Edit Contact",this.initial="",this.formObject.firstname&&(this.initial=this.formObject.firstname[0]),this.formObject.lastname&&(this.initial+=this.formObject.lastname[0]),this.model=t):(this.formObject={},t&&(this.formObject=_.omit(t.attributes,"id")),this.title="New Contact",this.initial='<i class="fa fa-user fa-lg"></i>')},i.exports=n}),define("famous-audio/BufferLoader",["require","exports","module"],function(t,e,i){function n(t,e,i){this.context=t,this.urlList=e,this.onload=i,this.bufferList=[],this.loadCount=0}n.prototype.loadBuffer=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer";var n=this;i.onload=function(){n.context.decodeAudioData(i.response,function(i){return i?(n.bufferList[e]=i,++n.loadCount==n.urlList.length&&n.onload(n.bufferList),void 0):(console.log("error decoding file data: "+t),void 0)})},i.onerror=function(){console.log("BufferLoader: XHR error")},i.send()},n.prototype.load=function(){for(var t=0;t<this.urlList.length;++t)this.loadBuffer(this.urlList[t],t)},i.exports=n}),define("famous-audio/SoundPlayer",["require","exports","module","./BufferLoader"],function(t,e,i){function n(t,e){this.context,this.node,this.buffersActive=[];try{window.AudioContext=window.AudioContext||window.webkitAudioContext,this.context=new AudioContext,this.bufferLoader=new o(this.context,t,this.setSounds.bind(this)),this.sounds,this.callback=e||void 0,this.bufferLoader.load()}catch(i){}}var o=t("./BufferLoader");n.prototype.setSounds=function(t){this.sounds=t,void 0!=this.callback&&this.callback()},n.prototype.isPlaying=function(){return this.buffersActive.length>0?!0:!1},n.prototype.stopPlaying=function(){var t=this.buffersActive.length;if(t>0)for(var e=0;t>e;e++){var i=this.buffersActive[e];i.stop(0)}},n.prototype.getContext=function(){return this.context},n.prototype.addNode=function(t){this.node=t},n.prototype.playSound=function(t,e,i){if(this.context&&this.sounds){var n=this.context.createBufferSource(),o=this.context.createGainNode?this.context.createGainNode():this.context.createGain();o.gain.value="undefined"==typeof e?.5:e,n.buffer=this.sounds[t],n.connect(o);var s=o;this.node&&(s.connect(this.node),s=this.node),s.connect(this.context.destination),n.start(0),n.onended=function(){var t=this.buffersActive.indexOf(n);-1!==t&&this.buffersActive.splice(t,1),i&&i()}.bind(this,n),this.buffersActive.push(n)}},i.exports=n}),define("views/call/OutgoingCallView",["require","exports","module","famous/View","famous/Matrix","famous/Surface","famous/EventHandler","app/custom/LightBox","app/custom/Templates","famous-animation/Easing","app/models/Contact","app/models/Call","famous-audio/SoundPlayer"],function(t,e,i){function n(t){o.call(this),this.collection=t.collection,this.headerLightBox=new u({inTransition:!1,outTransition:!1,showOrigin:[.5,.1],overlap:!0}),this.footerLightBox=new u({inTransform:s.translate(0,900,0),inTransition:{duration:d,curve:h.inQuadNorm()},inOpacity:0,inOrigin:[.5,.5],outTransform:s.translate(0,900,0),outOpacity:0,outOrigin:[.5,.5],outTransition:{duration:d,curve:h.outQuadNorm()},showTransform:s.identity,showOpacity:1,showOrigin:[.5,.9],overlap:!0}),this.eventInput=new a,a.setInputHandler(this,this.eventInput),this.eventOutput=new a,a.setOutputHandler(this,this.eventOutput),this.header=new r({classes:["outgoing-call-view"],size:[void 0,300],_origin:[.5,-.5],properties:{backgroundColor:"transparent"}}),this.footer=new r({classes:["outgoing-call-view-buttons"],size:[void 0,80],properties:{backgroundColor:"transparent"}}),this._add(this.headerLightBox),this._add(this.footerLightBox),_.bindAll(this,"template"),this.collection.bind("add",this.template),this.calltone=new f(["content/audio/calltone.mp3","content/audio/ringtone.mp3"]),this.footer.on("click",function(t){var e=$(t.target);e.hasClass("end-button")&&this.stop(e)}.bind(this))}var o=t("famous/View"),s=t("famous/Matrix"),r=t("famous/Surface"),a=t("famous/EventHandler"),u=t("app/custom/LightBox"),c=t("app/custom/Templates"),h=t("famous-animation/Easing"),l=t("app/models/Contact"),p=t("app/models/Call"),f=t("famous-audio/SoundPlayer"),d=500;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){this.model=this.collection.models[0];var t='<div class="box">';if(t+='<div class="caller-name">'+this.model.get("firstname")+" "+this.model.get("lastname")+"</div>",this.model.get("pictureUrl"))t+='<img class="caller-picture" src="'+this.model.get("pictureUrl")+'"></img>';else{var e=this.model.get("firstname")[0]+this.model.get("lastname")[0];t+='<div class="initial">'+e+"</div>"}t+='<div class="caller-info"></div>',this.header.setContent(t);var i=c.toggleButton({id:"video",classes:["video-button","big-button"],checked:this.appSettings?this.appSettings.get("video"):!0,onContent:'<i class="fa fa-eye fa-lg on"></i>',offContent:'<i class="fa fa-eye-slash fa-lg off"></i>',onBackgroundColor:"#dadbd9",offBackgroundColor:"#dadbd9",size:[70,70]}),n=c.button({classes:["end-button","big-button"],checked:!0,content:"End",size:[160,70]}),o=c.toggleButton({id:"audio",classes:["audio-button","big-button"],checked:this.appSettings?this.appSettings.get("audio"):!0,onContent:'<i class="fa fa-microphone fa-lg on"></i>',offContent:'<i class="fa fa-microphone-slash fa-lg off"></i>',onBackgroundColor:"#dadbd9",offBackgroundColor:"#dadbd9",size:[70,70]});t='<div class="box">'+i+n+o+"</div>",this.footer.setContent(t)},n.prototype.startCalltone=function(){this.calltone.playSound(0,1),this.calltoneRepeat=setInterval(function(){this.calltone.playSound(0,1)}.bind(this),2500),this.footerLightBox.show(this.footer),this.headerLightBox.show(this.header)},n.prototype.stopCalltone=function(){clearInterval(this.calltoneRepeat),this.calltone.stopPlaying()},n.prototype.start=function(t,e){this.appSettings=e,this.on=!0;var i;t instanceof l||t instanceof p?i=t.attributes:(this.model=this.collection.models[0]||new p,i=this.model.attributes);var n={firstname:i.firstname,lastname:i.lastname,email:i.email,facebook:i.facebook,pictureUrl:!1,type:"outgoing",time:Date.now()};this.collection.create(n),this.startCalltone(),$(".camera").removeClass("blur")},n.prototype.stop=function(t){this.on&&(this.on=!1,t&&(this.model.save({success:!1}),t.addClass("exiting")),this.stopCalltone(),setTimeout(function(){this.footerLightBox.hide(),this.headerLightBox.hide(),this.eventOutput.emit("showApp",function(){t&&t.removeClass("exiting")})}.bind(this),d),t&&this.eventOutput.emit("outgoingCallEnd",this.model))},n.prototype.accept=function(){this.on=!1,this.model.save({success:!0}),this.stopCalltone(),setTimeout(function(){this.footerLightBox.hide(),this.headerLightBox.hide(),this.eventOutput.emit("connectedCall",function(){})}.bind(this),d)},i.exports=n}),define("views/call/IncomingCallView",["require","exports","module","famous/View","famous/Matrix","famous/Surface","famous/EventHandler","app/custom/LightBox","app/custom/Templates","famous-animation/Easing","app/models/Contact","app/models/Call","famous-audio/SoundPlayer"],function(t,e,i){function n(t){o.call(this),this.collection=t.collection,this.eventInput=new a,a.setInputHandler(this,this.eventInput),this.eventOutput=new a,a.setOutputHandler(this,this.eventOutput),this.headerLightBox=new u({inTransition:!1,outTransition:!1,showOrigin:[.5,.1]}),this.footerLightBox=new u({inTransform:s.translate(0,900,0),inTransition:{duration:d,curve:h.inQuadNorm()},inOpacity:0,inOrigin:[.5,.5],outTransform:s.translate(0,900,0),outOpacity:0,outOrigin:[.5,.5],outTransition:{duration:d,curve:h.outQuadNorm()},showTransform:s.identity,showOpacity:1,showOrigin:[.5,.9]}),this.header=new r({classes:["outgoing-call-view"],size:[void 0,300],_origin:[.5,-.5],properties:{backgroundColor:"transparent"}});var e=c.button({classes:["decline-button","big-button"],checked:!0,content:"Decline",size:[160,70]}),i=c.button({classes:["answer-button","big-button"],checked:!0,content:"Answer",size:[160,70]});this.footer=new r({classes:["incoming-call-view-buttons"],size:[void 0,80],properties:{backgroundColor:"transparent"},content:'<div class="box">'+e+i+"</div>"}),this._add(this.headerLightBox),this._add(this.footerLightBox),_.bindAll(this,"template"),this.collection.bind("add",this.template),this.ringtone=new f(["content/audio/ringtone.mp3"]),this.footer.on("click",function(t){var e=$(t.target);e.hasClass("decline-button")?this.stop():e.hasClass("answer-button")&&this.accept()}.bind(this)),this.eventInput.on("incomingCall",function(){}),this.eventInput.on("incomingCallAnswerClick",function(){this.accept()}.bind(this))}var o=t("famous/View"),s=t("famous/Matrix"),r=t("famous/Surface"),a=t("famous/EventHandler"),u=t("app/custom/LightBox"),c=t("app/custom/Templates"),h=t("famous-animation/Easing"),l=t("app/models/Contact"),p=t("app/models/Call"),f=t("famous-audio/SoundPlayer"),d=500;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){this.model=this.collection.models[0]||new p;var t='<div class="box">';if(t+='<div class="caller-name">'+this.model.get("firstname")+" "+this.model.get("lastname")+"</div>",this.model.get("pictureUrl"))t+='<img class="caller-picture" src="'+this.model.get("pictureUrl")+'"></img>';else{var e=this.model.get("firstname")[0]+this.model.get("lastname")[0];t+='<div class="initial">'+e+"</div>"}t+='<div class="caller-info"></div>',this.header.setContent(t)},n.prototype.startRingtone=function(){this.ringtone.playSound(0,1),this.ringtoneRepeat=setInterval(function(){this.ringtone.playSound(0,1)}.bind(this),8e3),this.footerLightBox.show(this.footer),this.headerLightBox.show(this.header)},n.prototype.stopRingtone=function(){clearInterval(this.ringtoneRepeat),this.ringtone.stopPlaying()},n.prototype.start=function(t){this.on=!0;var e;t instanceof l||t instanceof p?e=t.attributes:(this.model=this.collection.models[0]||new p,e=this.model.attributes);var i={firstname:e.firstname,lastname:e.lastname,email:e.email,facebook:e.facebook,pictureUrl:!1,type:"incoming",time:Date.now(),roomId:e.roomId,caller:e.caller};this.collection.create(i),this.startRingtone(),$(".camera").removeClass("blur")},n.prototype.stop=function(){var t=$(".decline-button");this.on&&(this.on=!1,t&&(this.model.save({success:!1}),t.addClass("exiting")),this.stopRingtone(),setTimeout(function(){this.footerLightBox.hide(),this.headerLightBox.hide(),this.eventOutput.emit("showApp",function(){t&&t.removeClass("exiting")})}.bind(this),d))},n.prototype.accept=function(){var t=$(".answer-button");this.on=!1,this.model.save({success:!0}),t&&t.addClass("exiting"),this.stopRingtone(),setTimeout(function(){this.footerLightBox.hide(),this.headerLightBox.hide(),this.eventOutput.emit("connectedCall",function(){t&&t.removeClass("exiting")})}.bind(this),d),t&&this.eventOutput.emit("incomingCallAnswer",this.model)},i.exports=n}),define("views/conversation/ConversationItemView",["require","exports","module","famous/View","app/custom/ConversationSurface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous/Modifier"],function(t,e,i){function n(t){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.surface=new s({properties:{maxWidth:300,zIndex:2}}),this.template(),this.surface.pipe(this.eventOutput),this.mod=new a({transform:void 0}),this._link(this.mode),this._link(this.surface)}var o=t("famous/View"),s=t("app/custom/ConversationSurface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates"),t("famous/Modifier"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t=this.model.get("content");"local"==this.model.get("source")?t='<div class="conversation-item triangle-border right">'+t+"</div>":"remote"==this.model.get("source")&&(t='<div class="conversation-item triangle-border left">'+t+"</div>"),this.surface.setContent(t)},i.exports=n}),define("views/conversation/ConversationView",["require","exports","module","famous/View","famous/Utility","famous-utils/Utils","app/custom/Surface","famous-views/Scrollview","app/models/Conversation","app/models/ConversationCollection","views/conversation/ConversationItemView","famous-views/HeaderFooterLayout","famous/Engine","famous/EventHandler","app/custom/LightBox","famous/Matrix"],function(t,e,i){function n(){o.call(this),this.inputSourceLocal=!0,this.headerFooterLayout=new l({headerSize:0,footerSize:50}),this.inputSurface=new a({size:[void 0,this.headerFooterLayout.footerSize],classes:["conversation-input-bar"],content:'<div><button class="fa fa-comments-o menu-toggle-button fade"></button><button class="fa fa-phone menu-end-button"></button><input type = "text"  class="input-msg" name="message"><button class="send-text-button">Send</button></div>',properties:{backgroundColor:"#000",opacity:.9,zIndex:4}}),this.contentLightBox=new f({inTransform:d.identity,inOpacity:0,inOrigin:[0,0],outTransform:d.identity,outOpacity:0,outOrigin:[0,0],showTransform:d.identity,showOpacity:1,showOrigin:[0,0],inTransition:!0,outTransition:!0,overlap:!1}),this.collection=new c,this.scrollview=new u({direction:s.Direction.Y}),this.headerFooterLayout.id.content.link(this.contentLightBox),this.headerFooterLayout.id.footer.link(this.inputSurface),this.pipe(this.scrollview),this._add(this.headerFooterLayout),this.emptySurface=this.makeEmptySurface(0,this.scrollview.getSize()[1]),this.emptySurface.pipe(this.eventOutput),this.scrollview.sequenceFrom([this.emptySurface]),this.BlueMenuToggleButton=!1,this.collection.on("all",function(t,e){switch(t){case"add":this.addMsg(e)}}.bind(this)),this.inputSurface.on("click",function(t){var e=$(t.target);e.hasClass("send-text-button")?this.addChat():e.hasClass("menu-toggle-button")?(this.toggleMenuToggleButton(this.BlueMenuToggleButton),this.eventOutput.emit("menu-toggle-button",this.BlueMenuToggleButton)):e.hasClass("menu-end-button")?this.eventOutput.emit("end-call",$(".someRandomNull")):"INPUT"==$("input")[0].tagName&&(this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0))}.bind(this)),this.inputSurface.on("keyup",function(t){13==t.keyCode&&this.addChat()}.bind(this));var t,e=function(){this.scrollview.setVelocity(-99),this.loadMsg()};p.on("resize",function(){r.isMobile()||(t&&clearTimeout(t),t=setTimeout(e.bind(this),1e3))}.bind(this)),this.eventInput.on("incomingChat",function(t){this.addRemote(t.content)}.bind(this))}var o=t("famous/View"),s=t("famous/Utility"),r=t("famous-utils/Utils"),a=t("app/custom/Surface"),u=t("famous-views/Scrollview"),c=(t("app/models/Conversation"),t("app/models/ConversationCollection")),h=t("views/conversation/ConversationItemView"),l=t("famous-views/HeaderFooterLayout"),p=t("famous/Engine"),f=(t("famous/EventHandler"),t("app/custom/LightBox")),d=t("famous/Matrix");u.prototype.scrollToEnd=function(){var t=this.node.array.length-1,e=this.node.index,i=this.getSize()[1],n=this.getPosition(),o=this.node.array.map(function(t){return t.getSize()[1]===!0?100:t.getSize()[1]});if(r.isMobile())var s=i+o.sum();else var s=_(o).last(t-e+1).sum()-n-i+100;var a=2*s/200;setTimeout(function(){this.setVelocity(a)}.bind(this),300)},n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.start=function(){},n.prototype.addMsg=function(t){var e=new h({model:t});e.pipe(this.eventOutput),this.scrollview.node.push(e),setTimeout(function(){this.emptySurfaceResize()}.bind(this),100),setTimeout(function(){this.scrollview.scrollToEnd()}.bind(this),100)},n.prototype.loadMsg=function(){var t=this.collection.map(function(t){var e=new h({model:t});return e.pipe(this.eventOutput),e}.bind(this));this.scrollview.sequenceFrom(t),t.unshift(this.emptySurface),setTimeout(function(){this.emptySurfaceResize()}.bind(this),100),setTimeout(function(){this.scrollview.scrollToEnd()}.bind(this),100)},n.prototype.addChat=function(){if(""!=document.getElementsByClassName("input-msg")[0].value){var t=document.getElementsByClassName("input-msg")[0].value;document.getElementsByClassName("input-msg")[0].value="",this.inputSourceLocal?this.addLocal(t):this.addRemote(t)}},n.prototype.addRemote=function(t){var e={content:t,source:"remote",type:"text",time:Date.now()};this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0),this.collection.add(e)},n.prototype.addLocal=function(t){var e={content:t,source:"local",type:"text",time:Date.now()};this.collection.add(e),this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0),this.eventOutput.emit("outgoingChat",e)},n.prototype.makeEmptySurface=function(t,e){var i=new a({size:[void 0,e-t],properties:{background:"transparent"}});return i},n.prototype.emptySurfaceResize=function(){if(!r.isMobile()){var t=this.scrollview.node.array.map(function(t){return t.getSize()[1]});t.shift();var e=_.reduce(t,function(t,e){return t+e},0),i=this.scrollview.getSize()[1]-e;0>i&&(i=0),this.emptySurface.setSize([void 0,i])}},n.prototype.toggleMenuToggleButton=function(t){t===!0?($(".menu-toggle-button").addClass("fade"),$(".menu-end-button").removeClass("toShow"),$(".input-msg").removeClass("short"),this.contentLightBox.hide(),this.BlueMenuToggleButton=!1):($(".menu-toggle-button").removeClass("fade"),$(".menu-end-button").addClass("toShow"),$(".input-msg").addClass("short"),this.contentLightBox._showing||this.contentLightBox.show(this.scrollview),this.BlueMenuToggleButton=!0)
},i.exports=n}),define("views/call/ConnectedCallView",["require","exports","module","famous/View","famous/Matrix","famous/Surface","famous/EventHandler","app/custom/LightBox","app/custom/Templates","famous-animation/Easing","views/conversation/ConversationView","app/models/Call"],function(t,e,i){function n(t){o.call(this),this.collection=t.collection,this.backSurface=new r({size:[void 0,void 0],properties:{backgroundColor:"transparent",zIndex:-1}}),this.footerLightBox=new u({inTransform:s.identity,inTransition:{duration:f,curve:h.inQuadNorm()},inOpacity:0,inOrigin:[.5,.9],outTransform:s.identity,outOpacity:0,outOrigin:[.5,.9],outTransition:{duration:f,curve:h.outQuadNorm()},showTransform:s.identity,showOpacity:1,showOrigin:[.5,.9]}),this.conversationLightBox=new u({inTransform:s.identity,inTransition:{duration:f,curve:h.inQuadNorm()},inOpacity:0,inOrigin:[.5,.9],outTransform:s.identity,outOpacity:0,outOrigin:[.5,.9],outTransition:{duration:f,curve:h.outQuadNorm()},showTransform:s.identity,showOpacity:1,showOrigin:[.5,.9]}),this.eventInput=new a,a.setInputHandler(this,this.eventInput),this.eventOutput=new a,a.setOutputHandler(this,this.eventOutput),this.footer=new r({classes:["connected-call-view-buttons"],size:[void 0,80],properties:{backgroundColor:"transparent",zIndex:3,opacity:0}}),this._add(this.backSurface),this._add(this.footerLightBox),this._add(this.conversationLightBox),this.footer.on("click",function(t){var e=$(t.target);e.hasClass("end-button")?this.stop(e):e.hasClass("sync-button")&&(this.eventOutput.emit("sync"),$(".sync-button").removeClass("synced").addClass("syncing"))}.bind(this)),this.eventOutput.on("menu-toggle-button",this.onMenuToggleButton),this.eventOutput.on("end-call",this.stop)}var o=t("famous/View"),s=t("famous/Matrix"),r=t("famous/Surface"),a=t("famous/EventHandler"),u=t("app/custom/LightBox"),c=t("app/custom/Templates"),h=t("famous-animation/Easing"),l=t("views/conversation/ConversationView"),p=t("app/models/Call"),f=500;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.start=function(t){this.conversationView=new l,this.conversationView.pipe(this.eventOutput),this.eventInput.pipe(this.conversationView),this.conversationLightBox.show(this.conversationView),this.model=this.collection.models[0]||new p,this.appSettings=t,$(".camera").removeClass("blur");var e=c.toggleButton({id:"video",classes:["video-button","big-button"],checked:this.appSettings?this.appSettings.get("video"):!0,onContent:'<i class="fa fa-eye fa-lg on"></i>',offContent:'<i class="fa fa-eye-slash fa-lg off"></i>',onBackgroundColor:"#dadbd9",offBackgroundColor:"#dadbd9",size:[70,70]}),i=(c.button({classes:["sync-button","big-button"],content:'<i class="sync-button fa fa-refresh fa-2x"></i>',size:[40,40]}),c.button({classes:["end-button","big-button"],content:"End",size:[160,70]})),n=c.toggleButton({id:"audio",classes:["audio-button","big-button"],checked:this.appSettings?this.appSettings.get("audio"):!0,onContent:'<i class="fa fa-microphone fa-lg on"></i>',offContent:'<i class="fa fa-microphone-slash fa-lg off"></i>',onBackgroundColor:"#dadbd9",offBackgroundColor:"#dadbd9",size:[70,70]}),o='<div class="box">'+e+i+n+"</div>";this.footer.setContent(o),this.footerLightBox.show(this.footer)},n.prototype.stop=function(t){t&&t.addClass("exiting"),this.conversationLightBox.hide(),this.footerLightBox.hide(),setTimeout(function(){this.eventOutput.emit("showApp",function(){t&&t.removeClass("exiting")})}.bind(this),f),t&&(this.eventOutput.emit("outgoingCallEnd",this.model),this.eventOutput.emit("incomingCallEnd",this.model))},n.prototype.onMenuToggleButton=function(t){t===!0?this.footerLightBox.hide():this.footerLightBox.show(this.footer)},i.exports=n}),define("views/favorite/FavoriteItemView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous/Modifier","famous/Matrix"],function(t,e,i){function n(t){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.surface=new s({classes:["contact-item","editable"],size:[void 0,51]}),this.surface.on("click",function(t){var e=$(t.target);e.hasClass("delete-button")?this.model.toggleFavorite():$("body").hasClass("editing")?this.eventOutput.emit("editContact",this.model):this.eventOutput.emit("outgoingCall",this.model)}.bind(this)),this.template(),this.surface.pipe(this.eventOutput),this.mod=new u({transform:void 0}),this._link(this.mod),this._link(this.surface)}{var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates")),u=t("famous/Modifier");t("famous/Matrix")}n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t,e="";this.model.get("firstname")||this.model.get("lastname")?(t=this.model.get("firstname")+" <b>"+this.model.get("lastname")+"</b>",this.model.get("firstname")&&(e=this.model.get("firstname")[0]),this.model.get("lastname")&&(e+=this.model.get("lastname")[0])):(t=this.model.get("email"),t&&(e=t[0]));var i='<div class="source"><div class="initial">'+e+"</div>"+t+"</div>";i=a.deleteButton()+i,this.surface.setContent(i)},n.prototype.collapse=function(t){this.mod.setOpacity(0,{duration:600},t)},n.prototype.getSize=function(){var t=this.mod.opacityState.get(),e=this.surface.getSize();return e[1]=Math.floor(e[1]*t),e},i.exports=n}),define("views/favorite/FavoritesSectionView",["require","exports","module","famous/View","famous/Utility","famous/Surface","famous-views/Scrollview","views/favorite/FavoriteItemView"],function(t,e,n){function o(t){s.call(this),this.title='<button class="left edit-button" id="edit-contact"></button><div>Favorites</div>',this.navigation={caption:"Favorites",icon:'<i class="fa fa-star"></i>'},this.collection=t.collection,this.scrollview=new u({classes:["favorites-scrollview"],direction:r.Direction.Y,margin:1e4}),this.pipe(this.scrollview),this._link(this.scrollview),this.collection.on("all",function(t){switch(t){case"change:favorite":case"remove":this.curIndex=this.scrollview.getCurrentNode().index,this.curPosition=this.scrollview.getPosition(),this.loadFavorites(),this.scrollTo(this.curIndex,this.curPosition);break;case"sync":this.loadFavorites()}}.bind(this))}var s=t("famous/View"),r=t("famous/Utility"),a=t("famous/Surface"),u=t("famous-views/Scrollview"),c=t("views/favorite/FavoriteItemView");o.prototype=Object.create(s.prototype),o.prototype.constructor=o,o.prototype.loadFavorites=function(){var t=this.collection.favorites(),e=t.map(function(t){var e=new c({model:t});return e.pipe(this.eventOutput),e}.bind(this)),n=this.scrollview.getSize()[1]+40;for(i=0;i<e.length&&(n-=e[i].getSize()[1],!(0>=n));i++);if(n>0){var o=new a({size:[void 0,n]});o.pipe(this.eventOutput),e.push(o)}this.scrollview.sequenceFrom(e)},o.prototype.removeContact=function(t){if(this.scrollview.node){var e=this.scrollview.node.array[t];e.collapse(function(){this.scrollview.node.splice(t,1)}.bind(this))}},o.prototype.scrollTo=function(t,e){t||(t=0),e||(e=0),this.scrollview.setVelocity(0),this.scrollview.setPosition(e),this.scrollview.node.index=t},n.exports=o}),define("views/recent/RecentItemView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous-utils/TimeAgo","famous/Modifier","famous/Matrix"],function(t,e,i){function n(t){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.surface=new s({classes:["contact-item","recent-item","editable"],size:[void 0,51]}),this.surface.on("click",function(t){var e=$(t.target);e.hasClass("delete-button")?this.model.destroy():$("body").hasClass("editing")?this.eventOutput.emit("editContact",this.model):this.eventOutput.emit("outgoingCall",this.model)}.bind(this)),this.template(),this.surface.pipe(this.eventOutput),this.mod=new c({transform:void 0}),this._link(this.mod),this._link(this.surface),this.model.on("all",function(t){switch(t){case"change":this.template()}}.bind(this))}{var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates")),u=t("famous-utils/TimeAgo"),c=t("famous/Modifier");t("famous/Matrix")}n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t;t=this.model.get("firstname")||this.model.get("lastname")?this.model.get("firstname")+" <b>"+this.model.get("lastname")+"</b>":this.model.get("email");var e="",i="";"outgoing"==this.model.get("type")?e='<i class="fa fa-sign-out"></i>':this.model.get("success")||(i="missed");var n='<div class="source '+i+'"><div class="call-type">'+e+"</div>"+t;n+='<div class="call-time">'+u.parse(this.model.get("time"))+" ago</div></div>",n=a.deleteButton()+n,this.surface.setContent(n)},n.prototype.collapse=function(t){this.mod.setOpacity(0,{duration:600},t)},n.prototype.getSize=function(){var t=this.mod.opacityState.get(),e=this.surface.getSize();return e[1]=Math.floor(e[1]*t),e},i.exports=n}),define("views/recent/RecentsSectionView",["require","exports","module","famous/View","famous/Utility","famous/Surface","famous-views/Scrollview","views/recent/RecentItemView","app/custom/Templates","famous/Engine"],function(t,e,i){function n(t){o.call(this),this.missedOnly=!1,this.title='<button class="left clear-button" id="clear-button"></button>',this.title+=c.recentsToggle(),this.title+='<button class="right edit-button" id="edit-contact"></button>',this.navigation={caption:"Recents",icon:'<i class="fa fa-clock-o"></i>'},this.collection=t.collection,this.scrollview=new a({direction:s.Direction.Y,margin:1e4}),this.pipe(this.scrollview),this._link(this.scrollview),this.collection.on("all",function(t,e,i,n){switch(t){case"remove":var o=this.curCollection.indexOf(e);0>o&&(o=n.index),this.removeContact(o);break;case"add":this.loadContacts()}}.bind(this)),this.collection.fetch()}var o=t("famous/View"),s=t("famous/Utility"),r=t("famous/Surface"),a=t("famous-views/Scrollview"),u=t("views/recent/RecentItemView"),c=t("app/custom/Templates"),h=t("famous/Engine");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.loadContacts=function(){if(this.scrollview.setPosition(0),this.missedOnly)var t=this.collection.missed();else var t=this.collection;this.curCollection=t;for(var e=this.curCollection.map(function(t){var e=new u({model:t});return e.pipe(this.eventOutput),e}.bind(this)),i=this.scrollview.getSize()[1]+40,n=0;n<e.length&&(i-=e[n].getSize()[1],!(0>i));n++);if(i>0){var o=new r({size:[void 0,i]});o.pipe(this.eventOutput),e.push(o)}this.scrollview.sequenceFrom(e)},n.prototype.removeContact=function(t){if(this.missedOnly)var e=this.collection.missed();else var e=this.collection;if(this.curCollection=e,this.scrollview.node){var i=this.scrollview.node.array[t];i.collapse(function(){h.defer(function(t){this.scrollview.node.splice(t,1)}.bind(this,t))}.bind(this))}},n.prototype.clearContact=function(){_.invoke(this.collection.all(),"destroy")},n.prototype.setMissOnly=function(t){this.missedOnly="missed"==t},i.exports=n}),define("views/contact/ContactItemView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous/Modifier","famous/Matrix"],function(t,e,i){function n(t,e){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput);var i=51;e&&(i=77),this.surface=new s({classes:["contact-item","editable"],size:[void 0,i]}),this.surface.on("click",function(t){var e=$(t.target);e.hasClass("delete-button")?this.model.collection.remove(this.model):e.hasClass("favorite-button")?this.model.toggleFavorite():e.hasClass("first-char")||($("body").hasClass("editing")?this.eventOutput.emit("editContact",this.model):this.eventOutput.emit("outgoingCall",this.model))}.bind(this)),this.template(e),this.surface.pipe(this.eventOutput),this.mod=new u({transform:void 0}),this._link(this.mod),this._link(this.surface),this.model.on("all",function(t){switch(t){case"change:favorite":$(this.surface._currTarget).find(".favorite-button").toggleClass("active")}}.bind(this))}{var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates")),u=t("famous/Modifier");t("famous/Matrix")}n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(t){var e,i;this.model.get("firstname")||this.model.get("lastname")?(e=this.model.get("firstname")+" <b>"+this.model.get("lastname")+"</b>",i=this.model.get("firstname")[0]+this.model.get("lastname")[0]):e=this.model.get("email");var n='<div class="source">'+e;n=a.deleteButton()+a.favoriteButton(this.model.get("favorite"))+n,t&&(n='<div class="first-char">'+t+"</div>"+n),this.model.attributes.email&&(n+='<i class="fa fa-envelope contact-icon"></i>'),this.model.attributes.facebook&&(n+='<i class="fa fa-facebook-square contact-icon"></i>'),this.model.attributes.google&&(n+='<i class="fa fa-google-plus-square contact-icon"></i>'),n+="</div>",this.surface.setContent(n)},i.exports=n}),define("famous/ContainerSurface",["require","exports","module","./Surface","./Context"],function(t,e,i){function n(t){o.call(this,t),this._container=document.createElement("div"),this._container.classList.add("group"),this._container.style.width="100%",this._container.style.height="100%",this._container.style.position="relative",this._shouldRecalculateSize=!1,this.context=new s(this._container),this.setContent(this._container)}var o=t("./Surface"),s=t("./Context");n.prototype=Object.create(o.prototype),n.prototype.elementType="div",n.prototype.elementClass="surface",n.prototype.link=function(){return this.context.link.apply(this.context,arguments)},n.prototype.add=function(){return this.context.add.apply(this.context,arguments)},n.prototype.mod=function(){return this.context.mod.apply(this.context,arguments)},n.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),o.prototype.render.call(this)},n.prototype.commit=function(){var t=o.prototype.commit.apply(this,arguments);return this._shouldRecalculateSize&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),t},i.exports=n}),define("views/contact/ContactsSectionView",["require","exports","module","famous/View","famous/Utility","app/custom/Surface","famous-views/Scrollview","views/contact/ContactItemView","famous/Matrix","famous-views/HeaderFooterLayout","famous/Utility","famous/ContainerSurface","famous/Modifier","famous/Engine","app/custom/TouchSync","famous-sync/GenericSync"],function(t,e,i){function n(t){o.call(this),this.searchBarSize=50,this.abcSurfaceWidth=30,this.abcSurfaceHeight=void 0,this.a2zString="ABCDEFGHIJKLMNOPQRSTUVWXYZ#",this.headerFooterLayout=new c({headerSize:this.searchBarSize,footerSize:0}),this.searchSurface=new r({size:[void 0,this.searchBarSize],classes:["contact-section-search-bar"],content:'<div><i class="fa fa-search"></i>   <input type="text" class="search-contact" placeholder = "Search" ></div></div>',properties:{backgroundColor:"rgba(15,15,15,0.9)",color:"white",zIndex:2}}),this.abcSurface=new r({size:[this.abcSurfaceWidth,this.abcSurfaceHeight],classes:["abcButton"],content:'<button id="A">A</button><button id="B">B</button><button id="C">C</button><button id="D">D</button><button id="E">E</button><button id="F">F</button><button id="G">G</button><button id="H">H</button><button id="I">I</button><button id="J">J</button><button id="K">K</button><button id="L">L</button><button id="M">M</button><button id="N">N</button><button id="O">O</button><button id="P">P</button><button id="Q">Q</button><button id="R">R</button><button id="S">S</button><button id="T">T</button><button id="U">U</button><button id="V">V</button><button id="W">W</button><button id="X">X</button><button id="Y">Y</button><button id="Z">Z</button><button id="#">#</button>',properties:{backgroundColor:"rgba(160,160,160,0.0)",zIndex:2}}),this.abcMod=new h({origin:[1,0]}),this.title='<button class="left edit-button" id="edit-contact"></button><div>All Contacts</div><button class="right add-contact" id="add-contact"><i class="fa fa-plus" id="add-contact"></i></button>',this.navigation={caption:"Contacts",icon:'<i class="fa fa-users"></i>'},this.collection=t.collection,this.scrollview=new a({direction:s.Direction.Y,margin:1e4}),this.headerFooterLayout.id.header.link(this.searchSurface),this.headerFooterLayout.id.content.add(this.scrollview),this.headerFooterLayout.id.content.add(this.abcMod).link(this.abcSurface),this.pipe(this.scrollview),this._add(this.headerFooterLayout),this.collection.on("all",function(t){switch(t){case"remove":this.curIndex=this.scrollview.getCurrentNode().index,this.curPosition=this.scrollview.getPosition(),this.loadContacts(),this.scrollTo(this.curIndex,this.curPosition);break;case"sync":this.loadContacts()}}.bind(this)),this.abcSurface.on("mousemove",function(t){this.onAbcTouch(t)}.bind(this));var e=[0,0],i=new p(function(){return e},{syncClasses:[l]});this.abcSurface.pipe(i),i.on("update",function(t){var e=document.elementFromPoint(t.ap[0],t.ap[1]);if(void 0!=e.id&&""!=e.id){var i=this.a2zString.indexOf(e.id);i=this.a2zIndexArray[i],void 0!=i&&i!=this.curAbcIndex&&(this.curAbcIndex=i,this.scrollTo(i))}}.bind(this)),this.searchSurface.on("keyup",function(t){this.loadContacts(t.target.value)}.bind(this))}var o=t("famous/View"),s=t("famous/Utility"),r=t("app/custom/Surface"),a=t("famous-views/Scrollview"),u=t("views/contact/ContactItemView"),c=(t("famous/Matrix"),t("famous-views/HeaderFooterLayout")),h=(t("famous/Utility"),t("famous/ContainerSurface"),t("famous/Modifier")),l=(t("famous/Engine"),t("app/custom/TouchSync")),p=t("famous-sync/GenericSync");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.scrollTo=function(t,e){0>t||(this.scrollview.setVelocity(0),this.scrollview.node.index=t,e||(e=0),this.scrollview.setPosition(e))},n.prototype.loadContacts=function(t){this.currentCollection=t?this.collection.searchContact(t.toUpperCase()):this.collection,this.firstChar=void 0,this.a2zIndexArray=[0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],this.currentCollection;for(var e=this.currentCollection.map(function(t){return this.getIndex(t)}.bind(this));-1!=this.a2zIndexArray.indexOf(-1);)this.a2zIndexArray[this.a2zIndexArray.indexOf(-1)]=this.a2zIndexArray[this.a2zIndexArray.indexOf(-1)-1];for(var i=_.last(this.a2zIndexArray),n=this.scrollview.getSize()[1]+40,o=i;o<e.length;o++)n-=e[o].getSize()[1];if(n>0){var s=new r({size:[void 0,n]});if(e.push(s),s.pipe(this.eventOutput),0==this.collection.length){var a='<div class="firstAdd"><div> <i class="fa fa-plus fa-5x" ></i> </div> <div> Your contact list is empty,</div><div> Please add your first contact</div></div>';s.setContent(a),s.on("click",function(t){$(t.target).hasClass("fa-plus")&&this.eventOutput.emit("editContact")}.bind(this))}else if(0==this.currentCollection.length){var u='<div class="no-match-found"><div> No match found</div></div>';s.setContent(u)}}this.scrollview.sequenceFrom(e)},n.prototype.removeContact=function(t){if(this.scrollview.node){var e=this.scrollview.node.array[t];e.collapse(function(){this.scrollview.node.splice(t,1)}.bind(this))}},n.prototype.getCurrentIndex=function(t){var e=this.currentCollection.indexOf(t);this.a2zIndexArray[this.a2zString.indexOf(this.firstChar)]=e},n.prototype.getIndex=function(t){var e=!1;/^[a-zA-Z]+$/.test(t.get("lastname")[0])?t.get("lastname")&&this.firstChar!=t.get("lastname")[0].toUpperCase()&&(this.firstChar=t.get("lastname")[0].toUpperCase(),e=this.firstChar,this.getCurrentIndex(t)):"#"!=this.firstChar&&(this.firstChar="#",e="#",this.getCurrentIndex(t));var i=new u({model:t},e);return i.pipe(this.eventOutput),i},n.prototype.onAbcTouch=function(t){this.abcButtons||(this.abcButtons=$(".abcButton button"));var e=this.abcButtons.indexOf(t.target);e=this.a2zIndexArray[e],void 0!=e&&e!=this.curAbcIndex&&(this.curAbcIndex=e,this.scrollTo(e))},i.exports=n}),define("views/setting/SettingsSectionView",["require","exports","module","famous/View","famous/Utility","famous/Surface","famous-views/Scrollview","app/custom/Templates","famous-utils/Utils","notify"],function(t,e,i){function n(t){function e(){f.show()}function i(){this.appSettings.get("notification")&&(alert("Unblock notification for beepe.me:443 in chrome://settings/contentExceptions#notifications"),this.appSettings.set("notification",!1),$("#notification").prop("checked",!1))}function n(){this.template()}function u(){console.log("camera change"),this.eventOutput.emit("setCamera")}function c(){console.log("audio change"),this.eventOutput.emit("setAudio")}function l(){console.log("video change"),this.eventOutput.emit("setVideo")}function p(){console.log("blur change"),this.eventOutput.emit("setBlur")}o.call(this),this.appSettings=t.model,this.title="<div>Settings</div>",this.navigation={caption:"Settings",icon:'<i class="fa fa-gear"></i>'},this.scrollview=new a({direction:s.Direction.Y,margin:1e4}),this.pipe(this.scrollview),this.surface=new r({properties:{padding:"20px"},size:[void 0,700]}),this.template(),this.surface.pipe(this.eventOutput),this.scrollview.sequenceFrom([this.surface]),this._link(this.scrollview);var f=new h("Settings",{body:"Notification is on.",tag:"notificationSettings",permissionGranted:e.bind(this),permissionDenied:i.bind(this)});$(document).on("click","#notification",function(){this.appSettings.save({notification:JSON.parse($("#notification").prop("checked"))}),this.appSettings.get("notification")&&(f.needsPermission()?f.requestPermission():f.show())}.bind(this)),this.surface.on("click",function(t){switch(t.target.id){case"camera":this.appSettings.save({camera:JSON.parse($("#camera").prop("checked"))});break;case"video":this.appSettings.save({video:JSON.parse($("#video").prop("checked"))});break;case"audio":this.appSettings.save({audio:JSON.parse($("#audio").prop("checked"))});break;case"blur":this.appSettings.save({blur:JSON.parse($("#blur").prop("checked"))});break;case"facebook":JSON.parse($("#facebook").prop("checked"))?this.eventOutput.emit("onSocialLink",t.target.id):window.location="/disconnect/facebook";break;case"google":JSON.parse($("#google").prop("checked"))?this.eventOutput.emit("onSocialLink",t.target.id):window.location="/disconnect/google";break;case"linkedin":case"github":case"yammer":alert("Coming Soon.")}}.bind(this)),this.surface.on("click",function(t){switch(t.target.className){case"connected-button":this.eventOutput.emit("connectedCall");break;case"conversations-button":this.eventOutput.emit("conversations");break;case"logout-button":window.location="/logout"}}.bind(this)),this.appSettings.on({"change:camera":u.bind(this),"change:audio":c.bind(this),"change:video":l.bind(this),"change:blur":p.bind(this),change:n.bind(this)})}var o=t("famous/View"),s=t("famous/Utility"),r=t("famous/Surface"),a=t("famous-views/Scrollview"),u=t("app/custom/Templates"),c=t("famous-utils/Utils"),h=t("notify");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t='<div class="box">';t+='<div class="info">'+this.appSettings.get("firstname")+" "+this.appSettings.get("lastname"),t+='<button class="logout-button">Log Out</button></div>',t+='<div class="desc"></div>',t+='<div class="info">ID: '+this.appSettings.get("username")+"</div>",t+='<div class="desc"></div>',t+='<div class="info">Camera ',t+=u.toggleSwitch("camera",this.appSettings.get("camera"))+"</div>",t+='<div class="info">Blur ',t+=u.toggleSwitch("blur",this.appSettings.get("blur"))+"</div>",c.isMobile()||(t+='<div class="info">Notification ',t+=u.toggleSwitch("notification",this.appSettings.get("notification"))+"</div>"),t+='<div class="desc">YOU CAN BE REACHED AT</div>',t+='<div class="info">Facebook ',t+=u.toggleSwitch("facebook",this.appSettings.get("linkAccounts").facebook)+"</div>",t+='<div class="info">Google ',t+=u.toggleSwitch("google",this.appSettings.get("linkAccounts").google)+"</div>",t+='<div class="info">Linkedin ',t+=u.toggleSwitch("linkedin",this.appSettings.get("linkAccounts").linkedin)+"</div>",t+='<div class="info">Github ',t+=u.toggleSwitch("github",this.appSettings.get("linkAccounts").github)+"</div>",t+='<div class="info">Yammer ',t+=u.toggleSwitch("yammer",this.appSettings.get("linkAccounts").yammer)+"</div>",t+="</div>",this.surface.setContent(t)},i.exports=n}),define("views/AlertView",["require","exports","module","famous/View","famous/Surface","famous/EventHandler","app/custom/LightBox","famous/Modifier","famous/Matrix","famous-animation/Easing"],function(t,e,i){function n(t){o.call(this),this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.options={inTransform:u.identity,outTransform:u.identity,showTransform:u.identity,inTransition:{duration:100},outTransition:{duration:100},overlap:!0},this.bigSurface=new s({size:[void 0,void 0],properties:{background:"rgba(0,0,0,0.5)",zIndex:1e3}}),this.alertSurface=new s({classes:["alert"],size:[340,220],properties:{borderRadius:"10px",background:"rgba(59, 59, 59, 0.90)",color:"rgba(245, 236, 236,1)",zIndex:1001}}),this.alertLightBox=new a({inTransform:u.identity,inOpacity:.1,inOrigin:[.5,.45],outTransform:u.scale(.001,.001,.001),outOpacity:1,outOrigin:[.5,.45],showTransform:u.identity,showOpacity:1,showOrigin:[.5,.45],inTransition:{duration:200,curve:c.inQuadNorm()},outTransition:{duration:100,curve:c.outQuintNorm()}}),this.setAlertMessage(t),this._add(this.bigSurface),this._add(this.alertLightBox),this.alertLightBox.show(this.alertSurface)}var o=t("famous/View"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=t("app/custom/LightBox"),u=(t("famous/Modifier"),t("famous/Matrix")),c=t("famous-animation/Easing");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.setAlertMessage=function(t){var e='<div class="alert-title"><b>Info</b></div><div id="message">'+t+'</div> <div id="close-alert"> OK </div>';this.alertSurface.setContent(e)},i.exports=n}),define("app/config",["require","exports","module","famous/Utility"],function(t,e,i){var n=t("famous/Utility");i.exports={debug:!1,header:{look:{classes:["header"],size:[void 0,50],side:"top"},feel:{inTransition:{method:"wall",period:300,dampingRatio:0,restitution:.2},outTransition:{method:"spring",period:300,dampingRatio:.5,velocity:0},overlap:!0}},navigation:{look:{side:"bottom",direction:n.Direction.X,size:[void 0,50],onClasses:["navigation","on"],offClasses:["navigation","off"]},feel:{inTransition:{curve:"easeInOut",duration:150},outTransition:{curve:"easeInOut",duration:150}}},content:{feel:{inTransition:{method:"spring",period:1e3,dampingRatio:.5,velocity:0},outTransition:{method:"spring",period:600,dampingRatio:.5,velocity:0},overlap:!0}}}}),define("app/MainController",["require","exports","module","famous/Engine","app/custom/LightBox","famous/Surface","famous-animation/Easing","famous/EventHandler","famous-utils/Utils","app/models/Contact","app/models/Call","app/models/CallCollection","app/models/Settings","app/models/ContactCollection","views/CameraView","views/contact/AddContactView","views/call/OutgoingCallView","views/call/IncomingCallView","views/call/ConnectedCallView","views/favorite/FavoritesSectionView","views/recent/RecentsSectionView","views/contact/ContactsSectionView","views/setting/SettingsSectionView","views/AlertView","app/config","app/App","notify"],function(t,e,i){function n(){this.eventInput=new p,p.setInputHandler(this,this.eventInput),this.eventOutput=new p,p.setOutputHandler(this,this.eventOutput),this.loadUser(function(t){function e(){}function i(){}function n(t){L.setMissOnly(t.target.outerText),L.loadContacts()}function o(){L.clearContact(),L.loadContacts()}function s(t){var e;t instanceof Function&&(e=t),$(".camera").addClass("blur"),V.show(j,!0,e)}function r(){W.accept()}function a(t){var e;t instanceof Function&&(e=t),Y.start(this.appSettings),V.show(Y,!0,e),this.eventOutput.emit("chatOn"),this.localStream||alert("Please allow camera/microphone access for Beepe")}function u(t){W.start(t,this.appSettings),V.show(W,!0)}function c(t){function e(){}function i(){parent.focus()}function n(){parent.focus()}if(this.appSettings.get("notification")){var o=new A("Incoming Call From",{icon:"famous-time/content/ios_icon_x144.png",body:t.get("firstname")+" "+t.get("lastname"),notifyShow:e.bind(this),notifyClose:i.bind(this),notifyClick:n.bind(this)});o.show()}var s=V.nodes[0].get();s instanceof S||s instanceof x||s instanceof C||(X.start(t),V.show(X,!0))}function p(){this.eventOutput.emit("chatOff");var t=V.nodes[0].object;(t instanceof x||t instanceof C)&&t.stop()}function f(t){t instanceof d||t instanceof m?q.setContact(t):q.setContact(void 0),q.renderContact(),V.show(q,!0)}function _(){J.turnOn()}function F(){J.turnOff()}function P(t){switch(t.target.id){case"clear-button":this.eventOutput.emit("clearRecent");break;case"add-contact":this.eventOutput.emit("editContact");break;case"edit-contact":$("body").toggleClass("editing");break;case"recent-toggle":this.eventOutput.emit("loadRecent",t);break;case"close-alert":this.eventOutput.emit("closeAlert")}}function R(t){var e=new I(t);U.show(e,!0)}function N(){U.hide()}this.appSettings=new g({id:t.objectId}),this.appSettings.fetch(),this.appSettings.save({cid:t.objectId,email:t.email,firstname:t.firstname,lastname:t.lastname,username:t.username}),this.appSettings.me=t,this.appSettings=this.appSettings,this.init(),this.contactCollection=new y([],{firebase:this.appSettings.get("userDatabaseUrl")+this.appSettings.get("cid")+"/contacts"}),this.recentCalls=new v,this.curCall=new m;var D=new O({collection:this.contactCollection}),L=new T({collection:this.recentCalls}),B=new k({collection:this.contactCollection}),H=new E({model:this.appSettings});D.pipe(this.eventOutput),L.pipe(this.eventOutput),B.pipe(this.eventOutput),H.pipe(this.eventOutput),M.sections=[D,L,B,H];var j=new z(M),V=new l({overlap:!0}),U=new l({overlap:!0}),q=new w({collection:this.contactCollection}),W=new S({collection:this.recentCalls}),X=new x({collection:this.recentCalls}),Y=new C({collection:this.recentCalls});j.pipe(this.eventOutput),W.pipe(this.eventOutput),X.pipe(this.eventOutput),Y.pipe(this.eventOutput),this.pipe(Y.eventInput),q.pipe(this.eventOutput);var J=new b({}),G=h.createContext();G.add(J),G.add(V),G.add(U),V.show(j),h.pipe(j),j.select(j.options.sections[2].title),this.eventOutput.on("callEnd",p),this.eventOutput.on("incomingCall",c),this.eventOutput.on("outgoingCall",u),this.eventOutput.on("connectedCall",a),this.eventOutput.on("outGoingCallAccept",r),this.eventOutput.on("editContact",f),this.eventOutput.on("showApp",s),this.eventOutput.on("chatOn",_),this.eventOutput.on("chatOff",F),this.eventOutput.on("loadRecent",n),this.eventOutput.on("clearRecent",o),this.eventOutput.on("onEngineClick",P),this.eventOutput.on("closeAlert",N),this.eventOutput.on("editContactDone",e),this.eventOutput.on("addContactDone",i),h.on("click",P.bind(this)),$("body").on("click","input",function(t){$(t.target).focus()}),alert=R}.bind(this))}function o(t,e,i){$.ajax({url:"/finduser",type:"get",dataType:"json",data:{provider:e,externalId:t},success:function(t){i(t)},error:function(){console.log("error"),i(new m)}})}function s(t,e){$.ajax({url:"/findusers",type:"get",dataType:"json",data:{query:t},success:function(t){e(t)},error:function(){console.log("error"),e(new m)}})}function r(t,e){if(!f.isMobile()&&window.colabeoBody){var i=new CustomEvent("FromKoala",{detail:{type:t,data:e}});window.colabeoBody.dispatchEvent(i)}}function a(){this.remoteUrl==this.localUrl?$(".sync-button").removeClass("syncing").addClass("synced"):$(".sync-button").removeClass("synced syncing")
}function u(t){if("updateUrl"==t.detail.action&&("remote"==t.detail.source?this.remoteUrl=t.detail.url:this.localUrl=t.detail.url,a.bind(this)()),!this.disableNow)if("incoming"==t.detail.action){var e=new m({firstname:t.detail.firstname,lastname:t.detail.lastname,email:t.detail.email,pictureUrl:null,roomId:t.detail.room});this.eventOutput.emit("incomingCall",e)}else this.conn&&this.conn.send(t.detail)}function c(t){this.disableNow=!0,setTimeout(function(){this.disableNow=!1}.bind(this),1e3);var e=t;"chat"==e.action?this.eventOutput.emit("incomingChat",e):(f.isMobile()&&e.data&&e.data.url&&"urlChange"==e.data.action&&window.open(e.data.url),r("event",e))}var h=t("famous/Engine"),l=t("app/custom/LightBox"),p=(t("famous/Surface"),t("famous-animation/Easing"),t("famous/EventHandler")),f=t("famous-utils/Utils"),d=t("app/models/Contact"),m=t("app/models/Call"),v=t("app/models/CallCollection"),g=t("app/models/Settings"),y=t("app/models/ContactCollection"),b=t("views/CameraView"),w=t("views/contact/AddContactView"),S=t("views/call/OutgoingCallView"),x=t("views/call/IncomingCallView"),C=t("views/call/ConnectedCallView"),O=t("views/favorite/FavoritesSectionView"),T=t("views/recent/RecentsSectionView"),k=t("views/contact/ContactsSectionView"),E=t("views/setting/SettingsSectionView"),I=t("views/AlertView"),M=t("app/config"),z=t("app/App"),A=t("notify"),F={iceServers:[{url:"stun:stun.l.google.com:19302"}]};n.prototype.init=function(){this.iceServerConfig=F,this.getXirsys(),this.disableNow=!1;var t=this.appSettings.get("cid"),e=this.appSettings.get("firstname")+" "+this.appSettings.get("lastname");this.listenRef=new Firebase(this.appSettings.get("callDatabaseUrl")+t),this.listenRef.onDisconnect().remove(),f.isMobile()?($("body").addClass("mobile"),void 0==this.appSettings.get("blur")&&this.appSettings.set("blur",!1)):void 0==this.appSettings.get("blur")&&this.appSettings.set("blur",!0),this.setupCallListener(),this.setupVideo(),this.setupSettingsListener(),this.loadConnected(function(t){if(t&&Array.isArray(t)){var e={};t.map(function(t){e[t.provider]=!0}),this.appSettings.save({linkAccounts:e})}}.bind(this)),util.supports.sctp=!1,r("event",{data:{action:"syncID",id:t,name:e}}),window.colabeoBody&&window.colabeoBody.addEventListener("FromExtension",u.bind(this))},n.prototype.setupSettingsListener=function(){this.eventOutput.on("outgoingChat",function(t){this.sendChat(t.content,t.type)}.bind(this)),this.eventOutput.on("setCamera",function(){this.setCamera()}.bind(this)),this.eventOutput.on("setVideo",function(){this.setVideo()}.bind(this)),this.eventOutput.on("setBlur",function(){this.setBlur()}.bind(this)),this.eventOutput.on("setAudio",function(){this.setAudio()}.bind(this)),this.eventOutput.on("onSocialLink",function(t){var e;"facebook"==t?e="/connect/facebook/email":"google"==t&&(e="/connect/google/profile%20email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fplus.login%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fplus.me"),e&&$.oauthpopup({path:e,callback:function(){setTimeout(function(){$("div.import-contact#"+t+":not(.done)").click().addClass("done")}.bind(this),300)}})}),$("body").on("change","#audio, #video",function(t){this.appSettings.set($(t.target)[0].id,$(t.target).prop("checked"))}.bind(this))},n.prototype.setupCallListener=function(){function t(t){var e=t.val().firstname||t.val().person.split(" ")[0],i=t.val().lastname||t.val().person.split(" ")[1],n=t.val().email,o=t.val().pictureUrl||!1,s=t.val().name,r=t.name(),a=new m({firstname:e,lastname:i,email:n,pictureUrl:o,roomId:r,caller:s});this.eventOutput.emit("incomingCall",a)}function e(){}function i(t){this.eventOutput.emit("callEnd",t),this.exitRoom()}function n(){this.callRef&&this.callRef.remove(),this.exitRoom()}function o(){this.listenRef&&this.listenRef.remove(),this.exitRoom()}function s(t){if(t instanceof m){var e=t.get("caller"),i=this.appSettings.get("cid"),n=t.get("roomId");n&&(this.listenRef.child(n).update({state:"answered"}),this.joinRoom(e,i,n))}}function r(t){this.callByContact(t)}function a(){this.onSyncButton()}this.listenRef.on("child_added",t.bind(this)),this.listenRef.on("child_changed",e.bind(this)),this.listenRef.on("child_removed",i.bind(this)),this.eventOutput.on("outgoingCallEnd",n.bind(this)),this.eventOutput.on("incomingCallEnd",o.bind(this)),this.eventOutput.on("incomingCallAnswer",s.bind(this)),this.eventOutput.on("outgoingCall",r.bind(this)),this.eventOutput.on("sync",a.bind(this))},n.prototype.setupVideo=function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,this.setCamera()},n.prototype.initLocalMedia=function(t){var t=_.extend({audio:!0,video:!0},t);navigator.getUserMedia(t,function(e){$(".local-video video").prop("src",URL.createObjectURL(e)),this.localStream=e,this.cleanRoom(),this.setBlur(),this.setAudio(),t.video?$(".camera").removeClass("off"):$(".camera").addClass("off")}.bind(this),function(){$(".camera").addClass("off")}.bind(this))},n.prototype.initRemoteMedia=function(t){this.existingCall&&this.existingCall.close(),t.on("stream",function(t){$(".remote-video video").prop("src",URL.createObjectURL(t))}.bind(this)),this.existingCall=t,t.on("close",this.cleanRoom.bind(this))},n.prototype.startRoom=function(t,e,i){i&&(i="A"+i+"Z"),this.peer=new Peer(i,{host:this.appSettings.get("pHost"),port:this.appSettings.get("pPort"),secure:this.appSettings.get("pSecure"),config:this.iceServerConfig}),this.peer.on("open",function(){}.bind(this)),this.peer.on("call",function(t){t.answer(this.localStream),this.initRemoteMedia(t),r("event",{data:{action:"setProperty",roomId:i}})}.bind(this)),this.peer.on("connection",function(t){this.setupPeerConn(t)}.bind(this)),this.peer.on("error",function(){}.bind(this))},n.prototype.joinRoom=function(t,e,i){i&&(i="A"+i+"Z"),this.peer=new Peer({host:this.appSettings.get("pHost"),port:this.appSettings.get("pPort"),secure:this.appSettings.get("pSecure"),config:this.iceServerConfig}),setTimeout(function(){var t=this.peer.call(i,this.localStream);this.initRemoteMedia(t),r("event",{data:{action:"setProperty",roomId:i}});var e=this.peer.connect(i,{label:"chat",reliable:!1});this.setupPeerConn(e)}.bind(this),1e3)},n.prototype.getXirsys=function(t){$.post("https://api.xirsys.com/getIceServers",{domain:"dashboard.colabeo.com",room:"default",application:"default",ident:"chapman",secret:"02f0e22c-764e-4939-8042-4ea028e9b8e0",secure:0},function(e){if(e){var i=JSON.parse(e),n=i.d;n&&(this.iceServerConfig={iceServers:F.iceServers.concat(n.iceServers)})}t&&t(iceServer)}.bind(this))},n.prototype.setupPeerConn=function(t){this.conn=t,this.conn.on("open",function(){this.conn.on("data",c.bind(this))}.bind(this))},n.prototype.exitRoom=function(){this.existingCall&&this.existingCall.close(),r("event",{data:{action:"setProperty",roomId:null}}),r("event",{data:{action:"endCall"}}),this.cleanRoom()},n.prototype.cleanRoom=function(){this.peer&&this.peer.destroy(),this.conn&&this.conn.close()},n.prototype.setCamera=function(){this.initLocalMedia({video:this.appSettings.get("camera"),audio:!0})},n.prototype.setBlur=function(){var t=this.appSettings.get("blur");t?$(".camera").removeClass("fakeblur"):$(".camera").addClass("fakeblur")},n.prototype.setAudio=function(){var t=this.appSettings.get("audio");if(this.localStream)for(var e=this.localStream.getAudioTracks(),i=0,n=e.length;n>i;i++)e[i].enabled=t},n.prototype.setVideo=function(){var t=this.appSettings.get("video"),e=this.appSettings.get("camera");if(this.localStream&&e){for(var i=this.localStream.getVideoTracks(),n=0,o=i.length;o>n;n++)i[n].enabled=t;t?$(".camera").removeClass("off"):$(".camera").addClass("off")}},n.prototype.callByContact=function(t){if(!this.localStream)return alert("Please allow camera/microphone access for Beepe"),void 0;var e=[];["email","facebook","google","linkedin","github","yammer"].map(function(i){t.get(i)&&e.push({provider:i,eid:t.get(i).id||t.get(i)})}),e=JSON.stringify(e),s(e,function(t){if(t.length){var e,i=_.last(t);i.user&&i.user.objectId?e=i.user.objectId:i.objectId&&(e=i.objectId),this.callById(e,i.provider)}else alert("The user you are calling is not a beepe user. Invite him to beepe.me.")}.bind(this))},n.prototype.callByContactSingle=function(t){var e=t.get("email"),i="email";t.get("facebook"),o(e,i,function(t){var e=t.callee;if(e){var i=e.objectId;this.callById(i)}else console.log("The user you are calling is not an colabeo user, I don't know what to do.")}.bind(this))},n.prototype.callById=function(t){function e(e){var i=e.val().state;if("answered"==i){var n=this.appSettings.get("cid"),o=t,s=e.name();this.startRoom(n,o,s),this.eventOutput.emit("outGoingCallAccept",function(){})}}function i(t){this.eventOutput.emit("callEnd",t),this.exitRoom()}if(t){this.callRef=new Firebase(this.appSettings.get("callDatabaseUrl")+t),this.callRef.onDisconnect().remove();var n=this.appSettings.get("firstname")+" "+this.appSettings.get("lastname"),o={name:this.appSettings.get("cid"),person:n,firstname:this.appSettings.get("firstname"),lastname:this.appSettings.get("lastname"),state:"calling"};this.appSettings.get("email")&&(o.email=this.appSettings.get("email")),this.appSettings.get("username")&&(o.username=this.appSettings.get("username")),this.callRef.once("value",function(t){null==t.val()?(this.callRef.push(o),this.callRef.once("child_changed",e.bind(this)),this.callRef.once("child_removed",i.bind(this))):delete this.callRef}.bind(this))}},n.prototype.loadUser=function(t){$.ajax({url:"/me",type:"get",dataType:"json",success:function(e){t&&t(e)},error:function(){console.log("error"),t&&t({})}})},n.prototype.loadConnected=function(t){$.ajax({url:"/connected",type:"get",dataType:"json",success:function(e){t&&t(e)},error:function(){console.log("error"),t&&t({})}})},n.prototype.loadContact=function(t,e){$.ajax({url:"/contact/"+t,type:"get",dataType:"json",success:function(t){e&&e(t)},error:function(){console.log("error"),e&&e({})}})},n.prototype.onSyncButton=function(){r("event",{data:{action:"sync"}})},n.prototype.sendChat=function(t,e){e||(e="text"),this.conn.send({content:t,type:e,action:"chat"})},_.mixin({capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()}}),i.exports=n}),Array.prototype.sum=function(){for(var t=0,e=this.length;e--;)t+=this[e];return t},define("famous/CanvasSurface",["require","exports","module","./Surface"],function(t,e,i){function n(t){t&&t.canvasSize&&(this.canvasSize=t.canvasSize),o.call(this,t),this.canvasSize||(this.canvasSize=this.getSize()),this.backBuffer=document.createElement("canvas"),this.canvasSize&&(this.backBuffer.width=this.canvasSize[0],this.backBuffer.height=this.canvasSize[1]),this._contextId=void 0}var o=t("./Surface");n.prototype=Object.create(o.prototype),n.prototype.elementType="canvas",n.prototype.elementClass="surface",n.prototype.setContent=function(){},n.prototype.deploy=function(t){this.canvasSize&&(t.width=this.canvasSize[0],t.height=this.canvasSize[1]),"2d"==this._contextId&&(t.getContext(this._contextId).drawImage(this.backBuffer,0,0),this.backBuffer.width=0,this.backBuffer.height=0)},n.prototype.recall=function(t){this.getSize();this.backBuffer.width=t.width,this.backBuffer.height=t.height,"2d"==this._contextId&&(this.backBuffer.getContext(this._contextId).drawImage(t,0,0),t.width=0,t.height=0)},n.prototype.getContext=function(t){return this._contextId=t,this._currTarget?this._currTarget.getContext(t):this.backBuffer.getContext(t)},n.prototype.setSize=function(t,e){o.prototype.setSize.apply(this,arguments),e&&(this.canvasSize=e.slice(0)),this._currTarget&&(this._currTarget.width=this.canvasSize[0],this._currTarget.height=this.canvasSize[1])},i.exports=n}),define("famous/EventArbiter",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this.dispatchers={},this.currMode=void 0,this.setMode(t)}var o=t("./EventHandler");n.prototype.setMode=function(t){if(t!=this.currMode){var e=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].emit("unpipe"),this.currMode=t,this.dispatchers[t]&&this.dispatchers[t].emit("pipe"),this.emit("change",{from:e,to:t})}},n.prototype.forMode=function(t){return this.dispatchers[t]||(this.dispatchers[t]=new o),this.dispatchers[t]},n.prototype.emit=function(t,e){if(void 0==this.currMode)return!1;e||(e={});var i=this.dispatchers[this.currMode];return i?i.emit(t,e):void 0},i.exports=n}),define("famous/ImageSurface",["require","exports","module","./Surface"],function(t,e,i){function n(){this.imageUrl=void 0,o.apply(this,arguments)}var o=t("./Surface");n.prototype=Object.create(o.prototype),n.prototype.surfaceEvents=o.prototype.surfaceEvents.concat(["load"]),n.prototype.elementType="img",n.prototype.elementClass="surface",n.prototype.setContent=function(t){this.imageUrl=t,this._contentDirty=!0},n.prototype.deploy=function(t){t.src=this.imageUrl||""},n.prototype.recall=function(t){t.src=""},i.exports=n}),define("famous/SceneCompiler",["require","exports","module","./Matrix"],function(t,e,i){function n(t){var e={varCounter:0},i=[],n=u.call(e,t,i);return i.push("return "+n+";"),new Function(["FT","RenderNode","RN_link","RN_include","id","transforms"],i.join("\n"))}function o(t,e){return"var "+t+" = "+e+";"}function s(t,e){return"id."+t+" = "+e+";"}function r(t){return"transforms.push("+t+");"}function a(){return"_"+this.varCounter++}function u(t,e){var i;if(t instanceof Array)i=c.call(this,t,e);else if(i=a.call(this),t.target){var n=u.call(this,t.target,e),l=h.call(this,t,e);e.push(o(i,"new RenderNode("+l+")")),e.push("RN_link.call("+i+", "+n+");"),t.id&&e.push(s(t.id,l)),e.push(r(l))}else t.id&&(e.push(o(i,"new RenderNode()")),e.push(s(t.id,i)));return i}function c(t,e){var i=a.call(this);e.push(o(i,"new RenderNode()"));for(var n=0;n<t.length;n++){var s=u.call(this,t[n],e);s&&e.push("RN_include.call("+i+", "+s+");")}return i}function h(t,e){var i=t.transform,n=t.opacity,s=t.origin,r=t.size,u=(t.target,p.identity);if(i instanceof Array)if(16==i.length&&"number"==typeof i[0])u=i;else for(var c=0;c<i.length;c++)u=p.multiply(u,l(i[c]));else i instanceof Object&&(u=l(i));var h=a.call(this),f="["+u.join(",")+"]",d=s?"["+s.join(",")+"]":void 0,m=r?"["+r.join(",")+"]":void 0;return e.push(o(h,"new FT("+f+","+n+","+d+","+m+")")),h}function l(t){for(var e in f)if(e in t){var i=t[e];return i instanceof Array||(i=[i]),f[e].apply(this,i)}}var p=t("./Matrix"),f={translate:p.translate,rotate:p.rotate,rotateX:p.rotateX,rotateY:p.rotateY,rotateZ:p.rotateZ,rotateAxis:p.rotateAxis,scale:p.scale,skew:p.skew,matrix3d:function(){return arguments}};i.exports={compile:n}}),define("famous/Scene",["require","exports","module","./RenderNode","./Modifier","./SceneCompiler"],function(t,e,i){function n(t){this.id={},this.transforms=[],this.node=new o,this._def=void 0,t&&this.load(t)}var o=t("./RenderNode"),s=t("./Modifier"),r=t("./SceneCompiler"),a=o.prototype.link,u=o.prototype.add;n.prototype.create=function(){return new n(this._def)},n.prototype.load=function(t){t instanceof n?t=t._def:t instanceof Function||(t=r.compile(t)),this.node=t(s,o,a,u,this.id,this.transforms),this._def=t},n.prototype.getTransforms=function(){return this.transforms},n.prototype.add=function(){return this.node.add.apply(this.node,arguments)},n.prototype.mod=function(){return this.node.mod.apply(this.node,arguments)},n.prototype.link=function(){return this.node.link.apply(this.node,arguments)},n.prototype.render=function(){return this.node.render.apply(this.node,arguments)},i.exports=n}),define("famous/Timer",["require","exports","module","famous/Engine"],function(t,e,i){function n(t){return c.on(h,t),t}function o(t,e){var i=l(),o=function(){var n=l();n-i>=e&&(t.apply(this,arguments),c.unbind(h,o))};return n(o)}function s(t,e){var i=l(),o=function(){var n=l();n-i>=e&&(t.apply(this,arguments),i=l())};return n(o)}function r(t,e){if(void 0!==e){var i=function(){e--,0>=e&&(t.apply(this,arguments),u(i))};return n(i)}}function a(t,e){e=e||1;var i=e,o=function(){e--,0>=e&&(t.apply(this,arguments),e=i)};return n(o)}function u(t){c.unbind(h,t)}var c=t("famous/Engine"),h="prerender",l=window.performance?function(){return performance.now()}:function(){return Date.now()};i.exports={setTimeout:o,setInterval:s,after:r,every:a,clear:u}}),define("famous/VideoSurface",["require","exports","module","./Surface"],function(t,e,i){function n(t){this.autoplay=t.autoplay||!1,this.videoUrl=void 0,o.apply(this,arguments)}var o=t("./Surface");n.prototype=Object.create(o.prototype),n.prototype.elementType="video",n.prototype.elementClass="surface",n.prototype.setContent=function(t){this.videoUrl=t,this.contentDirty=!0},n.prototype.deploy=function(t){t.src=this.videoUrl,t.autoplay=this.autoplay},n.prototype.recall=function(t){t.src=""},i.exports=n}),define("famous/WebGLSurface",["require","exports","module","./Surface"],function(t,e,i){function n(t){this.glOptions=t.glOptions,this._canvas=document.createElement("canvas"),o.call(this,t),this.setContent(this._canvas),this.setSize(t.size)}var o=t("./Surface");n.prototype=Object.create(o.prototype),n.prototype.getContext=function(){return this._canvas.getContext("webgl",this.glOptions)||this._canvas.getContext("experimental-webgl",this.glOptions)},n.prototype.setSize=function(t){o.prototype.setSize.apply(this,arguments),this._canvas.style.width=t[0]+"px",this._canvas.style.height=t[1]+"px";var e=window.devicePixelRatio?window.devicePixelRatio:1;this._canvas.width=t[0]*e,this._canvas.height=t[1]*e},i.exports=n}),define("famous-animation/Animation",["require","exports","module","famous/Surface","famous/Matrix","famous-utils/Utils","./Easing"],function(t,e,i){function n(t){return this.name=t.name||"base",this.dead=!1,this.engine=t.engine||void 0,this.duration=t.duration||500,this.delay=t.delay||0,this.nextAnimations=[],void 0!==t.next&&(t.next instanceof Array?this.nextAnimations.concat(t.next):this.nextAnimations.push(t.next)),this.callback=t.callback||void 0,this.startTime=0,this.endTime=0,this.currentTime=0,this.normalizedTime=0,this.timePassed=0,this.halted=!1,this.playing=!1,this.activated=!1,this.activateCallback=t.activateCallback||void 0,this.deactivateCallback=t.deactivateCallback||void 0,this.loop=t.loop||!1,this.reverse=t.reverse||!1,this.reverseUponLoop=t.reverseUponLoop||!1,this}{var o=(t("famous/Surface"),t("famous/Matrix"),t("famous-utils/Utils"));t("./Easing")}n.prototype.setDead=function(t){return this.dead=t,this},n.prototype.isDead=function(){return this.dead},n.prototype.setup=function(){},n.prototype.update=function(){},n.prototype.render=function(){},n.prototype.isPlaying=function(){return this.playing},n.prototype.setDuration=function(t){return this.duration=t,this},n.prototype.setDelay=function(t){return this.delay=t,this},n.prototype.setCallback=function(t){return this.callback=t||void 0,this},n.prototype.setReverse=function(t){return this.reverse=t,this},n.prototype.toggleReverse=function(){return this.reverse=!this.reverse,this},n.prototype.setLoop=function(t){return this.loop=t,this},n.prototype.setReverseUponLoop=function(t){return this.reverseUponLoop=t,this},n.prototype.isHalted=function(){return this.halted},n.prototype.halt=function(){this.halted=!0,this.timePassed=this.engine.getTime()-this.startTime},n.prototype.continueAnimation=function(){this.halted=!1,this.startTime=this.engine.getTime()-this.timePassed,this.timePassed=0},n.prototype.activate=function(){},n.prototype.deactivate=function(){},n.prototype.start=function(){this.engine.addAnimation(this),this.setDead(!1),this.halted=!1,this.playing=!0,this.startTime=this.engine.getTime()+this.delay-this.timePassed,this.endTime=this.startTime+this.duration,this.normalizedTime=0},n.prototype.tick=function(){if(this.playing&&!this.halted){if(this.currentTime=this.engine.getTime()-this.startTime,this.normalizedTime=this.currentTime/this.duration,this.normalizedTime>1)return this.normalizedTime=o.clamp(this.normalizedTime,0,1),this.reverse&&(this.normalizedTime=1-this.normalizedTime),this.update(),this.end(),void 0;this.normalizedTime>1e-6&&(this.activated||(this.activate(),void 0!==this.activateCallback&&this.activateCallback(),this.activated=!0),this.reverse&&(this.normalizedTime=1-this.normalizedTime),this.update())}},n.prototype.getTime=function(){return this.normalizedTime},n.prototype.end=function(){if(this.activated=!1,this.playing=!1,this.deactivate(),void 0!==this.deactivateCallback&&this.deactivateCallback(),this.engine.removeAnimation(this),this.reverseUponLoop&&this.toggleReverse(),this.loop)this.start();else for(var t=0;t<this.nextAnimations.length;t++)this.nextAnimations[t].start();void 0!==this.callback&&this.callback()},n.prototype.setNext=function(t){t instanceof Array?this.nextAnimations=this.nextAnimations.concat(this.nextAnimations,t):this.nextAnimations.push(t)},n.prototype.setName=function(t){this.name=t},n.prototype.getName=function(){return this.name},n.prototype.setActivateCallback=function(t){this.activateCallback=t},n.prototype.setDeactivateCallback=function(t){this.deactivateCallback=t},i.exports=n}),define("famous-animation/Timer",["require","exports","module"],function(t,e,i){function n(){window.performance?window.performance.now?this.getTime=function(){return window.performance.now()}:window.performance.webkitNow&&(this.getTime=function(){return window.performance.webkitNow()}):this.getTime=function(){return Date.now()}}i.exports=n}),define("famous-animation/AnimationEngine",["require","exports","module","famous/Engine","./Timer","./Animation"],function(t,e,i){function n(){this.animations=[],this.timer=new s,o.on("prerender",this.update.bind(this))}{var o=t("famous/Engine"),s=t("./Timer");t("./Animation")}n.prototype.update=function(){for(var t=0;t<this.animations.length;t++)this.animations[t].tick()},n.prototype.render=function(){for(var t=[],e=0;e<this.animations.length;e++)this.animations[e].normalizedTime>0&&t.push(this.animations[e].render()),this.animations[e].isDead()&&this.animations.splice(this.animations.indexOf(this.animations[e]),1);return t},n.prototype.emit=function(t){"prerender"==t&&(this.update(),this.render())},n.prototype.addAnimation=function(t){-1==this.animations.indexOf(t)&&this.animations.push(t)},n.prototype.removeAnimation=function(t){t.setDead(!0)},n.prototype.getTime=function(){return this.timer.getTime()},i.exports=n}),define("famous-animation/CubicBezier",["require","exports","module"],function(t,e,i){function n(t){var e=[[1,0,0,0],[0,0,1,0],[-3,3,-2,-1],[2,-2,1,1]];t=t||[0,1,0,0],this.coef=[0,0,0,0];for(var i=0;4>i;i++)for(var n=0;4>n;n++)this.coef[i]+=e[i][n]*t[n]}n.prototype.create=function(){var t=this;return function(e){e=e||0;var i=t.coef;return i[0]+i[1]*e+i[2]*e*e+i[3]*e*e*e}},i.exports=n}),define("famous-math/Vector",["require","exports","module"],function(t,e,i){function n(t,e,i){return 1==arguments.length?(t instanceof Array&&this.setXYZ(t[0],t[1],t[2]),"Vector"==t.constructor.name&&this.set(t)):(this.x=t||0,this.y=e||0,this.z=i||0),this}n.prototype.add=function(t,e){return e=e||this.register,e.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},n.prototype.sub=function(t,e){return e=e||this.register,e.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t,e){return e=e||this.register,e.setXYZ(t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t,e){return this.mult(1/t,e)},n.prototype.cross=function(t,e){return e=e||this.register,e.setXYZ(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},n.prototype.rotate=function(t,e){var i=t.x,n=t.y,o=t.z;return this.rotateX(i,e).rotateY(n,e).rotateZ(o,e)},n.prototype.rotateX=function(t,e){e=e||this.register;var i=this.x,n=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return e.setXYZ(i,-o*r+n*s,o*s-n*r)},n.prototype.rotateY=function(t,e){e=e||this.register;var i=this.x,n=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return e.setXYZ(-o*r+i*s,n,o*s+i*r)},n.prototype.rotateZ=function(t,e){e=e||this.register;var i=this.x,n=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return e.setXYZ(-n*r+i*s,n*s+i*r,o)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t,e){t=t||1,e=e||this.register;var i=1e-7,n=this.norm();return Math.abs(n)>i?this.mult(t/n,e):e.setXYZ(t,0,0)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)},n.prototype.isZero=function(){return!this.x&&!this.y&&!this.z},n.prototype.set=function(t){return t instanceof Array?(this.x=t[0],this.y=t[1],this.z=t[2]||0):(this.x=t.x,this.y=t.y,this.z=t.z),this!=this.register&&this.register.clear(),this},n.prototype.setXYZ=function(t,e,i){return this.register.clear(),this.x=t,this.y=e,this.z=i,this},n.prototype.clear=function(){this.x=0,this.y=0,this.z=0},n.prototype.cap=function(t){if(1/0==t)return this;var e=this.norm();return e>t&&this.normalize().mult(t,this),this},n.prototype.project=function(t,e){return e=e||this.register,t.mult(this.dot(t),e)},n.prototype.reflect=function(t,e){return e=e||this.register,t.normalize(),this.sub(this.project(t).mult(2),e)},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.fromArray=function(t){this.x=t[0],this.y=t[1],this.z=t[2]},n.prototype.get=function(){return this.toArray()},n.prototype.register=new n(0,0,0),n.prototype.zero=new n(0,0,0),n.prototype.one=new n(1,1,1),i.exports=n}),define("famous-math/Quaternion",["require","exports","module","famous/Matrix"],function(t,e,i){function n(t,e,i,n){return this.w=void 0!==t?t:1,this.x=e||0,this.y=i||0,this.z=n||0,this}t("famous/Matrix");n.prototype.makeFromAngleAndAxis=function(t,e){e.normalize();var i=.5*t,n=Math.sin(i);return this.x=n*e.x,this.y=n*e.y,this.z=n*e.z,this.w=Math.cos(i),this},n.prototype.clone=function(){return new n(this.w,this.x,this.y,this.z)},n.prototype.setWXYZ=function(t,e,i,n){return this.w=t,this.x=e,this.y=i,this.z=n,this},n.prototype.set=function(t){return this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z,this},n.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},n.prototype.normalize=function(){var t=Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);if(0==t)this.w=1,this.x=this.y=this.z=0;else{var e=1/t;this.w*=e,this.x*=e,this.y*=e,this.z*=e}return this},n.prototype.getMatrix=function(){return this.normalize(),[1-2*this.y*this.y-2*this.z*this.z,2*this.x*this.y-2*this.z*this.w,2*this.x*this.z+2*this.y*this.w,0,2*this.x*this.y+2*this.z*this.w,1-2*this.x*this.x-2*this.z*this.z,2*this.y*this.z-2*this.x*this.w,0,2*this.x*this.z-2*this.y*this.w,2*this.y*this.z+2*this.x*this.w,1-2*this.x*this.x-2*this.y*this.y,0,0,0,0,1]},n.prototype.multiply=function(t,e){return e=e||this.register,e.w=this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z,e.x=this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,e.y=this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,e.z=this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w,e},n.prototype.isEqual=function(t){return t.w==this.w&&t.x==this.x&&t.y==this.y&&t.z==this.z?!0:!1},n.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.add=function(t,e){return e=e||this.register,e.w=this.w+t.w,e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e},n.prototype.sub=function(t,e){return e=e||this.register,e.w=this.w-t.w,e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e},n.prototype.normSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.conj=function(t){return t=t||this.register,t.w=this.w,t.x=-this.x,t.y=-this.y,t.z=-this.z,t},n.prototype.inverse=function(t){return t=t||this.register,this.conj(t),t.scalarDivide(this.normSquared(),t),t},n.prototype.scalarDivide=function(t,e){return e=e||this.register,t=1/t,e.w=this.w*t,e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e},n.prototype.scalarMult=function(t,e){return e=e||this.register,e.w=this.w*t,e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e},n.prototype.isZero=function(){return 0==this.x&&0==this.y&&0==this.z&&1==this.w?!0:!1},n.prototype.negate=function(){return this.w=-this.w,this.x=-this.x,this.y=-this.y,this.z=-this.z,this},n.prototype.zeroRotation=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},n.prototype.slerp=function(t,e,i){i=i||this.register;var n,o,s,r,a;return this.to.set(t),this.from.set(this),o=this.dot(t),0>o&&(o=-o,this.to.negate()),1-o>this.epsilon?(n=Math.acos(o),s=Math.sin(n),r=Math.sin((1-e)*n)/s,a=Math.sin(e*n)/s):(r=1-e,a=e),this.from.scalarMult(r,this.from),this.to.scalarMult(a,this.to),this.from.add(this.to,i),i},n.prototype.epsilon=1e-5,n.prototype.from=new n(0,0,0,0),n.prototype.to=new n(0,0,0,0),n.prototype.register=new n(0,0,0,0),n.prototype.zero=new n(0,0,0,0),n.prototype.one=new n(1,1,1,1),i.exports=n}),define("famous-color/Color",["require","exports","module","famous-utils/Utils"],function(t,e,i){function n(t,e,i,o){t instanceof n?(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.hex=t.getHex()):(this.r="undefined"==typeof t?255:t,this.g="undefined"==typeof e?255:e,this.b="undefined"==typeof i?255:i,this.a="undefined"==typeof o?1:o,this.hex=this.getHex())}function o(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var s=t("famous-utils/Utils");n.prototype.getHue=function(){var t=this.r/255,e=this.g/255,i=this.b/255,n=Math.max(t,e,i),o=Math.min(t,e,i),s=0,r=n-o;switch(n){case t:s=(e-i)/r+(i>e?6:0);break;case e:s=(i-t)/r+2;break;case i:s=(t-e)/r+4}return s*=60,isNaN(s)&&(s=0),s},n.prototype.getSaturation=function(){var t,e=this.r/255,i=this.g/255,n=this.b/255,o=Math.max(e,i,n),s=Math.min(e,i,n),r=(o+s)/2;if(o==s)h=t=0;else{var a=o-s;switch(t=r>.5?a/(2-o-s):a/(o+s),o){case e:h=(i-n)/a+(n>i?6:0);break;case i:h=(n-e)/a+2;break;case n:h=(e-i)/a+4}h*=60}return 100*t},n.prototype.getBrightness=function(){var t=this.r/255,e=this.g/255,i=this.b/255;return 100*Math.max(t,e,i)},n.prototype.getLightness=function(){var t=this.r/255,e=this.g/255,i=this.b/255;return(Math.max(t,e,i)+Math.min(t,e,i))/2*100},n.prototype.getHex=function(){function t(t){var e=t.toString(16);return 1===e.length?"0"+e:e}return"#"+t(this.r)+t(this.g)+t(this.b)},n.prototype.getHSL=function(){var t,e,i=this.r/255,n=this.g/255,o=this.b/255,s=Math.max(i,n,o),r=Math.min(i,n,o),a=(s+r)/2;if(s==r)t=e=0;else{var u=s-r;switch(e=a>.5?u/(2-s-r):u/(s+r),s){case i:t=(n-o)/u+(o>n?6:0);break;case n:t=(o-i)/u+2;break;case o:t=(i-n)/u+4}t*=60}return[t,100*e,100*a]},n.prototype.setFromHSL=function(t,e,i){t/=360,e/=100,i/=100;var n,s,r;if(0===e)n=s=r=i;else{var a=.5>i?i*(1+e):i+e-i*e,u=2*i-a;n=o(u,a,t+1/3),s=o(u,a,t),r=o(u,a,t-1/3)}return this.r=Math.round(255*n),this.g=Math.round(255*s),this.b=Math.round(255*r),this.hex=this.getHex(),this},n.prototype.setFromHex=function(t){return t="#"===t.charAt(0)?t.substring(1,t.length):t,3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),this.hex="#"+t,this.r=parseInt(t.substring(0,2),16),this.g=parseInt(t.substring(2,4),16),this.b=parseInt(t.substring(4,6),16),this},n.prototype.setFromRGBA=function(t,e,i,n){return this.r=t,this.g=e,this.b=i,n&&(this.a=n),this.hex=this.getHex(),this},n.prototype.setHue=function(t){var e=this.getHSL();return this.setFromHSL(t,e[1],e[2])},n.prototype.setSaturation=function(t){var e=this.getHSL();return this.setFromHSL(e[0],t,e[2])},n.prototype.setLightness=function(t){var e=this.getHSL();return this.setFromHSL(e[0],e[1],t)},n.prototype.getCSSBackgroundColor=function(){return s.backgroundColor(this.r,this.b,this.g,this.a)},n.prototype.getCSSColor=function(){return s.color(this.r,this.g,this.b,this.a)},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n.prototype.toNormalizeColorArray=function(){return[this.r/255,this.g/255,this.b/255,this.a]},n.prototype.lerp=function(t,e){var i=this.getHSL(),o=t.getHSL(),s=i[0]+(o[0]-i[0])*e,r=i[1]+(o[1]-i[1])*e,a=i[2]+(o[2]-i[2])*e,u=new n;return u.setFromHSL(s,r,a),u},i.exports=n}),define("famous-animation/GenericAnimation",["require","exports","module","famous/Surface","famous/Matrix","famous-math/Vector","famous-math/Quaternion","./Animation","./AnimationEngine","./Easing","famous-utils/Utils","famous-color/Color"],function(t,e,i){function n(t){a.call(this,t),this.surface=t.surface,this.renderSurface=t.renderSurface||!1,this.easing=t.easing||u.inOutCubicNorm,this.animateColor=!1,this.startColor=t.startColor||new h(255,255,255,1),this.endColor=t.endColor||new h(255,255,255,1),this.startColorHSL=new s,this.endColorHSL=new s,this.deltaColorHSL=new s,this.currentColorHSL=new s,this.animateOpacity=!1,this.startOpacity=t.startOpacity||0,this.endOpacity=t.endOpacity||0,this.deltaOpacity=0,this.animatePosition=!1,this.startPosition=t.startPosition||new s(0,0,0).fromArray(o.getTranslate(this.surface.mtx)),this.endPosition=t.endPosition||new s(0,0,0).fromArray(o.getTranslate(this.surface.mtx)),this.currentPosition=new s(0,0,0),this.deltaPosition=new s(0,0,0),this.animateOrientation=!1,this.startOrientation=t.startOrientation||new r,this.endOrientation=t.endOrientation||new r,this.currentOrientation=t.currentOrientation||new r,this.animateRadius=!1,this.startRadius=t.startRadius||0,this.endRadius=t.endRadius||0,this.deltaRadius=0,this.currentRadius=0
}var o=(t("famous/Surface"),t("famous/Matrix")),s=t("famous-math/Vector"),r=t("famous-math/Quaternion"),a=t("./Animation"),u=(t("./AnimationEngine"),t("./Easing")),c=t("famous-utils/Utils"),h=t("famous-color/Color");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.activate=function(){var t=this.startColor.getHSL(),e=this.endColor.getHSL();this.startColorHSL.setXYZ(t[0],t[1],t[2]),this.endColorHSL.setXYZ(e[0],e[1],e[2]),this.endColorHSL.sub(this.startColorHSL,this.deltaColorHSL),this.currentColorHSL.set(this.startColorHSL),this.animateColor=this.startColor.r==this.endColor.r&&this.startColor.g==this.endColor.g&&this.startColor.b==this.endColor.b&&this.startColor.a==this.endColor.a?!1:!0,this.deltaOpacity=this.endOpacity-this.startOpacity,this.animateOpacity=Math.abs(this.deltaOpacity)>0?!0:!1,this.endPosition.sub(this.startPosition,this.deltaPosition),this.currentPosition.set(this.startPosition),this.animatePosition=this.deltaPosition.isZero()?!1:!0,this.animateOrientation=this.startOrientation.isEqual(this.endOrientation)?!1:!0,this.deltaRadius=this.endRadius-this.startRadius,this.currentRadius=this.startRadius,this.animateRadius=0===this.deltaRadius?!1:!0},n.prototype.tick=function(){if(this.playing&&!this.halted){if(this.currentTime=this.engine.getTime()-this.startTime,this.normalizedTime=this.currentTime/this.duration,this.normalizedTime>1)return this.normalizedTime=c.clamp(this.normalizedTime,0,1),this._update(),this.update(),this.end(),void 0;this.normalizedTime>1e-6&&(this.activated||(this.activate(),void 0!==this.activateCallback&&this.activateCallback(),this.activated=!0),this.reverse&&(this.normalizedTime=1-this.normalizedTime),this._update(),this.update())}},n.prototype._update=function(){var t=this.easing(this.normalizedTime);this.animateColor&&(this.deltaColorHSL.mult(t,this.currentColorHSL),this.currentColorHSL.add(this.startColorHSL,this.currentColorHSL),this.surface.setProperties(c.backgroundColorHSL(this.currentColorHSL.x,this.currentColorHSL.y,this.currentColorHSL.z,1))),this.animateOpacity&&(this.surface.opacity=this.startOpacity+this.deltaOpacity*t),(this.animatePosition||this.animateOrientation)&&(this.deltaPosition.mult(t,this.currentPosition),this.currentPosition.add(this.startPosition,this.currentPosition),this.startOrientation.slerp(this.endOrientation,t,this.currentOrientation),this.surface.mtx=o.move(this.currentOrientation.getMatrix(),this.currentPosition.toArray())),this.animateRadius&&(this.currentRadius=this.startRadius+this.deltaRadius*t,this.surface.setProperties(c.borderRadius(this.currentRadius)))},n.prototype.render=function(){return this.renderSurface&&!this.dead&&this.normalizedTime>0?{transform:this.surface.mtx,opacity:this.surface.opacity,target:this.surface.render()}:void 0},n.prototype.setStartColor=function(t){this.startColor=t},n.prototype.setEndColor=function(t){this.endColor=t},n.prototype.getStartColor=function(){return this.startColor},n.prototype.getEndColor=function(){return this.endColor},n.prototype.setStartPosition=function(t){this.startPosition=t},n.prototype.setStartPositionX=function(t){this.startPosition.x=t},n.prototype.setStartPositionY=function(t){this.startPosition.y=t},n.prototype.setStartPositionZ=function(t){this.startPosition.z=t},n.prototype.setEndPosition=function(t){this.endPosition=t},n.prototype.setEndPositionX=function(t){this.endPosition.setX(t)},n.prototype.setEndPositionY=function(t){this.endPosition.setY(t)},n.prototype.setEndPositionZ=function(t){this.endPosition.setZ(t)},n.prototype.getEndPosition=function(){return this.endPosition},n.prototype.getStartPosition=function(){return this.startPosition},n.prototype.getCurrentPosition=function(){return this.currentPosition},n.prototype.setStartOpacity=function(t){this.startOpacity=t},n.prototype.setEndOpacity=function(t){this.endOpacity=t},n.prototype.getStartOpacity=function(){return this.startOpacity},n.prototype.getEndOpacity=function(){return this.endOpacity},n.prototype.setStartRadius=function(t){this.startRadius=t},n.prototype.setEndRadius=function(t){this.endRadius=t},n.prototype.getCurrentRadius=function(){return this.currentRadius},n.prototype.getStartRadius=function(){return this.startRadius},n.prototype.getEndRadius=function(){return this.endRadius},n.prototype.setStartOrientation=function(t){this.startOrientation=t},n.prototype.setEndOrientation=function(t){this.endOrientation=t},n.prototype.getEndOrientation=function(){return this.endOrientation},n.prototype.getStartOrientation=function(){return this.startOrientation},n.prototype.setEasing=function(t){this.easing=t},n.prototype.setSurface=function(t){this.surface=t},n.prototype.setEndValuesToStartValues=function(){this.startColor=this.endColor.clone(),this.startOpacity=this.endOpacity,this.startPosition.set(this.endPosition),this.startOrientation.set(this.endOrientation),this.startRadius=this.endRadius},i.exports=n}),define("famous-animation/Idle",["require","exports","module"],function(t,e,i){function n(t,e){this.idleFn=t,this.timeout=e,this.enabled=e>0,this.reset()}n.prototype.timeoutIn=function(t){this.lastTouchTime=(new Date).getTime()-this.timeout+t},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.setIdleFunction=function(t){this.idleFn=t},n.prototype.update=function(){if(!this.idling&&this.enabled&&this.idleFn){var t=(new Date).getTime();t-this.lastTouchTime>this.timeout&&(this.idling=!0,this.idleFn.call(this))}},n.prototype.isIdling=function(){return this.idling},n.prototype.reset=function(){this.lastTouchTime=(new Date).getTime(),this.idling=!1},n.prototype.emit=function(){this.reset()},i.exports=n}),define("famous-animation/PiecewiseCubicBezier",["require","exports","module","./CubicBezier"],function(t,e,i){function n(t){t=t||{},this.split=t.split||.5;var e=t.overshoot||0,i=t.vLeft||[0,1+e,0,0],n=t.vRight||[1+e,1,0,0];this.bezLeft=new o(i).create(),this.bezRight=new o(n).create()}var o=t("./CubicBezier");n.prototype.create=function(){var t=this;return function(e){e=e||0;var i,n=t.split;return n>e?(i=e/n,t.bezLeft(i)):(i=(e-n)/(1-n),t.bezRight(i))}},i.exports=n}),define("famous-animation/RegisterEasing",["require","exports","module","./Easing","famous/TweenTransition"],function(t){function e(){for(var t=/norm/gi,e=i(o).filter(function(e){return t.test(e)}).sort(),n={},s=0;s<e.length;s++)n[e[s]]=o[e[s]];return n}function i(t){var e=[];for(key in t)t.hasOwnProperty(key)&&e.push(key);return e}function n(){var t=e();for(var i in t)s.registerCurve(i,t[i])}var o=t("./Easing"),s=t("famous/TweenTransition");n()}),define("famous-animation/Sequence",["require","exports","module"],function(t,e,i){function n(){this.startTime=0,this.setupPos=0,this.schedule=[],this.seqLoc=-1}n.prototype._execute=function(t){for(this.seqLoc<0&&(this.seqLoc=0);this.seqLoc<this.schedule.length&&this.schedule[this.seqLoc].pos<=t;)this.schedule[this.seqLoc].action.call(this),this.seqLoc++},n.prototype.update=function(){if(!(this.seqLoc<0||this.seqLoc>=this.schedule.length)){var t=(new Date).getTime()-this.startTime;this._execute(t)}},n.prototype.at=function(t,e){this.schedule.push({pos:t,action:e}),this.setupPos=t},n.prototype.after=function(t,e){this.at(this.setupPos+t,e)},n.prototype.play=function(t){this.schedule.sort(function(t,e){return t.pos-e.pos}),this.startTime=(new Date).getTime();for(var e=0;e<this.schedule.length&&this.schedule[e].pos<t;)e++;this.seqLoc=e},n.prototype.fastForward=function(t){"undefined"==typeof t&&(t=1/0),this._execute(t)},n.prototype.stop=function(){this.seqLoc=-1},i.exports=n}),define("famous-color/ColorPalette",["require","exports","module","./Color"],function(t,e,i){function n(t){this.colors=t}t("./Color");n.prototype.getColor=function(t){return this.colors[t%this.colors.length]},n.prototype.getCSS=function(t){return this.getColor(t).getCSSColor()},n.prototype.getLighestColor=function(){for(var t,e=0,i=0;i<this.colors.length;i++){var n=this.colors[i].getLightness();n>e&&(t=this.colors[i],e=n)}return t},n.prototype.getDarkestColor=function(){for(var t,e=100,i=0;i<this.colors.length;i++){var n=this.colors[i].getLightness();e>n&&(t=this.colors[i],e=n)}return t},n.prototype.getCount=function(){return this.colors.length},i.exports=n}),define("famous-color/ColorPalettes",["require","exports","module","./Color","./ColorPalette"],function(t,e,i){function n(){}function o(t){return new r(t[0],t[1],t[2],t[3])}function s(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(o(t[i]));return new a(e)}var r=t("./Color"),a=t("./ColorPalette"),u=[[[53,92,125,1],[108,91,123,1],[192,108,132,1],[246,114,128,1],[248,177,149,1]],[[27,21,33,1],[181,172,1,1],[212,30,69,1],[232,110,28,1],[236,186,9,1]],[[63,54,42,1],[231,69,13,1],[250,157,4,1],[251,222,3,1],[254,245,150,1]],[[10,103,137,1],[10,153,111,1],[207,6,56,1],[250,102,50,1],[254,205,35,1]],[[157,85,105,1],[192,227,217,1],[202,55,99,1],[227,237,195,1],[235,113,84,1]],[[110,110,110,1],[145,217,255,1],[237,255,135,1],[255,133,167,1],[255,255,255,1]],[[0,0,0,1],[25,26,36,1],[51,44,44,1],[250,101,87,1],[255,255,255,1]],[[27,103,107,1],[81,149,72,1],[136,196,37,1],[190,242,2,1],[234,253,230,1]],[[31,11,12,1],[48,5,17,1],[179,84,79,1],[214,195,150,1],[231,252,207,1]],[[172,248,248,1],[223,235,24,1],[230,95,95,1],[235,54,24,1],[235,207,24,1]],[[196,182,109,1],[213,39,5,1],[240,211,119,1],[243,232,228,1],[247,109,60,1]],[[11,72,107,1],[59,134,134,1],[121,189,154,1],[168,219,168,1],[207,240,158,1]],[[0,188,209,1],[118,211,222,1],[174,232,251,1],[176,248,255,1],[254,249,240,1]],[[85,73,57,1],[112,108,77,1],[241,230,143,1],[255,100,100,1],[255,151,111,1]],[[36,244,161,1],[178,42,58,1],[199,244,36,1],[244,36,182,1],[249,246,49,1]],[[108,144,134,1],[169,204,24,1],[207,73,108,1],[235,234,188,1],[252,84,99,1]],[[78,79,75,1],[130,35,57,1],[247,62,62,1],[255,119,61,1],[255,213,115,1]],[[121,28,49,1],[145,213,152,1],[191,178,64,1],[202,51,68,1],[237,126,80,1]],[[104,73,83,1],[127,191,151,1],[182,219,145,1],[250,107,41,1],[253,158,41,1]],[[0,203,231,1],[0,218,60,1],[223,21,26,1],[244,243,40,1],[253,134,3,1]],[[56,222,231,1],[232,255,0,1],[254,62,71,1],[255,130,0,1]],[[27,32,38,1],[75,89,107,1],[153,228,255,1],[247,79,79,1],[255,59,59,1]],[[0,0,0,1],[0,173,239,1],[236,0,140,1],[255,242,0,1]],[[47,43,173,1],[173,43,173,1],[228,38,146,1],[247,21,104,1],[247,219,21,1]],[[101,150,158,1],[171,20,44,1],[189,219,222,1],[205,212,108,1],[219,217,210,1]],[[97,24,36,1],[193,47,42,1],[247,255,238,1],[254,222,123,1],[255,101,64,1]],[[118,85,66,1],[124,231,163,1],[220,93,110,1],[255,174,60,1],[255,229,156,1]],[[63,184,175,1],[127,199,175,1],[218,216,167,1],[255,61,127,1],[255,158,157,1]],[[217,251,223,1],[219,255,210,1],[231,254,235,1],[234,255,210,1],[243,255,210,1]],[[0,23,42,1],[27,139,163,1],[94,202,214,1],[178,222,249,1],[206,254,255,1]],[[225,245,196,1],[237,229,116,1],[249,212,35,1],[252,145,58,1],[255,78,80,1]],[[7,9,61,1],[11,16,140,1],[12,15,102,1],[14,78,173,1],[16,127,201,1]],[[5,177,240,1],[5,232,240,1],[94,87,230,1],[230,87,149,1],[255,5,113,1]],[[48,0,24,1],[90,61,49,1],[131,123,71,1],[173,184,95,1],[229,237,184,1]],[[111,191,162,1],[191,184,174,1],[242,199,119,1],[242,230,194,1],[255,255,255,1]],[[22,147,165,1],[69,181,196,1],[126,206,202,1],[160,222,214,1],[199,237,232,1]],[[8,26,48,1],[50,64,90,1],[59,100,128,1],[155,153,130,1],[255,134,17,1]],[[74,186,176,1],[152,33,0,1],[255,211,0,1],[255,245,158,1]],[[42,135,50,1],[49,48,66,1],[107,85,48,1],[255,109,36,1],[255,235,107,1]],[[0,0,0,1],[25,134,219,1],[105,172,224,1],[149,199,24,1],[184,212,40,1]],[[64,0,20,1],[127,0,40,1],[191,0,59,1],[229,0,71,1],[255,0,79,1]],[[56,69,59,1],[78,133,136,1],[255,70,84,1],[255,213,106,1],[255,254,211,1]],[[29,44,143,1],[57,179,162,1],[209,146,191,1],[222,75,107,1],[252,180,121,1]],[[14,36,48,1],[232,213,183,1],[232,213,185,1],[245,179,73,1],[252,58,81,1]],[[0,210,255,1],[222,255,0,1],[255,0,168,1],[255,66,0,1]],[[21,99,105,1],[51,53,84,1],[169,186,181,1],[216,69,148,1],[236,196,89,1]],[[105,210,231,1],[167,219,216,1],[224,228,204,1],[243,134,48,1],[250,105,0,1]],[[122,106,83,1],[148,140,117,1],[153,178,183,1],[213,222,217,1],[217,206,178,1]],[[34,104,136,1],[57,142,182,1],[255,162,0,1],[255,214,0,1],[255,245,0,1]],[[2,100,117,1],[194,163,79,1],[251,184,41,1],[254,251,175,1],[255,229,69,1]],[[214,37,77,1],[246,215,107,1],[253,235,169,1],[255,84,117,1],[255,144,54,1]],[[0,0,0,1],[124,180,144,1],[211,25,0,1],[255,102,0,1],[255,242,175,1]],[[35,116,222,1],[38,38,38,1],[87,54,255,1],[231,255,54,1],[255,54,111,1]],[[64,18,44,1],[89,186,169,1],[101,98,115,1],[216,241,113,1],[252,255,217,1]],[[126,148,158,1],[174,194,171,1],[235,206,160,1],[252,119,101,1],[255,51,95,1]],[[75,73,11,1],[117,116,73,1],[226,223,154,1],[235,229,77,1],[255,0,81,1]],[[159,112,69,1],[183,98,5,1],[208,167,124,1],[253,169,43,1],[254,238,171,1]],[[38,37,28,1],[160,232,183,1],[235,10,68,1],[242,100,61,1],[242,167,61,1]],[[0,0,0,1],[67,110,217,1],[120,0,0,1],[216,216,216,1],[240,24,0,1]],[[51,51,51,1],[131,163,0,1],[158,12,57,1],[226,27,90,1],[251,255,227,1]],[[79,156,52,1],[108,186,85,1],[125,210,89,1],[158,228,70,1],[187,255,133,1]],[[0,44,43,1],[7,100,97,1],[10,131,127,1],[255,61,0,1],[255,188,17,1]],[[149,207,183,1],[240,65,85,1],[242,242,111,1],[255,130,58,1],[255,247,189,1]],[[89,168,15,1],[158,213,76,1],[196,237,104,1],[226,255,158,1],[240,242,221,1]],[[54,42,44,1],[189,223,38,1],[237,38,105,1],[238,189,97,1],[252,84,99,1]],[[11,246,147,1],[38,137,233,1],[233,26,157,1],[246,182,11,1],[246,242,11,1]],[[8,0,9,1],[65,242,221,1],[207,242,65,1],[249,44,130,1],[252,241,30,1]],[[198,164,154,1],[198,229,217,1],[214,129,137,1],[233,78,119,1],[244,234,213,1]],[[6,71,128,1],[8,84,199,1],[160,194,222,1],[205,239,255,1],[237,237,244,1]],[[93,66,63,1],[124,87,83,1],[238,128,117,1],[255,177,169,1],[255,233,231,1]],[[59,129,131,1],[237,48,60,1],[245,99,74,1],[250,208,137,1],[255,156,91,1]],[[56,166,155,1],[104,191,101,1],[204,217,106,1],[242,88,53,1],[242,218,94,1]],[[60,197,234,1],[70,70,70,1],[233,234,60,1],[246,246,246,1]],[[97,99,130,1],[102,36,91,1],[105,165,164,1],[168,196,162,1],[229,234,164,1]],[[10,191,188,1],[19,116,125,1],[41,34,31,1],[252,53,76,1],[252,247,197,1]],[[7,0,4,1],[236,67,8,1],[252,129,10,1],[255,172,35,1],[255,251,214,1]],[[0,5,1,1],[8,138,19,1],[237,20,9,1],[240,249,241,1],[247,249,21,1]],[[64,197,132,1],[131,218,232,1],[170,46,154,1],[251,35,137,1],[251,132,137,1]],[[64,47,58,1],[217,119,119,1],[255,198,158,1],[255,219,196,1]],[[243,96,49,1],[249,236,95,1],[255,102,0,1],[255,153,0,1],[255,204,0,1]],[[33,90,109,1],[45,45,41,1],[60,162,162,1],[146,199,163,1],[223,236,230,1]],[[10,42,63,1],[101,147,160,1],[185,204,184,1],[219,21,34,1],[255,239,167,1]],[[0,160,176,1],[106,74,60,1],[204,51,63,1],[235,104,65,1],[237,201,81,1]],[[14,141,148,1],[67,77,83,1],[114,173,117,1],[233,213,88,1],[255,171,7,1]],[[94,159,163,1],[176,85,116,1],[220,209,180,1],[248,126,123,1],[250,184,127,1]],[[31,31,31,1],[122,91,62,1],[205,189,174,1],[250,75,0,1],[250,250,250,1]],[[176,230,41,1],[180,35,16,1],[247,207,10,1],[250,124,7,1],[252,231,13,1]],[[94,65,47,1],[120,192,168,1],[240,120,24,1],[240,168,48,1],[252,235,182,1]],[[31,26,28,1],[98,128,125,1],[134,158,138,1],[201,107,30,1],[209,205,178,1]],[[40,60,0,1],[100,153,125,1],[237,143,69,1],[241,169,48,1],[254,204,109,1]],[[37,2,15,1],[143,143,143,1],[158,30,76,1],[236,236,236,1],[255,17,104,1]],[[207,108,116,1],[244,93,120,1],[255,112,136,1],[255,130,153,1],[255,187,193,1]],[[0,0,0,1],[12,13,5,1],[168,171,132,1],[198,201,157,1],[231,235,176,1]],[[0,170,255,1],[170,0,255,1],[170,255,0,1],[255,0,170,1],[255,170,0,1]],[[78,150,137,1],[126,208,214,1],[135,214,155,1],[195,255,104,1],[244,252,232,1]],[[10,10,10,1],[227,246,255,1],[255,20,87,1],[255,216,125,1]],[[51,51,153,1],[102,153,204,1],[153,204,255,1],[255,0,51,1],[255,204,0,1]],[[23,22,92,1],[190,191,158,1],[216,210,153,1],[229,228,218,1],[245,224,56,1]],[[49,99,64,1],[96,158,77,1],[159,252,88,1],[195,252,88,1],[242,252,88,1]],[[92,88,99,1],[168,81,99,1],[180,222,193,1],[207,255,221,1],[255,31,76,1]],[[61,67,7,1],[161,253,17,1],[225,244,56,1],[244,251,196,1],[255,208,79,1]],[[0,205,172,1],[2,170,176,1],[22,147,165,1],[127,255,36,1],[195,255,104,1]],[[0,203,231,1],[0,218,60,1],[223,21,26,1],[244,243,40,1],[253,134,3,1]],[[34,104,136,1],[57,142,182,1],[255,162,0,1],[255,214,0,1],[255,245,0,1]],[[3,13,79,1],[206,236,239,1],[231,237,234,1],[251,12,6,1],[255,197,44,1]],[[253,255,0,1],[255,0,0,1],[255,90,0,1],[255,114,0,1],[255,167,0,1]],[[108,66,18,1],[179,0,176,1],[183,255,55,1],[255,124,69,1],[255,234,155,1]],[[0,4,49,1],[59,69,58,1],[90,224,151,1],[204,46,9,1],[255,253,202,1]],[[59,45,56,1],[188,189,172,1],[207,190,39,1],[240,36,117,1],[242,116,53,1]],[[101,145,155,1],[120,185,168,1],[168,212,148,1],[242,177,73,1],[244,229,97,1]],[[0,193,118,1],[136,193,0,1],[250,190,40,1],[255,0,60,1],[255,138,0,1]],[[110,37,63,1],[165,199,185,1],[199,94,106,1],[241,245,244,1],[251,236,236,1]],[[39,112,140,1],[111,191,162,1],[190,191,149,1],[227,208,116,1],[255,180,115,1]],[[62,72,76,1],[82,91,96,1],[105,158,81,1],[131,178,107,1],[242,232,97,1]],[[248,135,46,1],[252,88,12,1],[252,107,10,1],[253,202,73,1],[255,169,39,1]],[[83,119,122,1],[84,36,55,1],[192,41,66,1],[217,91,67,1],[236,208,120,1]],[[41,136,140,1],[54,19,0,1],[162,121,15,1],[188,53,33,1],[255,208,130,1]],[[10,186,181,1],[58,203,199,1],[106,219,216,1],[153,236,234,1],[201,252,251,1]],[[8,158,42,1],[9,42,100,1],[90,204,191,1],[229,4,4,1],[251,235,175,1]],[[187,187,136,1],[204,198,141,1],[238,170,136,1],[238,194,144,1],[238,221,153,1]],[[121,219,204,1],[134,78,65,1],[234,169,167,1],[242,199,196,1],[248,245,226,1]],[[96,136,213,1],[114,170,222,1],[157,200,233,1],[192,222,245,1],[217,239,244,1]],[[30,30,30,1],[177,255,0,1],[209,210,212,1],[242,240,240,1]],[[255,102,0,1],[255,153,0,1],[255,204,0,1],[255,255,204,1],[255,255,255,1]],[[35,15,43,1],[130,179,174,1],[188,227,197,1],[235,235,188,1],[242,29,65,1]],[[212,238,94,1],[225,237,185,1],[240,242,235,1],[244,250,210,1],[255,66,66,1]],[[20,32,71,1],[168,95,59,1],[247,92,92,1],[255,255,255,1]],[[63,184,240,1],[80,208,240,1],[196,251,93,1],[224,240,240,1],[236,255,224,1]],[[185,222,81,1],[209,227,137,1],[224,72,145,1],[225,183,237,1],[245,225,226,1]],[[185,222,81,1],[209,227,137,1],[224,72,145,1],[225,183,237,1],[245,225,226,1]],[[17,68,34,1],[51,170,170,1],[51,221,51,1],[221,238,68,1],[221,238,187,1]],[[46,13,35,1],[245,72,40,1],[247,128,60,1],[248,228,193,1],[255,237,191,1]],[[204,243,144,1],[224,224,90,1],[247,196,31,1],[252,147,10,1],[255,0,61,1]],[[18,18,18,1],[255,89,56,1],[255,255,255,1]],[[53,38,48,1],[85,72,101,1],[205,91,81,1],[233,223,204,1],[243,163,107,1]],[[236,250,1,1],[236,250,2,1],[247,220,2,1],[248,227,113,1],[250,173,9,1]],[[77,129,121,1],[161,129,121,1],[236,85,101,1],[249,220,159,1],[254,157,93,1]],[[4,0,4,1],[65,61,61,1],[75,0,15,1],[200,255,0,1],[250,2,60,1]],[[66,50,56,1],[179,112,45,1],[200,209,151,1],[235,33,56,1],[245,222,140,1]],[[143,153,36,1],[172,201,95,1],[241,57,109,1],[243,255,235,1],[253,96,129,1]],[[18,18,18,1],[23,122,135,1],[250,245,240,1],[255,180,143,1]],[[67,197,210,1],[182,108,97,1],[241,155,140,1],[254,247,237,1],[255,234,215,1]],[[78,205,196,1],[85,98,112,1],[196,77,88,1],[199,244,100,1],[255,107,107,1]],[[0,0,0,1],[137,161,160,1],[154,227,226,1],[255,71,103,1],[255,118,5,1]],[[248,200,221,1],[253,231,120,1],[255,61,61,1],[255,92,143,1],[255,103,65,1]],[[23,138,132,1],[145,145,145,1],[229,255,125,1],[235,143,172,1],[255,255,255,1]],[[73,112,138,1],[136,171,194,1],[202,255,66,1],[208,224,235,1],[235,247,248,1]],[[51,222,245,1],[122,245,51,1],[245,51,145,1],[245,161,52,1],[248,248,101,1]],[[57,13,45,1],[172,222,178,1],[225,234,181,1],[237,173,158,1],[254,75,116,1]],[[192,107,129,1],[233,22,67,1],[245,175,145,1],[247,201,182,1],[249,210,182,1]],[[131,196,192,1],[156,100,53,1],[190,215,62,1],[237,66,98,1],[240,233,226,1]],[[136,145,136,1],[191,218,223,1],[207,246,247,1],[233,26,82,1],[237,242,210,1]],[[64,44,56,1],[209,212,169,1],[227,164,129,1],[245,215,165,1],[255,111,121,1]],[[93,65,87,1],[131,134,137,1],[168,202,186,1],[202,215,178,1],[235,227,170,1]],[[0,168,198,1],[64,192,203,1],[143,190,0,1],[174,226,57,1],[249,242,231,1]],[[0,204,190,1],[9,166,163,1],[157,191,175,1],[237,235,201,1],[252,249,216,1]],[[0,205,172,1],[2,170,176,1],[22,147,165,1],[127,255,36,1],[195,255,104,1]],[[51,39,23,1],[107,172,191,1],[157,188,188,1],[240,240,175,1],[255,55,15,1]],[[51,51,53,1],[101,99,106,1],[139,135,149,1],[193,190,200,1],[233,232,238,1]],[[17,118,109,1],[65,9,54,1],[164,11,84,1],[228,111,10,1],[240,179,0,1]],[[73,10,61,1],[138,155,15,1],[189,21,80,1],[233,127,2,1],[248,202,0,1]],[[71,162,145,1],[144,79,135,1],[213,28,122,1],[219,213,139,1],[244,127,143,1]],[[55,191,230,1],[169,232,250,1],[186,255,21,1],[211,255,106,1],[247,239,236,1]],[[69,173,168,1],[84,121,128,1],[89,79,79,1],[157,224,173,1],[229,252,194,1]],[[248,241,224,1],[249,246,241,1],[250,244,227,1],[251,106,79,1],[255,193,150,1]],[[0,98,125,1],[1,64,87,1],[51,50,49,1],[66,153,15,1],[255,255,255,1]],[[52,17,57,1],[53,150,104,1],[60,50,81,1],[168,212,111,1],[255,237,144,1]],[[0,153,137,1],[163,169,72,1],[206,24,54,1],[237,185,46,1],[248,89,49,1]],[[26,31,30,1],[108,189,181,1],[147,204,198,1],[200,214,191,1],[227,223,186,1]],[[165,222,190,1],[183,234,201,1],[251,178,163,1],[252,37,55,1],[255,215,183,1]],[[26,20,14,1],[90,142,161,1],[204,65,65,1],[255,255,255,1]],[[51,51,51,1],[111,111,111,1],[204,204,204,1],[255,100,0,1],[255,255,255,1]],[[51,145,148,1],[167,2,103,1],[241,12,73,1],[246,216,107,1],[251,107,65,1]],[[31,3,51,1],[31,57,77,1],[39,130,92,1],[112,179,112,1],[171,204,120,1]],[[209,242,165,1],[239,250,180,1],[245,105,145,1],[255,159,128,1],[255,196,140,1]],[[60,54,79,1],[109,124,157,1],[124,144,179,1],[149,181,194,1],[185,224,220,1]],[[35,179,218,1],[153,214,241,1],[168,153,241,1],[208,89,218,1],[248,78,150,1]],[[85,66,54,1],[96,185,154,1],[211,206,61,1],[241,239,165,1],[247,120,37,1]],[[20,20,20,1],[177,198,204,1],[255,239,94,1],[255,255,255,1]],[[136,238,208,1],[202,224,129,1],[239,67,53,1],[242,205,79,1],[246,139,54,1]],[[53,38,29,1],[95,79,69,1],[151,123,105,1],[206,173,142,1],[253,115,26,1]],[[68,66,89,1],[159,189,166,1],[219,101,68,1],[240,145,67,1],[252,177,71,1]],[[191,208,0,1],[196,60,39,1],[233,60,31,1],[242,83,58,1],[242,240,235,1]],[[43,43,43,1],[53,54,52,1],[230,50,75,1],[242,227,198,1],[255,198,165,1]],[[23,20,38,1],[26,15,12,1],[207,207,207,1],[240,240,240,1],[255,77,148,1]],[[28,1,19,1],[107,1,3,1],[163,0,6,1],[194,26,1,1],[240,60,2,1]],[[10,10,10,1],[140,97,70,1],[214,179,156,1],[242,76,61,1],[255,255,255,1]],[[46,13,35,1],[245,72,40,1],[247,128,60,1],[248,228,193,1],[255,237,191,1]],[[0,62,95,1],[0,67,132,1],[22,147,165,1],[150,207,234,1],[247,249,114,1]],[[66,29,56,1],[87,0,69,1],[190,226,232,1],[205,255,24,1],[255,8,90,1]],[[47,59,97,1],[121,128,146,1],[187,235,185,1],[233,236,229,1],[255,103,89,1]],[[58,17,28,1],[87,73,81,1],[131,152,142,1],[188,222,165,1],[230,249,188,1]],[[147,193,196,1],[198,182,204,1],[242,202,174,1],[250,12,195,1],[255,123,15,1]],[[255,3,149,1],[255,9,3,1],[255,139,3,1],[255,216,3,1],[255,251,3,1]],[[4,0,4,1],[254,26,138,1],[254,53,26,1],[254,143,26,1],[254,240,26,1]],[[125,173,154,1],[196,199,169,1],[249,213,177,1],[254,126,142,1],[255,62,97,1]],[[69,38,50,1],[145,32,77,1],[226,247,206,1],[228,132,74,1],[232,191,86,1]],[[0,0,0,1],[38,173,228,1],[77,188,233,1],[209,231,81,1],[255,255,255,1]],[[44,87,133,1],[209,19,47,1],[235,241,247,1],[237,214,130,1]],[[92,172,196,1],[140,209,157,1],[206,232,121,1],[252,182,83,1],[255,82,84,1]],[[58,68,8,1],[74,88,7,1],[125,146,22,1],[157,222,13,1],[199,237,14,1]],[[22,147,167,1],[200,207,2,1],[204,12,57,1],[230,120,30,1],[248,252,193,1]],[[59,12,44,1],[210,255,31,1],[250,244,224,1],[255,106,0,1],[255,195,0,1]],[[44,13,26,1],[52,158,151,1],[200,206,19,1],[222,26,114,1],[248,245,193,1]],[[28,20,13,1],[203,232,107,1],[242,233,225,1],[255,255,255,1]],[[75,88,191,1],[161,206,247,1],[247,255,133,1],[255,54,134,1]],[[74,95,103,1],[92,55,75,1],[204,55,71,1],[209,92,87,1],[217,212,168,1]]];n.prototype.getPalette=function(t){return s(u[Math.floor(t)])},n.prototype.getCount=function(){return u.length},n.prototype.getRandomPalette=function(){var t=Math.floor(u.length*Math.random());return this.getPalette(t)};var c=new n;i.exports=c}),define("famous-modifiers/Camera",["require","exports","module","famous/Transitionable","famous/Matrix","famous/Utility"],function(t,e,i){function n(t){this._renderMatrix=r.identity,this._scaleState=new s([1,1,1]),this._skewState=new s([0,0,0]),this._rotateState=new s([0,0,0]),this._translateState=new s([0,0,0]),this._dirty=!1,t&&this.lookAt(t)}function o(){var t=r.scale.apply(this,this._scaleState.get()),e=r.skew.apply(this,this._skewState.get()),i=r.rotate.apply(this,this._rotateState.get()),n=r.move(r.multiply(t,e,i),this._translateState.get());return r.inverse(n)}var s=t("famous/Transitionable"),r=t("famous/Matrix"),a=t("famous/Utility");n.prototype.halt=function(){this._scaleState.halt(),this._skewState.halt(),this._rotateState.halt(),this._translateState.halt()},n.prototype.getScale=function(){return this._scaleState.get()},n.prototype.setScale=function(t,e,i){return this._dirty=!0,this._scaleState.set(t,e,i)},n.prototype.getSkew=function(){return this._skewState.get()},n.prototype.setSkew=function(t,e,i){return this._dirty=!0,this._skewState.set(t,e,i)},n.prototype.getRotation=function(){return this._rotateState.get()},n.prototype.setRotation=function(t,e,i){return this._dirty=!0,this._rotateState.set(t,e,i)},n.prototype.getSpin=n.prototype.getRotation,n.prototype.setSpin=n.prototype.setRotation,n.prototype.getPos=function(){return this._translateState.get()},n.prototype.setPos=function(t,e,i){return this._dirty=!0,this._translateState.set(t,e,i)},n.prototype.lookAt=function(t,e,i){var n=void 0;i&&(n=a.after(4,i)),this.halt();var o=r.interpret(t);this.setScale(o.scale,e,n),this.setSkew(o.skew,e,n),this.setRotation(o.rotate,e,n),this.setPos(o.translate,e,n)},n.prototype.render=function(t){return this._dirty|=this._scaleState.isActive()||this._skewState.isActive()||this._rotateState.isActive()||this._translateState.isActive(),this._dirty&&(this._renderMatrix=o.call(this),this._dirty=!1),{transform:this._renderMatrix,group:!0,target:t}},i.exports=n}),define("famous-sync/MouseSync",["require","exports","module","famous/EventHandler"],function(t,e,i){function n(t,e){this.targetGet=t,this.options={direction:void 0,rails:!1,scale:1,stallTime:50,propogate:!0},e?this.setOptions(e):this.setOptions(this.options),this.input=new u,this.output=new u,u.setInputHandler(this,this.input),u.setOutputHandler(this,this.output),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0,this.input.on("mousedown",o.bind(this)),this.input.on("mousemove",s.bind(this)),this.input.on("mouseup",r.bind(this)),this.options.propogate?this.input.on("mouseleave",a.bind(this)):this.input.on("mouseleave",r.bind(this))}function o(t){t.preventDefault(),this._prevCoord=[t.clientX,t.clientY],this._prevTime=Date.now(),this._prevVel=void 0!==this.options.direction?0:[0,0],this.output.emit("start")}function s(t){if(this._prevCoord){var e=this._prevCoord,i=this._prevTime,o=[t.clientX,t.clientY],s=Date.now(),r=o[0]-e[0],a=o[1]-e[1];this.options.rails&&(Math.abs(r)>Math.abs(a)?a=0:r=0);var u,c,h=Math.max(s-i,8),l=r/h,p=a/h,f=this.targetGet(),d=this.options.scale;this.options.direction==n.DIRECTION_X?(u=f+d*r,c=d*l):this.options.direction==n.DIRECTION_Y?(u=f+d*a,c=d*p):(u=[f[0]+d*r,f[1]+d*a],c=[d*l,d*p]),this.output.emit("update",{p:u,v:c}),this._prevCoord=o,this._prevTime=s,this._prevVel=c}}function r(){if(this._prevCoord){var t=this._prevTime,e=Date.now();e-t>this.options.stallTime&&(this._prevVel=void 0==this.options.direction?[0,0]:0);var i=this.targetGet();this.output.emit("end",{p:i,v:this._prevVel}),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0}}function a(){if(this._prevCoord){var t=function(t){s.call(this,t)}.bind(this),e=function(i){r.call(this,i),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}.bind(this);document.addEventListener("mousemove",t),document.addEventListener("mouseup",e)}}var u=t("famous/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime),void 0!==t.propogate&&(this.options.propogate=t.propogate)},i.exports=n}),define("famous-modifiers/Draggable",["require","exports","module","famous/Matrix","famous-sync/MouseSync","famous-sync/TouchSync","famous-sync/GenericSync","famous/Transitionable","famous/EventHandler"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._positionState=new f([0,0]),this._cursorPos=[0,0],this._active=!0,this.sync=new p(function(){return this._cursorPos}.bind(this),{scale:this.options.scale,syncClasses:[h,l]}),this.eventOutput=new d,d.setInputHandler(this,this.sync),d.setOutputHandler(this,this.eventOutput),a.call(this)}function o(){var t=this.getPosition();this._cursorPos=t.slice(),this.eventOutput.emit("dragstart",{p:t})}function s(t){this._active&&(this.setPosition(u.call(this,t.p),this.options.transition),this._cursorPos=t.p),this.eventOutput.emit("dragmove",{p:this.getPosition()})}function r(){this.eventOutput.emit("dragend",{p:this.getPosition()})}function a(){this.sync.on("start",o.bind(this)),this.sync.on("update",s.bind(this)),this.sync.on("end",r.bind(this))}function u(t){var e=this.options,i=e.projection,n=e.maxX,o=e.maxY,s=e.snapX,r=e.snapY,a=i&m.x?t[0]:0,u=i&m.y?t[1]:0;return s>0&&(a-=a%s),r>0&&(u-=u%r),a=Math.max(Math.min(a,n),-n),u=Math.max(Math.min(u,o),-o),[a,u]}var c=t("famous/Matrix"),h=t("famous-sync/MouseSync"),l=t("famous-sync/TouchSync"),p=t("famous-sync/GenericSync"),f=t("famous/Transitionable"),d=t("famous/EventHandler"),m={x:1,y:2};n.DEFAULT_OPTIONS={projection:m.x|m.y,scale:1,maxX:1/0,maxY:1/0,snapX:0,snapY:0,transition:{duration:0}},n.prototype.setOptions=function(t){var e=this.options;if(void 0!==t.projection){var i=t.projection;this.options.projection=0,["x","y"].forEach(function(t){-1!=i.indexOf(t)&&(e.projection|=m[t])})}void 0!==t.scale&&(e.scale=t.scale),void 0!==t.maxX&&(e.maxX=t.maxX),void 0!==t.maxY&&(e.maxY=t.maxY),void 0!==t.snapX&&(e.snapX=t.snapX),void 0!==t.snapY&&(e.snapY=t.snapY),void 0!==t.transition&&(e.transition=t.transition)},n.prototype.getPosition=function(){return this._positionState.get()},n.prototype.setPosition=function(t,e,i){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(t,e,i)},n.prototype.activate=function(){this._active=!0},n.prototype.deactivate=function(){this._active=!1},n.prototype.toggle=function(){this._active=!this._active},n.prototype.render=function(t){var e=this.getPosition();return{transform:c.translate(e[0],e[1]),target:t}},i.exports=n}),define("famous-physics/constraints/Collision",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector","famous/EventHandler"],function(t,e,i){function n(t){this.opts={restitution:.5},t&&this.setOpts(t),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.n=new s,this.vRel=new s,this.I=new s,this.disp=new s}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector"),r=t("famous/EventHandler");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e){if(void 0!==e)for(var i=e.p,n=e.r,o=e.v,s=this.n,r=this.I,a=this.vRel,u=this.disp,c=this.opts.restitution,h=0;h<t.length;h++){var l=t[h];if(e!=l){var p=l.p,f=l.r,d=e.mInv;u.set(i.sub(p));var m=u.norm(),v=n+f-m;if(v>0){s.set(u.normalize());var g={target:l,source:e,overlap:v,normal:s};this.eventOutput.emit("preCollision",g),this.eventOutput.emit("collision",g);
var y=l.v,b=l.mInv;a.set(o.sub(y)),r.set(s.mult((1+c)*a.dot(s)/(d+b))),o.sub(r.mult(d),o),i.add(s.mult(v/2),i),y.add(r.mult(b),y),p.add(s.mult(-v/2),p),this.eventOutput.emit("postCollision",g)}}}},i.exports=n}),define("famous-physics/math/vector",["require","exports","module"],function(t,e,i){function n(t,e,i){return 1===arguments.length?this.set(t):(this.x=t||0,this.y=e||0,this.z=i||0),this}var o=new n(0,0,0);n.prototype.add=function(t,e){return e=e||o,e.setXYZ(this.x+(t.x||0),this.y+(t.y||0),this.z+(t.z||0))},n.prototype.sub=function(t,e){return e=e||o,e.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},n.prototype.mult=function(t,e){return e=e||o,e.setXYZ(t*this.x,t*this.y,t*this.z)},n.prototype.div=function(t,e){return this.mult(1/t,e)},n.prototype.cross=function(t,e){return e=e||o,e.setXYZ(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},n.prototype.equals=function(t){return t.x==this.x&&t.y==this.y&&t.z==this.z},n.prototype.rotateX=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(i,-s*a+n*r,s*r-n*a)},n.prototype.rotateY=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(-s*a+i*r,n,s*r+i*a)},n.prototype.rotateZ=function(t,e){e=e||o;var i=this.x,n=this.y,s=this.z,r=Math.cos(t),a=Math.sin(t);return e.setXYZ(-n*a+i*r,n*r+i*a,s)},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},n.prototype.normSquared=function(){return this.dot(this)},n.prototype.norm=function(){return Math.sqrt(this.normSquared())},n.prototype.normalize=function(t,e){t=void 0!==t?t:1,e=e||o;var i=1e-7,n=this.norm();return Math.abs(n)>i?this.mult(t/n,e):e.setXYZ(t,0,0)},n.prototype.clone=function(){return new n(this)},n.prototype.isZero=function(){return!(this.x||this.y||this.z)},n.prototype.set=function(t){return t instanceof Array?this.setFromArray(t):(this.x=t.x,this.y=t.y,this.z=t.z||0),this!==o&&o.clear(),this},n.prototype.setFromArray=function(t){this.x=t[0],this.y=t[1],this.z=t[2]||0},n.prototype.put=function(t){t.set(o)},n.prototype.setXYZ=function(t,e,i){return o.clear(),this.x=t,this.y=e,this.z=i,this},n.prototype.clear=function(){this.x=0,this.y=0,this.z=0},n.prototype.cap=function(t,e){if(1/0===t)return this;e=e||o;var i=this.norm();return i>t?this.normalize(t,e):this},n.prototype.project=function(t,e){return e=e||o,t.mult(this.dot(t),e)},n.prototype.reflectAcross=function(t,e){return e=e||o,t.normalize(),this.sub(this.project(t).mult(2),e)},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.get=function(){return this.toArray()},i.exports=n}),define("famous-physics/constraints/CollisionJacobian",["require","exports","module","famous-physics/constraints/Constraint","famous-physics/math/vector","famous/EventHandler"],function(t,e,i){function n(t){this.opts={k:.5,restitution:.5},t&&this.setOpts(t),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.n=new s,this.pDiff=new s,this.vDiff=new s,this.impulse1=new s,this.impulse2=new s,this.slop=0}var o=t("famous-physics/constraints/Constraint"),s=t("famous-physics/math/vector"),r=t("famous/EventHandler");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){if(void 0!==e)for(var n=e.v,o=e.p,s=e.mInv,r=e.r,a=this.opts.k,u=this.n,c=this.pDiff,h=this.vDiff,l=this.impulse1,p=this.impulse2,f=e.restitution,d=0;d<t.length;d++){var m=t[d];if(m!=e){var v=m.v,g=m.p,y=m.mInv,b=m.r,w=m.restitution,S=void 0!==this.opts.restitution?this.opts.restitution:Math.sqrt(f*w);c.set(g.sub(o)),h.set(v.sub(n));var _=c.norm(),x=_-(r+b),C=1/(s+y),O=0;if(0>x){u.set(c.normalize());var T={target:m,source:e,overlap:x,normal:u};this.eventOutput.emit("preCollision",T),this.eventOutput.emit("collision",T);var k=x<=this.slop?((1+S)*u.dot(h)+a/i*(x-this.slop))/(O+i/C):(1+S)*u.dot(h)/(O+i/C);u.mult(i*k).put(l),l.mult(-1).put(p),e.applyImpulse(l),m.applyImpulse(p),o.add(u.mult(x/2),o),g.add(u.mult(-x/2),g),this.eventOutput.emit("postCollision",T)}}}},i.exports=n}),define("famous-physics/constraints/Curve",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector"],function(t,e,i){function n(t){this.opts={f:function(t,e){return 100*Math.sin(t/100)-e},df:void 0,g:function(t,e,i){return i},dg:void 0,dampingRatio:0,period:0},t&&this.setOpts(t),this.J=new s,this.impulse=new s}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){for(var n=this.impulse,o=this.J,s=this.opts.f,r=this.opts.f,a=this.opts.df,u=this.opts.dg,c=0,h=0;h<t.length;h++){var l=t[h],p=l.v,f=l.p,d=l.m;if(0==this.opts.period)var m=0,v=1;else var g=4*d*Math.PI*this.opts.dampingRatio/this.opts.period,y=4*d*Math.PI*Math.PI/(this.opts.period*this.opts.period),m=1/(g+i*y),v=i*y/(g+i*y);if(void 0===a){var b=1e-7,w=s(f.x,f.y,f.z),S=(s(f.x+b,f.y,f.z)-w)/b,_=(s(f.x,f.y+b,f.z)-w)/b,x=(s(f.x,f.y,f.z+b)-w)/b,C=r(f.x,f.y,f.z),O=(r(f.x+b,f.y,f.z)-C)/b,T=(r(f.x,f.y+b,f.z)-C)/b,k=(r(f.x,f.y,f.z+b)-C)/b;o.setXYZ(S+O,_+T,x+k)}else{var E=a(f.x,f.y,f.z),I=u(f.x,f.y,f.z);o.setXYZ(E[0]+I[0],E[1]+I[1],E[2]+I[2])}var M=v/i*(s(f.x,f.y,f.z)+r(f.x,f.y,f.z)),z=-(o.dot(p)+M)/(m+i*o.normSquared()/d);n.set(o.mult(i*z)),l.applyImpulse(n),c+=Math.abs(z)}return c},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},i.exports=n}),define("famous-physics/constraints/Distance",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector"],function(t,e,i){function n(t){this.opts={length:0,anchor:void 0,dampingRatio:0,period:0},t&&this.setOpts(t),this.impulse=new s,this.n=new s,this.diffP=new s,this.diffV=new s}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor.p instanceof s&&(this.opts.anchor=t.anchor.p),t.anchor instanceof s&&(this.opts.anchor=t.anchor),t.anchor instanceof Array&&(this.opts.anchor=new s(t.anchor))),void 0!==t.length&&(this.opts.length=t.length),void 0!==t.dampingRatio&&(this.opts.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.opts.period=t.period)},n.prototype.setAnchor=function(t){void 0===this.opts.anchor&&(this.opts.anchor=new s),this.opts.anchor.set(t)},n.prototype.applyConstraint=function(t,e,i){var n=this.n,o=this.diffP,s=this.diffV,r=this.impulse;if(e)var a=e.p,u=e.mInv,c=e.v;else var a=this.opts.anchor,u=0;for(var h=this.opts.length,l=0,p=0;p<t.length;p++){var f=t[p],d=f.v,m=f.p,v=f.mInv;o.set(m.sub(a)),n.set(o.normalize());var g=o.norm()-h;e?s.set(d.sub(c)):s.set(d);var y=1/(v+u);if(0==this.opts.period)var b=0,w=1;else var S=4*y*Math.PI*this.opts.dampingRatio/this.opts.period,_=4*y*Math.PI*Math.PI/(this.opts.period*this.opts.period),b=1/(S+i*_),w=i*_/(S+i*_);var x=w/i*g,C=-(n.dot(s)+x)/(b+i/y);r.set(n.mult(i*C)),f.applyImpulse(r),e&&e.applyImpulse(r.mult(-1)),l+=Math.abs(C)}return l},i.exports=n}),define("famous-physics/constraints/Distance1D",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector"],function(t,e,i){function n(t){this.opts={length:0,anchor:void 0,dampingRatio:0,period:0},t&&this.setOpts(t),this.impulse=new s}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){var n,o,s=this.impulse;if(e)var r=e.p.x,a=e.mInv,u=e.v.x;else var r=this.opts.anchor,a=0;for(var c=this.opts.length,h=this.opts.period,l=this.opts.dampingRatio,p=0,f=0;f<t.length;f++){var d=t[f],m=d.v.x,v=d.p.x,g=d.mInv;n=v-r;var y=n-c;o=e?m-u:m;var b=1/(g+a);if(0==h)var w=0,S=1;else var _=4*b*Math.PI*l/h,x=4*b*Math.PI*Math.PI/(h*h),w=1/(_+i*x),S=i*x/(_+i*x);var C=S/i*y,O=-(o+C)/(w+i/b);s.setXYZ(i*O,0,0),d.applyImpulse(s),e&&e.applyImpulse(s.mult(-1)),p+=Math.abs(O)}return p},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init instanceof Function&&t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},i.exports=n}),define("famous-physics/constraints/Rod",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector"],function(t,e,i){function n(t){this.opts={length:0,anchor:void 0,stiffness:1},t&&this.setOpts(t),this.disp=new s,this.push=new s}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor.p instanceof s&&(this.opts.anchor=t.anchor.p),t.anchor instanceof Array&&(this.opts.anchor=new s(t.anchor)),delete t.anchor);for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){var n=this.opts,o=this.disp,s=this.push,r=n.length,a=n.stiffness,u=n.anchor||e.p,c=t[0],h=c.p;o.set(h.sub(u));var l=o.norm(),p=(r-l)/l;Math.abs(p)>0&&(o.mult(.5*p*a,s),c.immunity||(h.add(s,h),c.v.add(s.div(i),c.v)),e&&!e.immunity&&(e.p.sub(s,e.p),e.v.sub(s.div(i),e.v)))},i.exports=n}),define("famous-physics/constraints/Rope",["require","exports","module","famous-physics/constraints/Constraint","famous-physics/math/Vector"],function(t,e,i){function n(t){this.opts={length:0,anchor:void 0,dampingRatio:0,period:0},t&&this.setOpts(t),this.impulse=new s,this.n=new s,this.diffP=new s,this.diffV=new s}var o=t("famous-physics/constraints/Constraint"),s=t("famous-physics/math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor instanceof s&&(this.opts.anchor=t.anchor),t.anchor.p instanceof s&&(this.opts.anchor=t.anchor.p),t.anchor instanceof Array&&(this.opts.anchor=new s(t.anchor))),void 0!==t.length&&(this.opts.length=t.length),void 0!==t.dampingRatio&&(this.opts.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.opts.period=t.period)},n.prototype.applyConstraint=function(t,e,i){var n=this.n,o=this.diffP,s=this.diffV,r=this.impulse;if(e)var a=e.p,u=e.mInv,c=e.v;else var a=this.opts.anchor,u=0;for(var h=this.opts.length,l=0,p=0;p<t.length;p++){var f=t[p],d=f.v,m=f.p,v=f.mInv;o.set(m.sub(a));var g=o.norm()-h;if(0>g)return;n.set(o.normalize()),e?s.set(d.sub(c)):s.set(d);var y=1/(v+u);if(0==this.opts.period)var b=0,w=1;else var S=4*y*Math.PI*this.opts.dampingRatio/this.opts.period,_=4*y*Math.PI*Math.PI/(this.opts.period*this.opts.period),b=1/(S+i*_),w=i*_/(S+i*_);var x=w/i*g,C=-(n.dot(s)+x)/(b+i/y);r.set(n.mult(i*C)),f.applyImpulse(r),e&&e.applyImpulse(r.mult(-1)),l+=Math.abs(C)}return l},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},i.exports=n}),define("famous-physics/constraints/StiffSpring",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector","famous/EventHandler"],function(t,e,i){function n(t){this.opts={length:0,anchor:void 0,dampingRatio:1,period:1e3,restTolerance:1e-5},t&&this.setOpts(t),this.pDiff=new u,this.vDiff=new u,this.n=new u,this.impulse1=new u,this.impulse2=new u,this.eventOutput=void 0,this._atRest=!1}function o(t,e){t<this.opts.restTolerance?(this._atRest||this.eventOutput.emit("atRest",{particle:e}),this._atRest=!0):this._atRest=!1}function s(t,e,i){var n=Math.abs(t.dot(e)/i);return n}function r(){this.eventOutput=new c,this.eventOutput.bindThis(this),c.setOutputHandler(this,this.eventOutput)}var a=t("famous-physics/constraints/Constraint"),u=t("../math/Vector"),c=t("famous/EventHandler");n.prototype=Object.create(a.prototype),n.prototype.constructor=a,n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor instanceof u&&(this.opts.anchor=t.anchor),t.anchor.p instanceof u&&(this.opts.anchor=t.anchor.p),t.anchor instanceof Array&&(this.opts.anchor=new u(t.anchor))),void 0!==t.length&&(this.opts.length=t.length),void 0!==t.dampingRatio&&(this.opts.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.opts.period=t.period),void 0!==t.restTolerance&&(this.opts.restTolerance=t.restTolerance)},n.prototype.setAnchor=function(t){void 0===this.opts.anchor&&(this.opts.anchor=new u),this.opts.anchor.set(t)},n.prototype.applyConstraint=function(t,e,i){for(var n=this.opts,r=this.pDiff,a=this.vDiff,u=this.impulse1,c=this.impulse2,h=n.length,l=n.anchor||e.p,p=n.period,f=n.dampingRatio,d=0;d<t.length;d++){var m=t[d],v=m.p,g=m.v,y=m.m,b=m.mInv;r.set(v.sub(l));var w=r.norm()-h;if(e){var S=e.mInv,_=e.v;a.set(g.sub(_));var x=1/(b+S)}else{a.set(g);var x=y}if(0==this.opts.period)var C=0,O=1;else var T=4*x*Math.PI*Math.PI/(p*p),k=4*x*Math.PI*f/p,O=i*T/(k+i*T),C=1/(k+i*T);var E=O/i*w;if(r.normalize(-E).sub(a).mult(i/(C+i/x)).put(u),m.applyImpulse(u),e&&(u.mult(-1).put(c),e.applyImpulse(c)),this.eventOutput){var I=m.getEnergy()+s(u,r,i);o.call(this,I,m)}}},n.prototype.getEnergy=function(t,e){var i=this.opts,n=i.length,o=i.period,s=i.anchor||e.p;if(0===o)return 0;var r=4*t.m*Math.PI*Math.PI/(o*o),a=s.sub(t.p),u=a.norm()-n;return.5*r*u*u},n.prototype.on=function(){return r.call(this),this.on.apply(this,arguments)},n.prototype.unbind=function(){return r.call(this),this.unbind.apply(this,arguments)},n.prototype.pipe=function(){return r.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return r.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous-physics/constraints/Surface",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector"],function(t,e,i){function n(t){this.opts={f:void 0,df:void 0,dampingRatio:0,period:0},t&&this.setOpts(t),this.J=new s,this.impulse=new s,this.eps=1e-7}var o=t("famous-physics/constraints/Constraint"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.applyConstraint=function(t,e,i){for(var n=this.impulse,o=this.J,s=this.opts.f,r=this.opts.df,a=0,u=0;u<t.length;u++){var c=t[u],h=c.v,l=c.p,p=c.m;if(0==this.opts.period)var f=0,d=1;else var m=4*p*Math.PI*this.opts.dampingRatio/this.opts.period,v=4*p*Math.PI*Math.PI/(this.opts.period*this.opts.period),f=1/(m+i*v),d=i*v/(m+i*v);if(void 0===r){var g=this.eps,y=s(l.x,l.y,l.z),b=(s(l.x+g,l.y,l.z)-y)/g,w=(s(l.x,l.y+g,l.z)-y)/g,S=(s(l.x,l.y,l.z+g)-y)/g;o.setXYZ(b,w,S)}else o.setXYZ.apply(o,r(l.x,l.y,l.z));var _=d/i*s(l.x,l.y,l.z),x=-(o.dot(h)+_)/(f+i*o.normSquared()/p);n.set(o.mult(i*x)),c.applyImpulse(n),a+=Math.abs(x)}return a},n.prototype.setupSlider=function(t,e){e=e||t.opts.name,t.setOpts({value:this.opts[e]}),t.init(),t.on("change",function(t){this.opts[e]=t.value}.bind(this))},i.exports=n}),define("famous-physics/constraints/Wall",["require","exports","module","famous-physics/constraints/Constraint","../math/Vector","famous/EventHandler"],function(t,e,i){function n(t){this.opts={restitution:.7,k:0,n:new r,d:0,onContact:n.ON_CONTACT.REFLECT},t&&this.setOpts(t),this.diff=new r,this.impulse=new r,this.slop=-1,this.eventOutput=void 0}function o(){this.eventOutput=new a,this.eventOutput.bindThis(this),a.setOutputHandler(this,this.eventOutput)}var s=t("famous-physics/constraints/Constraint"),r=t("../math/Vector"),a=t("famous/EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=s,n.ON_CONTACT={REFLECT:0,WRAP:1,ABSORB:2},n.prototype.setOpts=function(t){void 0!==t.restitution&&(this.opts.restitution=t.restitution),void 0!==t.k&&(this.opts.k=t.k),void 0!==t.d&&(this.opts.d=t.d),void 0!==t.onContact&&(this.opts.onContact=t.onContact),void 0!==t.n&&this.opts.n.set(t.n)},n.prototype.getNormalVelocity=function(t){var e=this.opts.n;return t.dot(e)},n.prototype.getDistance=function(t){var e=this.opts.n,i=this.opts.d;return t.dot(e)+i},n.prototype.onEnter=function(t,e,i){var o=t.p,s=t.v,r=t.m,a=this.opts.n,u=this.opts.onContact,c=this.opts.restitution,h=this.impulse,l=this.opts.k,p=0;if(this.eventOutput){var f={particle:t,wall:this,overlap:e};this.eventOutput.emit("preCollision",f),this.eventOutput.emit("collision",f)}switch(u){case n.ON_CONTACT.REFLECT:var d=e<this.slop?-((1+c)*a.dot(s)+l/i*(e-this.slop))/(r*i+p):-((1+c)*a.dot(s))/(r*i+p);h.set(a.mult(i*d)),t.applyImpulse(h),o.add(a.mult(-e),o);break;case n.ON_CONTACT.ABSORB:var d=a.dot(s)/(r*i+p);h.set(a.mult(i*d)),t.applyImpulse(h),o.add(a.mult(-e),o),s.clear();break;case n.ON_CONTACT.WRAP:if(e<-t.r)break}this.eventOutput&&this.eventOutput.emit("postCollision",f)},n.prototype.onExit=function(t,e){var i=this.opts.onContact,o=t.p,s=this.opts.n;i==n.ON_CONTACT.REFLECT?o.add(s.mult(-e),o):i==n.ON_CONTACT.WRAP||i==n.ON_CONTACT.ABSORB},n.prototype.applyConstraint=function(t,e,i){for(var n=this.opts.n,o=0;o<t.length;o++){var s=t[o],r=s.p,a=s.v,u=s.r||0,c=this.getDistance(r.add(n.mult(-u))),h=this.getNormalVelocity(a);0>c&&(0>h?this.onEnter(s,c,i):this.onExit(s,c,i))}},n.prototype.on=function(){return o.call(this),this.on.apply(this,arguments)},n.prototype.unbind=function(){return o.call(this),this.unbind.apply(this,arguments)},n.prototype.pipe=function(){return o.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return o.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),define("famous-physics/constraints/Walls",["require","exports","module","famous-physics/constraints/Constraint","famous-physics/math/Vector","famous-physics/constraints/Wall"],function(t,e,i){function n(t){this.opts={sides:n.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],k:0,restitution:.5,onContact:n.ON_CONTACT.REFLECT},this.setSize(this.opts.size,this.opts.origin),this.setOptsForEach({restitution:this.opts.restitution,k:this.opts.k}),t&&this.setOpts(t)}var o=t("famous-physics/constraints/Constraint"),s=t("famous-physics/math/Vector"),r=t("famous-physics/constraints/Wall");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.SIDES={LEFT:new r({n:new s(1,0,0)}),RIGHT:new r({n:new s(-1,0,0)}),TOP:new r({n:new s(0,1,0)}),BOTTOM:new r({n:new s(0,-1,0)}),FRONT:new r({n:new s(0,0,1)}),BACK:new r({n:new s(0,0,-1)})},n.TWO_DIMENSIONAL=[n.SIDES.LEFT,n.SIDES.RIGHT,n.SIDES.TOP,n.SIDES.BOTTOM],n.THREE_DIMENSIONAL=[n.SIDES.LEFT,n.SIDES.RIGHT,n.SIDES.TOP,n.SIDES.BOTTOM,n.SIDES.FRONT,n.SIDES.BACK],n.ON_CONTACT=r.ON_CONTACT,n.prototype.setOpts=function(t){var e=!1;void 0!==t.restitution&&this.setOptsForEach({restitution:t.restitution}),void 0!==t.k&&this.setOptsForEach({k:t.k}),void 0!==t.size&&(this.opts.size=t.size,e=!0),void 0!==t.sides&&(this.opts.sides=t.sides),void 0!==t.onContact&&(this.opts.onContact=t.onContact,this.setOnContact(t.onContact)),void 0!==t.origin&&(this.opts.origin=t.origin,e=!0),e&&this.setSize(this.opts.size,this.opts.origin)},n.prototype.setSize=function(t,e){e=e||this.opts.origin,e.length<3&&(e[2]=.5),n.SIDES.LEFT.setOpts({d:t[0]*e[0]}),n.SIDES.TOP.setOpts({d:t[1]*e[1]}),n.SIDES.FRONT.setOpts({d:t[2]*e[2]}),n.SIDES.RIGHT.setOpts({d:t[0]*(1-e[0])}),n.SIDES.BOTTOM.setOpts({d:t[1]*(1-e[1])}),n.SIDES.BACK.setOpts({d:t[2]*(1-e[2])}),this.opts.size=t,this.opts.origin=e},n.prototype.setOptsForEach=function(t){this.forEachWall(function(e){e.setOpts(t)});for(var e in t)this.opts[e]=t[e]},n.prototype.setOnContact=function(t){switch(this.forEachWall(function(e){e.setOpts({onContact:t})}),t){case n.ON_CONTACT.REFLECT:break;case n.ON_CONTACT.WRAP:this.forEachWall(function(e){e.setOpts({onContact:t}),e.on("wrap",function(t){var i=t.particle,o=e.opts.n,s=e.opts.d;switch(e){case n.SIDES.RIGHT:var r=n.SIDES.LEFT.opts.d;break;case n.SIDES.LEFT:var r=n.SIDES.TOP.opts.d;break;case n.SIDES.TOP:var r=n.SIDES.BOTTOM.opts.d;break;case n.SIDES.BOTTOM:var r=n.SIDES.TOP.opts.d}i.p.add(o.mult(s+r),i.p)})});break;case n.ON_CONTACT.ABSORB:}},n.prototype.applyConstraint=function(t,e,i){this.forEachWall(function(n){n.applyConstraint(t,e,i)})},n.prototype.forEachWall=function(t){for(var e=0;e<this.opts.sides.length;e++)t(this.opts.sides[e])},n.prototype.rotateZ=function(t){this.forEachWall(function(e){var i=e.opts.n;i.rotateZ(t).put(i)})},n.prototype.rotateX=function(t){this.forEachWall(function(e){var i=e.opts.n;i.rotateX(t).put(i)})},n.prototype.rotateY=function(t){this.forEachWall(function(e){var i=e.opts.n;i.rotateY(t).put(i)})},i.exports=n}),define("famous-physics/math/matrix",["require","exports","module"],function(require,exports,module){function Matrix(t,e,i,n){this.nRows=t,this.nCols=e,this.values=i||[[]],n&&this.loop(n)}Matrix.prototype={loop:function(t){for(var e=this.values,i=0;i<this.nRows;i++){e[i]=[];for(var n=0;n<this.nCols;n++)e[i][n]=t(i,n)}return this},set:function(t){return this.values=t,this},create:function(t){return this.loop(t)},identity:function(){return this.loop(function(t,e){return t==e?1:0})},print:function(){for(var row=0;row<this.nRows;row++){for(var str="console.log(",col=0;col<this.nCols;col++)str+="this.values["+row+"]["+col+"].toFixed(1)",col<this.nCols-1&&(str+=",");str+=")",eval(str)}},rightMult:function(t,e){t.nRows!=this.nCols&&console.warn("cant multiply");for(var i=this.values,n=t.values,o=this.nRows,s=t.nCols,r=[],a=0;o>a;a++){r[a]=[];for(var u=0;s>u;u++){for(var c=0,h=0;h<this.nCols;h++)c+=i[a][h]*n[h][u];r[a][u]=c}}return e?e.set(r):new Matrix(o,s).set(r)},vMult:function(t){for(var e=t.length,i=[],n=0;n<this.nRows;n++){for(var o=0,s=0;e>s;s++)o+=this.values[n][s]*t[s];i[n]=o}return i},diag:function(t){var e=function(e,i){return e==i?t[e]:0};return this.loop(e)},transpose:function(t){var e=function(t,e){return this.values[e][t]}.bind(this);return t?t.loop(e):new Matrix(this.nCols,this.nRows,[[]],e)}},module.exports=Matrix}),define("famous-physics/math/GaussSeidel",["require","exports","module"],function(t,e,i){function n(t,e){this.numIterations=t||10,this.tolerance=e||1e-7,this.prevX=[],this.x=[]}function o(){for(var t=0,e=this.x.length,i=0;e>i;i++)t+=Math.pow(this.prevX[i]-this.x[i],2)/(this.x[i]*this.x[i]);return Math.sqrt(t)}n.prototype.solve=function(t,e){for(var i,n=this.numIterations,s=e.length,r=this.x,a=this.prevX,u=0;s>u;u++)this.x[u]=0;for(var c=0,h=1/0;n>c&&h>this.tolerance;){for(var u=0;s>u;u++){a[u]=r[u],i=0;for(var l=0;s>l;l++)l!=u&&(i+=t[u][l]*r[l]);r[u]=(e[u]-i)/t[u][u]}h=o(),c++}return r},i.exports=n}),define("famous-physics/constraints/joint",["require","exports","module","../math/matrix","../math/GaussSeidel","../math/Vector"],function(t,e,i){function n(t){this.opts={length:0},t&&this.setOpts(t);var e=10,i=1e-5;this.solver=new s(e,i)}var o=t("../math/matrix"),s=t("../math/GaussSeidel"),r=t("../math/Vector");n.prototype.getPosition=function(t,e,i){var n=2,s=1,a=[],u=[],c=[],h=[],l=[],p=t;a[0]=p.getVel(),u[0]=p.p,c[0]=p.mInv,h[0]=p.f,l[0]=p.m,a[1]=e.v,u[1]=e.p,c[1]=e.mInv,h[1]=e.f,l[1]=e.m;for(var f=[],d=0;s>d;d++){f[d]=[];for(var m=0;n>m;m++){var v;m==d?v=u[d].sub(u[d+1]):m==d+1&&(v=u[d+1].sub(u[d])),f[d][3*m+0]=v.x,f[d][3*m+1]=v.y,f[d][3*m+2]=v.z}}var g=new o(s,3*n);g.set(f);for(var y=[],d=0;s>d;d++){y[d]=[];for(var m=0;n>m;m++){var v;m==d?v=a[d].sub(a[d+1]):m==d+1&&(v=a[d+1].sub(a[d])),y[d][3*m+0]=v.x,y[d][3*m+1]=v.y,y[d][3*m+2]=v.z}}for(var b=[],w=[],S=0;n>S;S++)b[3*S+0]=c[S],b[3*S+1]=c[S],b[3*S+2]=c[S],w[3*S+0]=a[S].x,w[3*S+1]=a[S].y,w[3*S+2]=a[S].z;var _=new o(3*n,3*n).diag(b),x=new o(s,s);g.rightMult(_).rightMult(g.transpose(),x);for(var C=g.vMult(w),O=1,T=[],S=0;s>S;S++){var k=this.length,E=u[S+1].sub(u[S]).normSquared();T[S]=.5*(E-k*k)}for(var I=[],M=0;s>M;M++)I[M]=-C[M]-O/i*T[M];for(var z=this.solver.solve(x.values,I),A=g.transpose().vMult(z),F=[],S=0;n>S;S++)F[S]=new r(A[3*S+0],A[3*S+1],A[3*S+2]);for(var S=0;n>S;S++){var w=a[S],P=l[S],R=F[S];(0!=S||0!=p.id)&&(1==S&&0==p.id?w.add(R.sub(F[0]).div(P),w):w.add(R.div(P),w))}},n.prototype.getError=function(){},i.exports=n}),define("famous-physics/forces/Repulsion",["require","exports","module","famous-physics/forces/Force","famous-physics/math/Vector"],function(t,e,i){function n(t){this.opts={strength:1,anchor:void 0,radii:{min:0,max:1/0},cutoff:0,cap:1/0,decayFunction:n.DECAY_FUNCTIONS.GRAVITY},t&&this.setOpts(t),this.setOpts(t),this.disp=new s,o.call(this)}var o=t("famous-physics/forces/Force"),s=t("famous-physics/math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.DECAY_FUNCTIONS={LINEAR:function(t,e){return Math.max(1-1/e*t,0)},MORSE:function(t,e){var i=0==e?100:e,n=t+i*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(n/i-1),2),0)},INVERSE:function(t,e){return 1/(1-e+t)},GRAVITY:function(t,e){return 1/(1-e+t*t)}},n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor.p instanceof s&&(this.opts.anchor=t.anchor.p),t.anchor instanceof Array&&(this.opts.anchor=new s(t.anchor)),delete t.anchor);for(var e in t)this.opts[e]=t[e]},n.prototype.applyForce=function(t,e){var i=this.opts,n=this.force,o=this.disp,s=i.strength,r=i.anchor||e.p,a=i.cap,u=i.cutoff,c=i.radii.max,h=i.radii.min,l=i.decayFunction;if(0!=s)for(var p in t){var f=t[p];if(f!=e){var d=f.m,m=f.p;o.set(m.sub(r));var v=o.norm();c>v&&v>h&&(n.set(o.normalize(s*d*l(v,u)).cap(a)),f.applyForce(n))}}},i.exports=n}),define("famous-physics/forces/TorqueSpring",["require","exports","module","famous-physics/forces/Force","famous-physics/math/Vector"],function(t,e,i){function n(t){this.opts={period:300,dampingRatio:0,length:0,lMin:0,lMax:1/0,anchor:void 0,forceFunction:n.FORCE_FUNCTIONS.HOOK,callback:void 0,callbackTolerance:1e-7},t&&this.setOpts(t),this.torque=new u,this.init(),this._canFireCallback=void 0,a.call(this),this.disp=new u(0,0,0)}function o(t){this.forceFunction=t}function s(t){t.stiffness=Math.pow(2*Math.PI/t.period,2)}function r(t){t.damping=4*Math.PI*t.dampingRatio/t.period}var a=t("famous-physics/forces/Force"),u=t("famous-physics/math/Vector");n.prototype=Object.create(a.prototype),n.prototype.constructor=a,n.FORCE_FUNCTIONS={FENE:function(t,e){var i=.99*e,n=Math.max(Math.min(t,i),-i);return n/(1-n*n/(e*e))},HOOK:function(t){return t}},n.prototype.init=function(){var t=this.opts;o.call(this,t.forceFunction),s.call(this,t),r.call(this,t)},n.prototype.applyForce=function(t){for(var e=this.torque,i=this.opts,n=this.disp,o=i.stiffness,s=i.damping,r=i.length,a=i.anchor,u=0;u<t.length;u++){var c=t[u];n.set(a.sub(c.q));var h=n.norm()-r;if(0==h)return;var l=c.m;o*=l,s*=l,e.set(n.normalize(o*this.forceFunction(h,this.opts.lMax))),s&&e.add(c.w.mult(-s),e),c.applyTorque(e)}},n.prototype.setOpts=function(t){void 0!==t.anchor&&(t.anchor.p instanceof u&&(this.opts.anchor=t.anchor.p),t.anchor instanceof u&&(this.opts.anchor=t.anchor),t.anchor instanceof Array&&(this.opts.anchor=new u(t.anchor))),void 0!==t.period&&(this.opts.period=t.period),void 0!==t.dampingRatio&&(this.opts.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.opts.length=t.length),void 0!==t.lMin&&(this.opts.lMin=t.lMin),void 0!==t.lMax&&(this.opts.lMax=t.lMax),void 0!==t.forceFunction&&(this.opts.forceFunction=t.forceFunction),void 0!==t.callback&&(this.opts.callback=t.callback),void 0!==t.callbackTolerance&&(this.opts.callbackTolerance=t.callbackTolerance),this.init()},i.exports=n}),define("famous-physics/forces/VectorField",["require","exports","module","famous-physics/forces/Force","../math/Vector"],function(t,e,i){function n(t){this.opts={strength:1,field:n.FIELDS.CONSTANT},t&&this.setOpts(t),this.setFieldOptions(this.opts.field),this.timeDependent=3==this.opts.field.length,this.tOrig=void 0,this.register=new s(0,0,0),o.call(this)}var o=t("famous-physics/forces/Force"),s=t("../math/Vector");n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.FIELDS={CONSTANT:function(t,e){return t.set(e.direction)},LINEAR:function(t,e){return t.set(t.mult(e.k))},RADIAL_GRAVITY:function(t){return t.set(t.mult(-1,t))},SPHERE_ATTRACTOR:function(t,e){return t.set(t.mult((e.radius-t.norm())/t.norm()))},POINT_ATTRACTOR:function(t,e){return t.set(e.p.sub(t))}},n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},n.prototype.evaluate=function(t,e){return this.register.set(t),this.opts.field(this.register,this.opts,e)},n.prototype.applyForce=function(t){var e,i=this.force;this.timeDependent?(this.tOrig&&(this.tOrig=Date.now()),e=.001*(Date.now()-this.tOrig)):e=void 0;for(var n=0;n<t.length;n++){var o=t[n];i.set(this.evaluate(o.p,e).mult(o.m*this.opts.strength)),o.applyForce(i)}},n.prototype.setFieldOptions=function(t){var e=n.FIELDS;switch(t){case e.CONSTANT:this.opts.direction||(this.opts.direction=new s(0,1,0));break;case e.POINT_ATTRACTOR:this.opts.p||(this.opts.p=new s(0,0,0));break;case e.SPHERE_ATTRACTOR:this.opts.radius||(this.opts.radius=1);break;case e.LINEAR:this.opts.k||(this.opts.k=1)}},i.exports=n}),define("famous-physics/forces/rotationalDrag",["require","exports","module","famous-physics/forces/Force","famous-physics/math/Vector"],function(t,e,i){function n(t){this.opts={strength:.01,forceFunction:n.FORCE_FUNCTIONS.LINEAR},t&&this.setOpts(t),o.call(this)}{var o=t("famous-physics/forces/Force");t("famous-physics/math/Vector")}n.prototype=Object.create(o.prototype),n.prototype.constructor=o,n.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},n.prototype.applyForce=function(t){var e=this.opts.strength,i=this.opts.forceFunction,n=this.force;for(var o in t){var s=t[o];i(s.w).mult(-100*e).put(n),s.applyTorque(n)}},n.prototype.setOpts=function(t){for(var e in t)this.opts[e]=t[e]},i.exports=n}),define("famous-physics/integrator/verlet",["require","exports","module","../math/Vector"],function(t,e,i){function n(t){t=t||{},this.vCap=t.vCap||1/0,this.aCap=t.aCap||1/0,this.drag=t.drag||1,this.diff=new o,this.pOldCopy=new o,this.dragVector=new o}var o=t("../math/Vector");n.prototype.integrate=function(t,e,i){var n=t.pOld,o=t.p,s=t.a;if(this.diff.set(o.sub(n)),i){var r=t.v;t.hasImmunity("velocity")||r.add(s.mult(.5*e),r),t.hasImmunity("position")||(n.set(o),o.add(r.mult(e),o))}else this.pOldCopy.set(n),t.hasImmunity("position")||(this.dragVector.set(this.diff.mult(this.drag)),n.set(o),o.add(s.mult(e*e),o),o.add(this.dragVector,o))},n.prototype.integrateVelocity=function(t,e,i){var n=t.p,o=t.a;if(i){var s=t.v;s.add(o.mult(.5*e),s),n.add(s.mult(e),n)}else n.add(o.mult(e*e),n)},n.prototype.integratePosition=function(t){var e=t.p,i=t.pOld,n=this.pOldCopy;n.set(i),i.set(e),e.add(e.sub(n).mult(this.drag),e)},i.exports=n}),define("famous-physics/math/Random",["require","exports","module"],function(t,e,i){function n(t,e){return t+Math.random()*(e-t)}function o(t,e){return Math.floor(t+Math.random()*(e-t+1))}i.exports={integer:function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var n=[],s=0;i>s;s++)n.push(o(t,e));return n}return o(t,e)},range:function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var o=[],s=0;i>s;s++)o.push(n(t,e));return o}return n(t,e)},sign:function(t){return t=void 0!==t?t:.5,Math.random()<t?1:-1},bool:function(t){return t=void 0!==t?t:.5,Math.random()<t}}}),define("famous-physics/utils/PhysicsTransition",["require","exports","module","famous-physics/PhysicsEngine","famous-physics/constraints/StiffSpring","famous-physics/constraints/Wall","famous-physics/math/Vector"],function(t,e,i){function n(t){this.defaultDefinition={spring:{period:300,dampingRatio:.5},v:0,wall:!1},t=t||0,this._anchor=new y(t,0,0),this.endState=t,this.prevState=void 0,this.direction=void 0,this.atRest=!0,this.spring=new v({anchor:this._anchor}),this.wall=new g({restitution:.5,k:0,n:new y(-1,0,0)}),this.attachedWall=void 0,this.PE=new m,this.particle=this.PE.createParticle({p:[t,0,0]}),this.attachedSpring=this.PE.attach(this.spring,this.particle)}function o(){if(!this.atRest){this.PE.step();var t=s.call(this);b>t&&(this.atRest=!0,h.call(this,this.endState),this.callback&&this.callback())}}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function r(t){this.spring.setOpts(t.spring),l.call(this,t.v),t.wall?u.call(this):c.call(this)
}function a(t){this.prevState=this.endState,this.endState=t,this.direction=this.endState-this.prevState>0?1:this.endState<0?-1:0,void 0!==this.attachedSpring&&(this._anchor.x=t),void 0!==this.attachedWall&&this.wall.setOpts({d:Math.abs(t),n:[-this.direction,0,0]}),l.call(this,this.direction*f.call(this))}function u(){this.attachedWall=this.PE.attach(this.wall,this.particle)}function c(){void 0!==this.attachedWall&&this.PE.detach(this.attachedWall)}function h(t){this.particle.p.x=t}function l(t){this.particle.v.x=t}function p(){return this.particle.p.x}function f(){return this.particle.v.x}function d(t){this.callback=t}var m=t("famous-physics/PhysicsEngine"),v=t("famous-physics/constraints/StiffSpring"),g=t("famous-physics/constraints/Wall"),y=t("famous-physics/math/Vector");n.forceFunctions=v.forceFunctions;var b=1e-5;n.prototype.reset=function(t,e){t=t||0,e=e||0,this.prevState=void 0,h.call(this,t),l.call(this,e),a.call(this,t),d.call(this,void 0)},n.prototype.getVelocity=function(){return o.call(this),f.call(this)},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return o.call(this),p.call(this)},n.prototype.set=function(t,e,i){return e?(this.atRest=!1,r.call(this,e),a.call(this,t),d.call(this,i),void 0):(this.reset(t),i&&i(),void 0)},i.exports=n}),define("famous-physics/utils/PhysicsTransition2",["require","exports","module","famous-physics/PhysicsEngine","famous-physics/constraints/StiffSpring","famous-physics/forces/VectorField","famous-physics/constraints/Wall","famous-physics/math/Vector","famous/EventHandler"],function(t,e,i){function n(t){t=t||0,this.endState=t,this.prevState=void 0,this.direction=void 0,this.defaultDefinition={transition:{curve:{v:1,thrust:0},duration:500},bounce:{period:0,dampingRatio:0},walls:!1},this._anchor=new O(t,0,0),this.stageOneActive=!1,this.attachedSpring=void 0,this.attachedWall=void 0,this.attachedThrust=void 0,this.eventHandler=new T,this.eventHandler.on("initStageTwo",v.bind(this)),this.PE=new S,this.particle=this.PE.createBody({p:[t,0,0],v:[0,0,0]}),this.spring=new _({anchor:this._anchor}),this.thrust=new x({strength:0,field:x.FIELDS.CONSTANT,direction:[1,0,0]}),this.wall=new C({restitution:.5,k:0,n:new O(-1,0,0)})}function o(){return this.particle.p.x<=this.endState?1:-1}function s(t){this.direction=t}function r(){1==this.stageOneActive&&this.direction!=o.call(this)&&this.eventHandler.emit("initStageTwo")}function a(t){var e,i,o=t.transition.duration,s=t.transition.curve;"string"==typeof s&&(s=n.TRANSITIONS[s]),i=this.direction*s.v,e=this.direction*s.thrust;var r=this.endState-this.particle.p.x;if(0==o)this.v=i||0,this.a=0;else{var a;0==e?a=r/(i*o):(0>i*i+2*e*r&&console.warn("unphysical choices for (v,a), target cannot be reached"),a=r>0?(-i+Math.sqrt(i*i+2*e*r))/(e*o):(-i-Math.sqrt(i*i+2*e*r))/(e*o)),this.v=a*i,this.a=a*a*e}var u=t.bounce;"string"==typeof u&&(u=n.BOUNCE[u]),this.spring.setOpts({period:u.period,dampingRatio:u.dampingRatio}),this.wallsActive=t.walls}function u(t){this.prevState=this.endState,this.endState=t,s.call(this,o.call(this))}function c(t){void 0===this.attachedSpring&&(this._anchor.x=t,this.attachedSpring=this.PE.attach(this.spring,this.particle))}function h(){void 0!==this.attachedSpring&&(this.PE.detach(this.attachedSpring,this.particle),this.attachedSpring=void 0)}function l(t,e){this.wallsActive&&(this.wall.setOpts({d:Math.abs(t),n:[-e,0,0]}),this.attachedWall=this.PE.attach(this.wall,this.particle))}function p(){void 0!==this.attachedWall&&(this.PE.detach(this.attachedWall,this.particle),this.attachedWall=void 0)}function f(t){this.thrust.setOpts({strength:t}),this.attachedThrust=this.PE.attach(this.thrust,this.particle)}function d(){void 0!==this.attachedThrust&&(this.PE.detach(this.attachedThrust),this.attachedThrust=void 0)}function m(){this.stageOneActive=!0,h.call(this),d.call(this),p.call(this),f.call(this,this.a),g.call(this,this.v),k=Date.now()}function v(){console.log("Duration : ",Date.now()-k),this.stageOneActive=!1,d.call(this),y.call(this,this.endState),c.call(this,this.endState),l.call(this,this.endState,this.direction)}function g(t){this.particle.v.x=t}function y(t){this.particle.p.x=t}function b(t){this.spring.setOpts({callback:t})}function w(){this.PE.step(),r.call(this)}var S=t("famous-physics/PhysicsEngine"),_=t("famous-physics/constraints/StiffSpring"),x=t("famous-physics/forces/VectorField"),C=t("famous-physics/constraints/Wall"),O=t("famous-physics/math/Vector"),T=t("famous/EventHandler");n.TRANSITIONS={linear:{v:1,thrust:0},easeIn:{v:0,thrust:2},backIn:{v:-1,thrust:2}},n.BOUNCE={none:{dampingRatio:0,period:0},low:{dampingRatio:.5,period:300},medium:{dampingRatio:.3,period:600},high:{dampingRatio:.1,period:800}};var k;n.forceFunctions=_.forceFunctions,n.prototype.reset=function(t,e){e=e||0,t=t||0,this.PE.detachAll(),y.call(this,t),g.call(this,e),b.call(this,void 0)},n.prototype.set=function(t,e,i){return e?(u.call(this,t),a.call(this,e),b.call(this,i),m.call(this),void 0):(this.reset(t),i&&i(),void 0)},n.prototype.get=function(){return w.call(this),this.particle.p.x},n.prototype.getVelocity=function(){return w.call(this),this.particle.v.x},n.prototype.getTarget=function(){return this.endState},i.exports=n}),define("famous-physics/utils/SpringTransition",["require","exports","module","famous-physics/PhysicsEngine","famous-physics/forces/Spring","famous-physics/math/Vector"],function(t,e,i){function n(t){t=t||0,this._anchor=new m(t,0,0),this.endState=t,this.prevState=void 0,this.atRest=!0,this.spring=new d({anchor:this._anchor}),this.PE=new f,this.particle=this.PE.createParticle({p:[t,0,0]}),this.PE.attach(this.spring,this.particle)}function o(){if(!this.atRest){this.PE.step();var t=s.call(this);v>t&&(this.atRest=!0,u.call(this,this.endState),this.callback&&this.callback())}}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function r(t){var e=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),t.period<150&&console.warn("period may be unstable, increase the period or use a stiff transition"),this.spring.setOpts({period:t.period,dampingRatio:t.dampingRatio}),c.call(this,t.velocity)}function a(t){this.prevState=this.endState,this.endState=t;var e;e=this.endState-this.prevState>0?1:this.endState<0?-1:0,this._anchor.x=t,c.call(this,e*l.call(this))}function u(t){this.particle.p.x=t}function c(t){this.particle.v.x=t}function h(){return this.particle.p.x}function l(){return this.particle.v.x}function p(t){this.callback=t}var f=t("famous-physics/PhysicsEngine"),d=t("famous-physics/forces/Spring"),m=t("famous-physics/math/Vector");n.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},n.forceFunctions=d.forceFunctions;var v=1e-5;n.prototype.reset=function(t,e){t=t||0,e=e||0,this.prevState=void 0,u.call(this,t),c.call(this,e),a.call(this,t),p.call(this,void 0)},n.prototype.getVelocity=function(){return o.call(this),l.call(this)},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return o.call(this),h.call(this)},n.prototype.set=function(t,e,i){return e?(this.atRest=!1,r.call(this,e),a.call(this,t),p.call(this,i),void 0):(this.reset(t),i&&i(),void 0)},i.exports=n}),define("famous-physics/utils/StiffSpringTransition",["require","exports","module","famous-physics/PhysicsEngine","famous-physics/constraints/StiffSpring","famous-physics/math/Vector"],function(t,e,i){function n(t){t=t||0,this._anchor=new m(t,0,0),this.endState=t,this.prevState=void 0,this.atRest=!0,this.spring=new d({anchor:this._anchor}),this.PE=new f,this.particle=this.PE.createParticle({p:[t,0,0]}),this.PE.attach(this.spring,this.particle)}function o(){if(!this.atRest){this.PE.step();var t=s.call(this);v>t&&(this.atRest=!0,u.call(this,this.endState),this.callback&&this.callback())}}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function r(t){var e=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),this.spring.setOpts({period:t.period,dampingRatio:t.dampingRatio}),c.call(this,t.velocity)}function a(t){this.prevState=this.endState,this.endState=t;var e;e=this.endState-this.prevState>0?1:this.endState<0?-1:0,this._anchor.x=t,c.call(this,e*l.call(this))}function u(t){this.particle.p.x=t}function c(t){this.particle.v.x=t}function h(){return this.particle.p.x}function l(){return this.particle.v.x}function p(t){this.callback=t}var f=t("famous-physics/PhysicsEngine"),d=t("famous-physics/constraints/StiffSpring"),m=t("famous-physics/math/Vector");n.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},n.forceFunctions=d.forceFunctions;var v=1e-5;n.prototype.reset=function(t,e){t=t||0,e=e||0,this.prevState=void 0,u.call(this,t),c.call(this,e),a.call(this,t),p.call(this,void 0)},n.prototype.getVelocity=function(){return o.call(this),l.call(this)},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return o.call(this),h.call(this)},n.prototype.set=function(t,e,i){return e?(this.atRest=!1,r.call(this,e),a.call(this,t),p.call(this,i),void 0):(this.reset(t),i&&i(),void 0)},i.exports=n}),define("famous-physics/utils/WallTransition",["require","exports","module","famous-physics/PhysicsEngine","famous-physics/forces/Spring","famous-physics/constraints/Wall","famous-physics/math/Vector"],function(t,e,i){function n(t){t=t||0,this._anchor=new v(t,0,0),this.endState=t,this.prevState=void 0,this.atRest=!0,this.spring=new d({anchor:this._anchor}),this.wall=new m,this.PE=new f,this.particle=this.PE.createParticle({p:[t,0,0]}),this.PE.attach(this.spring,this.particle),this.PE.attach(this.wall,this.particle)}function o(){if(!this.atRest){this.PE.step();var t=s.call(this);g>t&&(this.atRest=!0,u.call(this,this.endState),this.callback&&this.callback())}}function s(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function r(t){var e=n.DEFAULT_OPTIONS;void 0===t.period&&(t.period=e.period),void 0===t.dampingRatio&&(t.dampingRatio=e.dampingRatio),void 0===t.velocity&&(t.velocity=e.velocity),void 0===t.restitution&&(t.restitution=e.restitution),this.spring.setOpts({period:t.period,dampingRatio:t.dampingRatio}),this.wall.setOpts({restitution:t.restitution}),c.call(this,t.velocity)}function a(t){this.prevState=this.endState,this.endState=t;var e;e=this.endState-this.prevState>0?1:this.endState<0?-1:0,this._anchor.x=t,this.wall.setOpts({d:Math.abs(t),n:[-e,0,0]}),c.call(this,e*l.call(this))}function u(t){this.particle.p.x=t}function c(t){this.particle.v.x=t}function h(){return this.particle.p.x}function l(){return this.particle.v.x}function p(t){this.callback=t}var f=t("famous-physics/PhysicsEngine"),d=t("famous-physics/forces/Spring"),m=t("famous-physics/constraints/Wall"),v=t("famous-physics/math/Vector");n.DEFAULT_OPTIONS={period:300,dampingRatio:0,restitution:.4,velocity:0},n.forceFunctions=d.forceFunctions;var g=1e-5;n.prototype.reset=function(t,e){t=t||0,e=e||0,this.prevState=void 0,u.call(this,t),c.call(this,e),a.call(this,t),p.call(this,void 0)},n.prototype.getVelocity=function(){return o.call(this),l.call(this)},n.prototype.halt=function(){this.set(this.get())},n.prototype.get=function(){return o.call(this),h.call(this)},n.prototype.set=function(t,e,i){return e?(this.atRest=!1,r.call(this,e),a.call(this,t),p.call(this,i),void 0):(this.reset(t),i&&i(),void 0)},i.exports=n}),define("famous-sync/FastClick",["require","exports","module"],function(){if(window.CustomEvent){var t=300,e={};document.addEventListener("touchstart",function(t){for(var i=Date.now(),n=0;n<t.changedTouches.length;n++){var o=t.changedTouches[n];e[o.identifier]=i}}),window.addEventListener("touchmove",function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i];delete e[n.identifier]}}),document.addEventListener("touchend",function(i){for(var n=Date.now(),o=0;o<i.changedTouches.length;o++){var s=i.changedTouches[o],r=e[s.identifier];if(r&&t>n-r){i.preventDefault();var a=new CustomEvent("click",{bubbles:!0,details:s});i.target.dispatchEvent(a)}delete e[s.identifier]}})}}),define("famous-sync/TwoFingerSync",["require","exports","module","famous/EventHandler"],function(t,e,i){function n(t,e){this.targetGet=t,this.options={scale:1},e?this.setOptions(e):this.setOptions(this.options),this.input=new o,this.output=new o,o.setInputHandler(this,this.input),o.setOutputHandler(this,this.output),this.touchAId=void 0,this.posA=void 0,this.timestampA=void 0,this.touchBId=void 0,this.posB=void 0,this.timestampB=void 0,this.input.on("touchstart",this.handleStart.bind(this)),this.input.on("touchmove",this.handleMove.bind(this)),this.input.on("touchend",this.handleEnd.bind(this)),this.input.on("touchcancel",this.handleEnd.bind(this))}var o=t("famous/EventHandler");n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.handleStart=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e];this.touchAId?this.touchBId||(this.touchBId=i.identifier,this.posB=[i.pageX,i.pageY],this.timestampB=Date.now(),this._startUpdate()):(this.touchAId=i.identifier,this.posA=[i.pageX,i.pageY],this.timestampA=Date.now())}},n.prototype.handleMove=function(t){if(this.touchAId&&this.touchBId){for(var e,i=this.timestampA,n=this.timestampB,o=0;o<t.changedTouches.length;o++){var s=t.changedTouches[o];s.identifier==this.touchAId?(this.posA=[s.pageX,s.pageY],this.timestampA=Date.now(),e=this.timestampA-i):s.identifier==this.touchBId&&(this.posB=[s.pageX,s.pageY],this.timestampB=Date.now(),e=this.timestampB-n)}e&&this._moveUpdate(e)}},n.prototype.handleEnd=function(t){for(var e=this.targetGet(),i=this.options.scale,n=0;n<t.changedTouches.length;n++){var o=t.changedTouches[n];(o.identifier==this.touchAId||o.identifier==this.touchBId)&&(this.touchAId&&this.touchBId&&this.output.emit("end",{p:e,v:i*this._vel,touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAId=void 0,this.touchBId=void 0)}},i.exports=n}),define("famous-sync/PinchSync",["require","exports","module","./TwoFingerSync"],function(t,e,i){function n(t,e){s.call(this,t,e),this._dist=void 0}function o(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}var s=t("./TwoFingerSync");n.prototype=Object.create(s.prototype),n.prototype._startUpdate=function(){this._dist=o(this.posA,this.posB),this._vel=0,this.output.emit("start",{count:event.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist})},n.prototype._moveUpdate=function(t){var e=o(this.posA,this.posB),i=e-this._dist,n=i/t,s=this.targetGet(),r=this.options.scale;this.output.emit("update",{p:s+r*i,v:r*n,touches:[this.touchAId,this.touchBId],distance:e}),this._dist=e,this._vel=n},i.exports=n}),define("famous-sync/RotateSync",["require","exports","module","./TwoFingerSync"],function(t,e,i){function n(t,e){s.call(this,t,e),this._angle=void 0}function o(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.atan2(n,i)}var s=t("./TwoFingerSync");n.prototype=Object.create(s.prototype),n.prototype._startUpdate=function(){this._angle=o(this.posA,this.posB),this._vel=0,this.output.emit("start",{count:event.touches.length,touches:[this.touchAId,this.touchBId],angle:this._angle})},n.prototype._moveUpdate=function(t){var e=o(this.posA,this.posB),i=e-this._angle,n=i/t,s=this.targetGet(),r=this.options.scale;this.output.emit("update",{p:s+r*i,v:r*n,touches:[this.touchAId,this.touchBId],angle:e}),this._angle=e,this._vel=n},i.exports=n}),define("famous-sync/ScaleSync",["require","exports","module","./TwoFingerSync"],function(t,e,i){function n(t,e){r.call(this,t,e),this._startDist=void 0,this._prevScale=void 0,this.input.on("pipe",s.bind(this))}function o(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}function s(){this.touchAId=void 0,this.touchBId=void 0}var r=t("./TwoFingerSync");n.prototype=Object.create(r.prototype),n.prototype._startUpdate=function(){this._prevScale=1,this._startDist=o(this.posA,this.posB),this._vel=0,this.output.emit("start",{count:event.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist})},n.prototype._moveUpdate=function(t){var e=o(this.posA,this.posB),i=e/this._startDist,n=i-this._prevScale,s=n/t,r=this.targetGet(),a=this.options.scale;this.output.emit("update",{p:r+a*n,v:a*s,touches:[this.touchAId,this.touchBId],distance:e}),this._prevScale=i,this._vel=s},i.exports=n}),define("famous-utils/FormatTime",["require","exports","module"],function(t,e,i){function n(t,e){var i=t.toString().match(/(\d+)/g),n=new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5],0),r=new Date,a=.001*(r.getTime()-n.getTime()),u=parseInt(a/60,10),c=parseInt(u/60,10),h=parseInt(c/24,10),l=o(n),p=10,f="";return 720>u?60>u?2>u?(f="just now",p=1,[f,p]):30>u?(f=u+" minutes ago",p=2,[f,p]):40>u?(f="about a half hour ago",p=2,[f,p]):50>u?(f="about 45 minutes ago",p=3,[f,p]):(f="about an hour ago",p=4,[f,p]):(f=1==e?l[6]+":"+l[7]+l[8]:"earlier today at "+l[6]+":"+l[7]+l[8],p=5,[f,p]):1440>u?(f="yesterday at "+l[6]+":"+l[7]+l[8],p=6,[f,p]):h>=1&&2>=h?(f="yesterday at "+l[6]+":"+l[7]+l[8],p=7,[f,p]):6>h?(f=l[0]+" at "+l[6]+":"+l[7]+l[8],p=8,[f,p]):30>h?(f=1==e?l[3]+"/"+l[1]+" at "+l[6]+":"+l[7]+l[8]:l[4]+" "+l[1]+l[2]+" around "+l[6]+l[8],p=9,[f,p]):(f=s(l,r),p=10,[f,p])}function o(t){var e=t.getDate(),i=t.getDay(),n=t.getMonth()+1,o=t.getFullYear(),s=t.getHours(),r=t.getMinutes().toString(),a=12>s?"am":"pm";r.length<2&&(r="0"+r);var u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c={1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th",10:"th",11:"th",12:"th",13:"th",14:"th",15:"th",16:"th",17:"th",18:"th",19:"th",20:"th",21:"st",22:"nd",23:"rd",24:"th",25:"th",26:"th",27:"th",28:"th",29:"th",30:"th",31:"st"},h={1:"Jan",2:"Feb",3:"Mar",4:"April",5:"May",6:"June",7:"July",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"};return 0===s&&(s=12),s>12&&(s-=12),[u[i],e,c[e],n,h[n],o,s,r,a]}function s(t,e){var i=(e?e:new Date,e.getFullYear()===t[5]?t[4]+" "+t[1]+t[2]:t[4]+" "+t[1]+t[2]+" "+t[5]);return i}i.exports=n}),define("famous-utils/KeyCodes",["require","exports","module"],function(t,e,i){var n={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};i.exports=n}),define("famous-utils/NoiseImage",["require","exports","module"],function(t,e,i){function n(t,e,i){t||(t=[128,128]),e||(e=8),o.width=t[0],o.height=t[1];var n=e>>1,r=o.width/e,a=e*e>>1,u=1/n;c(i),s.fillRect(0,0,t[0],t[1]),c(i);for(var h,l,p=0;a>p;p++)Math.random()+.5>>0&&(l=p*u>>0,h=p-n*l,s.fillRect(h*r,l*r,r,r),s.fillRect((e-(h+1))*r,l*r,r,r));var f=o.toDataURL("image/png");return f}var o=document.createElement("canvas"),s=o.getContext("2d"),r=function(t){var e=361*Math.random()>>0,i=t?45*t-(46*Math.random()>>0):e;return i},a=function(){return 30+71*Math.random()>>0},u=function(){return 30+71*Math.random()>>0},c=function(t){s.fillStyle="hsl("+r(t)+","+a()+"%,"+u()+"%)"};i.exports={generate:n}}),define("famous-views/Accordion",["require","exports","module","famous/Matrix","famous/Transitionable","famous/Modifier","famous-animation/Easing"],function(t,e,i){function n(t){this.state=new s(0);var t=t||{};t.curve||(t.curve=r.inOutQuadNorm),t.duration||(t.duration=500);var e={curve:t.curve,duration:t.duration};this.options={transition:e},this.target=void 0,this._isOpen=!1}var o=t("famous/Matrix"),s=t("famous/Transitionable"),r=(t("famous/Modifier"),t("famous-animation/Easing"));n.prototype.render=function(){return this.state.get()?{transform:o.translate(0,(this.state.get()-1)*this.target.getSize()[1],100*(this.state.get()-1)),target:this.target.render()}:void 0},n.prototype.getSize=function(){var t=this.target.getSize();return[t[0],this.state.get()*t[1]]},n.prototype.show=function(t){this.target=t,this.open()},n.prototype.setState=function(t,e,i){this.state.halt(),this.state.set(t,e,i)},n.prototype.open=function(t){this._isOpen=!0,this.setState(1,this.options.transition,t)},n.prototype.close=function(t){this._isOpen=!1,this.setState(0,this.options.transition,t)},n.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},i.exports=n}),define("famous-views/ControlSet",["require","exports","module","famous/EventHandler","famous/Matrix"],function(t,e,i){function n(){this.eventOutput=new o,o.setOutputHandler(this,this.eventOutput),this.controls=[]}var o=t("famous/EventHandler"),s=t("famous/Matrix");n.prototype.include=function(t,e){e.on("change",function(e){this.eventOutput.emit(t,{value:e.value})}.bind(this)),this.controls.push(e)},n.prototype.render=function(){for(var t=[],e=0,i=0,n=0;n<this.controls.length;n++){var o=this.controls[n],r=o.getSize();t.push({transform:s.translate(0,e),target:o.render()}),e+=r[1],i=Math.max(i,r[0])}return{size:[i,e],target:t}},i.exports=n}),define("famous-views/EnergyHelper",["require","exports","module"],function(t,e,i){function n(t,e,i){this.x=0,this.v=0,this.agents=[],this.featureSize=i?i:.5,this.jitter=Math.min(1e-4,.1*this.featureSize),this.minStepTime=1,this.lastUpdateTime=Date.now(),this.atRest=!1,this.set(t,e)}n.drag=function(t){return function(e,i,n){return-t*i*i*n}},n.friction=function(t){return function(e,i,n){return-t*Math.abs(i)*n}},n.spring=function(t,e,i){e||(e=0),i||(i=0);var n=2*i*Math.sqrt(e);return function(i,o,s){var r=i-t,a=r+o*s,u=.5*e*r*r,c=.5*e*a*a,h=0>r/a?u:c-u,l=n*o*o*s;return-h-l}},n.springFENE=function(t,e,i,o){e||(e=0),i||(i=0),o||(o=0);var s=2*i*Math.sqrt(e),r=n.spring(t,e,i),a=!1;return function(i,n,u){var c=i-t,h=c+n*u;if(Math.abs(n)<1e-4&&Math.abs(h)<o&&(a=!1),a||Math.abs(c)>=o||Math.abs(h)>=o)return a=!0,r(i,n,u);var l=-.5*e*o*o*Math.log(o*o-c*c),p=-.5*e*o*o*Math.log(o*o-h*h),f=0>c/h?-l:p-l,d=s*n*n*u;return-f-d}},n.magnet=function(t,e){var i=.5;return e||(e=0),function(n,o,s){var r=n-t,a=r+o*s;if(Math.abs(r)<i&&Math.abs(a)<i)return-.5*o*o*s;var u=-e/Math.max(Math.abs(r),i),c=-e/Math.max(Math.abs(a),i),h=c-u;return-h}},n.prototype={_updateReset:function(){this.lastUpdateTime=Date.now(),this.atRest=!1},set:function(t,e){"number"==typeof t&&this.setPos(t),"number"==typeof e&&this.setVelo(e)},setPos:function(t){this.x=t,this._updateReset()},setVelo:function(t){this.v=t,this._updateReset()},addAgent:function(t){t instanceof Function||console.error("Invalid agent"),this.agents.indexOf(t)<0&&(this.agents.push(t),this.atRest=!1)},removeAgent:function(t){var e=this.agents.indexOf(t);e>=0&&(this.agents.splice(e,1),this.atRest=!1)},setAgents:function(t){this.agents=t.slice(0),this.atRest=!1},getPos:function(){return this.update(),this.x},getVelo:function(){return this.update(),this.v},update:function(t){for(t||(t=Date.now());this.lastUpdateTime<t;){var e=t-this.lastUpdateTime;this.v&&(e=Math.min(e,this.featureSize/Math.abs(this.v))),e=Math.max(e,this.minStepTime),this._step(e)}},_step:function(t){function e(t,e,n){for(var o=i.agents,s=0,r=0;r<o.length;r++)s+=o[r](t,e,n);return s}if(this.lastUpdateTime+=t,!this.atRest){var i=this,n=0,o=0;if(Math.abs(this.v)>this.jitter)n=e(this.x,this.v,t),o=this.v>0?1:-1;else{var s=e(this.x,this.jitter,t),r=e(this.x,-this.jitter,t);n=Math.max(s,r),o=s>r?1:-1,0>=s&&0>=r&&(this.atRest=!0)}var a=this.v,u=.5*a*a,c=u+n;if(0>c)this.x+=this.v*t*(c/n),this.v=0;else{var h=o*Math.sqrt(2*Math.abs(c));this.x+=this.v*t,this.v=h}this.atRest&&(this.x=Math.round(this.x/this.featureSize)*this.featureSize,this.v=0)}}},i.exports=n}),define("famous-views/Flip",["require","exports","module","famous/Matrix","famous/Transitionable","famous/RenderNode"],function(t,e,i){function n(t){this.options={transition:!0,cull:!0},t&&this.setOptions(t),this._side=0,this.state=new s(0),this.frontNode=new r,this.backNode=new r}var o=t("famous/Matrix"),s=t("famous/Transitionable"),r=t("famous/RenderNode");n.prototype.setDefaultTransition=function(t){this.transition=t},n.prototype.flip=function(t,e){void 0===t&&(t=1===this._side?0:1),this._side=t,this.state.set(t,this.options.transition,e)},n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.transition&&(this.options.transition=t.transition),void 0!==t.cull&&(this.options.cull=t.cull)},n.prototype.linkFront=function(t){return this.frontNode.link(t)},n.prototype.linkBack=function(t){return this.backNode.link(t)},n.prototype.render=function(t){var e=this.state.get();return void 0!==t?{transform:o.rotateY(Math.PI*e),target:t}:this.options.cull&&!this.state.isActive()?e?this.backNode.render():this.frontNode.render():[{transform:o.rotateY(Math.PI*e),target:this.frontNode.render()},{transform:o.rotateY(Math.PI*(e+1)),target:this.backNode.render()}]},i.exports=n}),define("famous-views/ScrollContainer",["require","exports","module","famous/ContainerSurface","famous/EventHandler","./Scrollview","famous/Utility"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.surface=new o(this.options.look),this.scrollview=new r(this.options.feel),t&&this.setOptions(t),this.surface.link(this.scrollview),s.setInputHandler(this,this.surface),s.setOutputHandler(this,this.surface),this.pipe(this.scrollview)}var o=t("famous/ContainerSurface"),s=t("famous/EventHandler"),r=t("./Scrollview"),a=t("famous/Utility");n.DEFAULT_OPTIONS={look:void 0,feel:{direction:a.Direction.X}},n.prototype.setOptions=function(t){void 0!==t.look&&(this.options.look=t.look,this.surface.setOptions(this.options.look)),void 0!==t.feel&&(this.options.feel=t.feel,this.scrollview.setOptions(this.options.feel))},n.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},n.prototype.render=function(){return this.surface.render.apply(this.surface,arguments)},i.exports=n}),define("famous-views/SequentialLayout",["require","exports","module","famous/Matrix","famous/Transitionable","famous/Modifier","famous/RenderNode","famous/ViewSequence","famous/Utility"],function(t,e,i){function n(t){this.items=void 0,this._size=void 0,this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t)}var o=t("famous/Matrix"),s=(t("famous/Transitionable"),t("famous/Modifier"),t("famous/RenderNode"),t("famous/ViewSequence")),r=t("famous/Utility");n.DEFAULT_OPTIONS={direction:r.Direction.X,defaultItemSize:[50,50],itemSpacing:0},n.prototype.getSize=function(){return this._size||this.render(),this._size},n.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new s(t)),this.items=t},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.defaultItemSize&&(this.options.defaultItemSize=t.defaultItemSize),void 0!==t.itemSpacing&&(this.options.itemSpacing=t.itemSpacing),void 0!==t.transition&&(this.options.transition=t.transition)},n.prototype.render=function(){for(var t=0,e=0,i=this.options.direction==r.Direction.X?0:1,n=this.options.direction==r.Direction.X?1:0,s=this.items,a=[];s;){var u=s.get();t&&(t+=this.options.itemSpacing);var c;u&&u.getSize&&(c=u.getSize()),c||(c=this.options.defaultItemSize),e&&c[n]!==!0&&(e=Math.max(e,c[n]));var h=this.options.direction==r.Direction.X?o.translate(t,0):o.translate(0,t);a.push({transform:h,target:u.render()}),c[i]&&c[i]!==!0&&(t+=c[i]),s=s.getNext()}return e||(e=void 0),this._size||(this._size=[0,0]),this._size[i]=t,this._size[n]=e,{group:!0,target:a}},i.exports=n}),define("famous-views/Shaper",["require","exports","module","famous/RenderNode","famous/Matrix","famous/Modifier","famous/Utility"],function(t,e,i){function n(t){this.nodes=[],this.transforms=[],this.defaultTransition={duration:1e3,curve:"easeInOut"};for(var e in t)this.side(e).from(t[e])}var o=t("famous/RenderNode"),s=t("famous/Matrix"),r=t("famous/Modifier"),a=t("famous/Utility");n.prototype.side=function(t){return this.nodes[t]||(this.transforms[t]=new r,this.transforms[t].setDefaultTransition(this.defaultTransition),this.nodes[t]=new o(this.transforms[t])),this.nodes[t]},n.prototype.halt=function(t){this.transforms[t].halt()},n.prototype.haltSet=function(t){for(var e=0;e<t.length;e++)this.halt(e)},n.prototype.haltAll=function(){this.haltSet(this.all())},n.prototype.set=function(t,e,i,n){return this.transforms[t]?(this.transforms[t].setTransform(e,i,n),void 0):(n&&n(),void 0)},n.prototype.setShape=function(t,e,i,n){for(var o="function"==typeof e?e:function(t){return e[t]},s=n?a.after(t.length,n):void 0,r=0;r<t.length;r++)this.set(t[r],o(r),i,s)},n.prototype.setShapeAll=function(t,e,i){this.setShape(this.all(),t,e,i)},n.prototype.modify=function(t,e,i,n){var o=s.multiply(this.transforms[t].getFinalTransform(),e);this.set(t,o,i,n)},n.prototype.modifySet=function(t,e,i,n){for(var o=n?a.after(t.length,n):void 0,s=0;s<t.length;s++)this.modify(t[s],e,i,o)},n.prototype.modifyAll=function(t,e,i){this.modify(this.all(),t,e,i)},n.prototype.setOpacity=function(t,e,i,n){this.transforms[t].setOpacity(e,i,n)},n.prototype.setOpacitySet=function(t,e,i,n){for(var o=n?a.after(t.length,n):void 0,s=0;s<t.length;s++)this.setOpacity(t[s],e,i,o)},n.prototype.setOpacityAll=function(t,e,i){this.setOpacitySet(this.all(),t,e,i)},n.prototype.all=function(){var t=[];for(var e in this.nodes)t.push(e);return t},n.prototype.getTransform=function(t){return this.transforms[t].getTransform()},n.prototype.getOpacity=function(t){return this.transforms[t].getOpacity()},n.prototype.isMoving=function(t){return this.transforms[t].isMoving()},n.prototype.render=function(){for(var t=[],e=0;e<this.nodes.length;e++)t[e]=this.nodes[e].execute();return t},i.exports=n}),define("famous-views/Swappable",["require","exports","module","famous/RenderNode","famous/Matrix","famous/Modifier"],function(t,e,i){function n(t){this.options={initTransform:u.identity,initOpacity:0,finalTransform:u.identity,finalOpacity:0,inTransition:{duration:500,curve:"easeInOut"},outTransition:{duration:500,curve:"easeInOut"},async:!1},this.nodes={},this.transforms=[],this.currIndex=-1,this.prevIndex=-1,this.setOptions(t)}function o(t,e,i,n,o,s,r){if(t in this.nodes){var a=this.nodes[t].modifiers[0];console.log(this.nodes[t]),a.isMoving&&!a.isMoving()&&(e&&a.setTransform(e),void 0!==i&&a.setOpacity(i)),a.setTransform(n,s),a.setOpacity(o,s,r)}}function s(t,e){o.call(this,t,this.options.initTransform,this.options.initOpacity,u.identity,1,this.options.inTransition,e)}function r(t,e){o.call(this,t,void 0,void 0,this.options.finalTransform,this.options.finalOpacity,this.options.outTransition,e)}var a=t("famous/RenderNode"),u=t("famous/Matrix"),c=t("famous/Modifier");n.prototype.item=function(t){var e=new a(new c(this.options.initTransform,this.options.initOpacity),!0);return this.nodes[t]=e,e},n.prototype.select=function(t,e){t!=this.currIndex&&(this.options.async?r.call(this,this.currIndex,function(){s.call(this,this.currIndex,e)}.bind(this)):(r.call(this,this.currIndex),s.call(this,t,e)),this.currIndex=t)},n.prototype.setOptions=function(t){for(var e in t)this.options[e]=t[e]},n.prototype.getOptions=function(){return this.options},n.prototype.render=function(){var t=[];for(var e in this.nodes)t.push(this.nodes[e].render());return t},i.exports=n}),define("famous-widgets/FeedItem",["require","exports","module","famous/Surface","famous/View","famous-utils/TimeAgo"],function(t,e,i){function n(t){s.apply(this,arguments),this.surface=new o({size:this.options.size,classes:this.options.classes}),t&&this.setOptions(t),this.surface.pipe(this.eventInput),this.optionsManager.on("change",function(t){if("content"==t.id)this.setContent(t.value);else{var e={};e[t.id]=t.value,this.surface.setOptions(e)}}.bind(this)),this.node.link(this.surface)}var o=t("famous/Surface"),s=t("famous/View"),r=t("famous-utils/TimeAgo");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={classes:["feedItem"],size:[void 0,80],content:{icon:void 0,source:void 0,time:void 0,text:""}},n.prototype.setContent=function(t){this.options.content=t;
var e=.6*this.options.size[1],i='<img src="'+t.icon+'" class="icon" width="'+e+'" height="'+e+'" />',n='<p class="source">'+t.source+"</p>",o='<p class="time">'+r.parse(t.time)+"</p>",s='<p class="text">'+t.text+"</p>";this.surface.setContent(i+o+n+s)},i.exports=n}),define("famous-widgets/FeedStream",["require","exports","module","famous/EventHandler","famous-views/Scrollview","./FeedItem"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.scrollview=new s({direction:"y",margin:0}),t&&this.setOptions(t),this.eventInput=new o,o.setInputHandler(this,this.eventInput),this.eventInput.pipe(this.scrollview)}var o=t("famous/EventHandler"),s=t("famous-views/Scrollview"),r=t("./FeedItem");n.DEFAULT_OPTIONS={widget:r,content:[]},n.prototype.setContent=function(t){this.options.content=t;var e=this.options.widget;this.scrollview.sequenceFrom(t.map(function(t){return new e({content:t})}))},n.prototype.getSize=function(){return this.scrollview.getSize()},n.prototype.setSize=function(t){this.scrollview.setOptions({clipSize:t[1]})},n.prototype.setOptions=function(t){t.widget&&(this.options.widget=t.widget),t.content&&this.setContent(t.content)},n.prototype.render=function(){return this.scrollview.render()},i.exports=n}),define("famous-widgets/IconBar",["require","exports","module","famous/Utility","famous/Surface"],function(t,e,i){var n=t("famous/Utility"),o=t("famous/Surface"),s=n.customizeComponent(o,{classes:["iconBar"],icons:[]});s.prototype.setOptions=function(t){o.prototype.setOptions.call(this,t),t.icons&&(this.options.icons=t.icons)},s.prototype.setContent=function(t){return"string"==typeof t&&(t+='<span class="icon">'+this.options.icons.join("")+"</span>"),o.prototype.setContent.call(this,t)},i.exports=s}),define("famous-widgets/InfoBox",["require","exports","module","famous/EventHandler","famous/Surface"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.surface=new r(this.options.look),t&&this.setOptions(t),s.setInputHandler(this,this.surface),s.setOutputHandler(this,this.surface,!0)}function o(t){for(var e="<ul>",i=0;i<t.length;i++){var n=t[i],o=Object.keys(n)[0];e+='<li><span class="key">'+o+"</span> "+n[o]+"</li>"}return e+="</ul>"}var s=t("famous/EventHandler"),r=t("famous/Surface");n.DEFAULT_OPTIONS={look:{classes:["infoBox"],size:[void 0,!0]},content:[]},n.prototype.setOptions=function(t){void 0!==t.content&&(this.options.content=t.content,this.surface.setContent(o(this.options.content))),void 0!==t.look&&(this.options.look=t.look,this.surface.setOptions(this.options.look))},n.prototype.render=function(){return this.surface.render()},i.exports=n}),define("famous-widgets/NavMenu",["require","exports","module","famous/Utility","famous/EventHandler","famous-views/Scrollview","./ToggleButton","famous/ContainerSurface"],function(t,e,i){function n(t){this.buttons=[],this._buttonIds={},this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this.scrollview=new a({direction:this.options.look.direction,itemSpacing:this.options.look.itemSpacing}),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),r.setInputHandler(this,this.scrollview),this.scrollview.sequenceFrom(this.buttons),this.surface=new c(this.options.look),this.surface.link(this.scrollview),this.surface.pipe(this.scrollview)}function o(t){var e=this.options.sections[t],i=this.options.widget,n=new i;if(this.options.feel&&n.setOptions(this.options.feel),this.options.look){var o=Object.create(this.options.look);o.size=this.options.look.itemSize,n.setOptions(o)}n.setOptions(e),n.on("select",this.select.bind(this,t));var s=this.buttons.length;this.buttons[s]=n,this._buttonIds[t]=s}var s=t("famous/Utility"),r=t("famous/EventHandler"),a=t("famous-views/Scrollview"),u=t("./ToggleButton"),c=t("famous/ContainerSurface");n.DEFAULT_OPTIONS={sections:[],widget:u,look:{size:[200,void 0],direction:s.Direction.X,itemSize:[void 0,50],itemSpacing:10,crossfade:!0},feel:void 0},n.prototype.select=function(t){var e=this._buttonIds[t];this.buttons[e]&&this.buttons[e].isSelected()?this.eventOutput.emit("select",{id:t}):this.buttons[e]&&this.buttons[e].select();for(var i=0;i<this.buttons.length;i++)i!=e&&this.buttons[i].deselect()},n.prototype.setOptions=function(t){if(void 0!==t.widget&&(this.options.widget=t.widget),void 0!==t.look){this.options.look=t.look,this.surface&&this.surface.setOptions(this.options.look);var e=Object.create(this.options.look);e.size=this.options.look.itemSize;for(var i=0;i<this.buttons.length;i++)this.buttons[i].setOptions(e)}if(void 0!==t.feel){this.options.feel=t.feel;for(var i=0;i<this.buttons.length;i++)this.buttons[i].setOptions(this.options.feel)}if(void 0!==t.sections){this.options.sections=t.sections;for(var n in this.options.sections)n in this._buttonIds||o.call(this,n)}},n.prototype.getSize=function(){return this.options.look.size},n.prototype.render=function(){return this.buttons.length?this.surface.render():void 0},i.exports=n}),define("famous-widgets/ScrollContainer",["require","exports","module","famous/ContainerSurface","famous/EventHandler","famous-views/Scrollview","famous/Utility"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.surface=new o(this.options.look),this.scrollview=new r(this.options.feel),t&&this.setOptions(t),this.surface.link(this.scrollview),s.setInputHandler(this,this.surface),s.setOutputHandler(this,this.surface),this.pipe(this.scrollview)}var o=t("famous/ContainerSurface"),s=t("famous/EventHandler"),r=t("famous-views/Scrollview"),a=t("famous/Utility");n.DEFAULT_OPTIONS={look:void 0,feel:{direction:a.Direction.X}},n.prototype.setOptions=function(t){void 0!==t.look&&(this.options.look=t.look,this.surface.setOptions(this.options.look)),void 0!==t.feel&&(this.options.feel=t.feel,this.scrollview.setOptions(this.options.feel))},n.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},n.prototype.render=function(){return this.surface.render.apply(this.surface,arguments)},i.exports=n}),define("famous-widgets/ShrinkContainer",["require","exports","module","famous/ContainerSurface","famous/EventHandler","famous-views/SequentialLayout","famous/Utility"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),this.surface=new s(this.options.look),this.layout=new a(this.options),t&&this.setOptions(t),this.surface.link(this.layout),r.setInputHandler(this,this.surface),r.setOutputHandler(this,this.surface,!0)}function o(){var t=this.layout.getSize(),e=this.surface.getSize(),i=this.surface.context.getSize();if(t&&e&&i){var n=[t[0]+(e[0]-i[0]),t[1]+(e[1]-i[1])];isNaN(n[0])&&(n[0]=void 0),isNaN(n[1])&&(n[1]=void 0),(n[0]!=e[0]||n[1]!=e[1])&&this.surface.setSize.call(this.surface,n)}}{var s=t("famous/ContainerSurface"),r=t("famous/EventHandler"),a=t("famous-views/SequentialLayout");t("famous/Utility")}n.DEFAULT_OPTIONS={look:void 0},n.prototype.getSize=function(){return this.surface.getSize()},n.prototype.setOptions=function(t){this.layout.setOptions(t),void 0!==t.look&&(this.options.look=t.look,this.surface.setOptions(this.options.look))},n.prototype.sequenceFrom=function(){return this.layout.sequenceFrom.apply(this.layout,arguments)},n.prototype.mod=function(){return this.surface.mod.apply(this.surface,arguments)},n.prototype.render=function(){return o.call(this),this.surface.render.apply(this.surface,arguments)},i.exports=n}),define("famous-widgets/Slider",["require","exports","module","famous/Surface","famous/CanvasSurface","famous-sync/GenericSync","famous/Matrix","famous/EventHandler"],function(t,e,i){function n(t){this.options={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,defaultValue:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},t&&this.setOptions(t),this.value=this.options.defaultValue,this.indicator=new r({size:this.options.indicatorSize}),this.indicator.addClass("slider-back"),this.label=new s({size:this.options.labelSize,content:this.options.label,classes:["slider-label"]}),this.label.setProperties({"pointer-events":"none"}),this.eventOutput=new c,this.eventInput=new c,c.setInputHandler(this,this.eventInput),c.setOutputHandler(this,this.eventOutput),this.sync=new a(this.get.bind(this),{scale:(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0],direction:a.DIRECTION_X}),this.eventInput.on("update",function(t){this.set(t.p)}.bind(this)),this.indicator.pipe(this.sync).pipe(this.eventInput),this._drawPos=0,o.call(this)}function o(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var s=t("famous/Surface"),r=t("famous/CanvasSurface"),a=t("famous-sync/GenericSync"),u=t("famous/Matrix"),c=t("famous/EventHandler");n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.size&&(this.options.size=t.size),void 0!==t.indicatorSize&&(this.options.indicatorSize=t.indicatorSize),void 0!==t.labelSize&&(this.options.labelSize=t.labelSize),void 0!==t.range&&(this.options.range=t.range),void 0!==t.precision&&(this.options.precision=t.precision),void 0!==t.defaultValue&&(this.options.defaultValue=t.defaultValue),void 0!==t.label&&(this.options.label=t.label),void 0!==t.fillColor&&(this.options.fillColor=t.fillColor)},n.prototype.get=function(){return this.value},n.prototype.set=function(t){this.value=Math.min(Math.max(this.options.range[0],t),this.options.range[1]),o.call(this),this.eventOutput.emit("change",{value:this.get(),range:this.options.range})},n.prototype.getSize=function(){return this.options.size},n.prototype.render=function(){var t=this.options.range,e=Math.floor((this.get()-t[0])/(t[1]-t[0])*this.options.indicatorSize[0]);if(e<this._drawPos)this.indicator.getContext("2d").clearRect(e,0,this._drawPos-e+1,this.options.indicatorSize[1]);else if(e>this._drawPos){var i=this.indicator.getContext("2d");i.fillStyle=this.options.fillColor,i.fillRect(this._drawPos-1,0,e-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=e,{size:this.options.size,target:[{origin:[.5,0],target:this.indicator.render()},{transform:u.translate(0,0,1),origin:[.5,1],target:this.label.render()}]}},i.exports=n}),define("views/Conversation/ConversationItemView",["require","exports","module","famous/View","app/custom/ConversationSurface","famous/EventHandler","app/models/Contact","app/custom/Templates","famous/Modifier"],function(t,e,i){function n(t){o.call(this),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.surface=new s({properties:{maxWidth:300,zIndex:2}}),this.template(),this.surface.pipe(this.eventOutput),this.mod=new a({transform:void 0}),this._link(this.mode),this._link(this.surface)}var o=t("famous/View"),s=t("app/custom/ConversationSurface"),r=t("famous/EventHandler"),a=(t("app/models/Contact"),t("app/custom/Templates"),t("famous/Modifier"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t=this.model.get("content");"local"==this.model.get("source")?t='<div class="conversation-item triangle-border right">'+t+"</div>":"remote"==this.model.get("source")&&(t='<div class="conversation-item triangle-border left">'+t+"</div>"),this.surface.setContent(t)},i.exports=n}),define("views/Conversation/ConversationView",["require","exports","module","famous/View","famous/Utility","famous-utils/Utils","app/custom/Surface","famous-views/Scrollview","app/models/Conversation","app/models/ConversationCollection","views/conversation/ConversationItemView","famous-views/HeaderFooterLayout","famous/Engine","famous/EventHandler","app/custom/LightBox","famous/Matrix"],function(t,e,i){function n(){o.call(this),this.inputSourceLocal=!0,this.headerFooterLayout=new l({headerSize:0,footerSize:50}),this.inputSurface=new a({size:[void 0,this.headerFooterLayout.footerSize],classes:["conversation-input-bar"],content:'<div><button class="fa fa-comments-o menu-toggle-button fade"></button><button class="fa fa-phone menu-end-button"></button><input type = "text"  class="input-msg" name="message"><button class="send-text-button">Send</button></div>',properties:{backgroundColor:"#000",opacity:.9,zIndex:4}}),this.contentLightBox=new f({inTransform:d.identity,inOpacity:0,inOrigin:[0,0],outTransform:d.identity,outOpacity:0,outOrigin:[0,0],showTransform:d.identity,showOpacity:1,showOrigin:[0,0],inTransition:!0,outTransition:!0,overlap:!1}),this.collection=new c,this.scrollview=new u({direction:s.Direction.Y}),this.headerFooterLayout.id.content.link(this.contentLightBox),this.headerFooterLayout.id.footer.link(this.inputSurface),this.pipe(this.scrollview),this._add(this.headerFooterLayout),this.emptySurface=this.makeEmptySurface(0,this.scrollview.getSize()[1]),this.emptySurface.pipe(this.eventOutput),this.scrollview.sequenceFrom([this.emptySurface]),this.BlueMenuToggleButton=!1,this.collection.on("all",function(t,e){switch(t){case"add":this.addMsg(e)}}.bind(this)),this.inputSurface.on("click",function(t){var e=$(t.target);e.hasClass("send-text-button")?this.addChat():e.hasClass("menu-toggle-button")?(this.toggleMenuToggleButton(this.BlueMenuToggleButton),this.eventOutput.emit("menu-toggle-button",this.BlueMenuToggleButton)):e.hasClass("menu-end-button")?this.eventOutput.emit("end-call",$(".someRandomNull")):"INPUT"==$("input")[0].tagName&&(this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0))}.bind(this)),this.inputSurface.on("keyup",function(t){13==t.keyCode&&this.addChat()}.bind(this));var t,e=function(){this.scrollview.setVelocity(-99),this.loadMsg()};p.on("resize",function(){r.isMobile()||(t&&clearTimeout(t),t=setTimeout(e.bind(this),1e3))}.bind(this)),this.eventInput.on("incomingChat",function(t){this.addRemote(t.content)}.bind(this))}var o=t("famous/View"),s=t("famous/Utility"),r=t("famous-utils/Utils"),a=t("app/custom/Surface"),u=t("famous-views/Scrollview"),c=(t("app/models/Conversation"),t("app/models/ConversationCollection")),h=t("views/conversation/ConversationItemView"),l=t("famous-views/HeaderFooterLayout"),p=t("famous/Engine"),f=(t("famous/EventHandler"),t("app/custom/LightBox")),d=t("famous/Matrix");u.prototype.scrollToEnd=function(){var t=this.node.array.length-1,e=this.node.index,i=this.getSize()[1],n=this.getPosition(),o=this.node.array.map(function(t){return t.getSize()[1]===!0?100:t.getSize()[1]});if(r.isMobile())var s=i+o.sum();else var s=_(o).last(t-e+1).sum()-n-i+100;var a=2*s/200;setTimeout(function(){this.setVelocity(a)}.bind(this),300)},n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.start=function(){},n.prototype.addMsg=function(t){var e=new h({model:t});e.pipe(this.eventOutput),this.scrollview.node.push(e),setTimeout(function(){this.emptySurfaceResize()}.bind(this),100),setTimeout(function(){this.scrollview.scrollToEnd()}.bind(this),100)},n.prototype.loadMsg=function(){var t=this.collection.map(function(t){var e=new h({model:t});return e.pipe(this.eventOutput),e}.bind(this));this.scrollview.sequenceFrom(t),t.unshift(this.emptySurface),setTimeout(function(){this.emptySurfaceResize()}.bind(this),100),setTimeout(function(){this.scrollview.scrollToEnd()}.bind(this),100)},n.prototype.addChat=function(){if(""!=document.getElementsByClassName("input-msg")[0].value){var t=document.getElementsByClassName("input-msg")[0].value;document.getElementsByClassName("input-msg")[0].value="",this.inputSourceLocal?this.addLocal(t):this.addRemote(t)}},n.prototype.addRemote=function(t){var e={content:t,source:"remote",type:"text",time:Date.now()};this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0),this.collection.add(e)},n.prototype.addLocal=function(t){var e={content:t,source:"local",type:"text",time:Date.now()};this.collection.add(e),this.toggleMenuToggleButton(!1),this.eventOutput.emit("menu-toggle-button",!0),this.eventOutput.emit("outgoingChat",e)},n.prototype.makeEmptySurface=function(t,e){var i=new a({size:[void 0,e-t],properties:{background:"transparent"}});return i},n.prototype.emptySurfaceResize=function(){if(!r.isMobile()){var t=this.scrollview.node.array.map(function(t){return t.getSize()[1]});t.shift();var e=_.reduce(t,function(t,e){return t+e},0),i=this.scrollview.getSize()[1]-e;0>i&&(i=0),this.emptySurface.setSize([void 0,i])}},n.prototype.toggleMenuToggleButton=function(t){t===!0?($(".menu-toggle-button").addClass("fade"),$(".menu-end-button").removeClass("toShow"),$(".input-msg").removeClass("short"),this.contentLightBox.hide(),this.BlueMenuToggleButton=!1):($(".menu-toggle-button").removeClass("fade"),$(".menu-end-button").addClass("toShow"),$(".input-msg").addClass("short"),this.contentLightBox._showing||this.contentLightBox.show(this.scrollview),this.BlueMenuToggleButton=!0)},i.exports=n}),define("views/contact/test",["require","exports","module","famous/View","famous/Utility","famous/Surface","famous-views/Scrollview","views/contact/ContactItemView","famous/Matrix","famous-views/HeaderFooterLayout","famous/Utility","famous/ContainerSurface","famous/Modifier"],function(t,e,i){function n(t){o.call(this),this.searchBarSize=30,this.headerFooterLayout=new h({headerSize:30,footerSize:0}),this.searchSurface=new r({size:[void 0,this.searchBarSize],classes:["searchButton"],properties:{backgroundColor:"red",zIndex:2}}),this.abcSurface=new r({size:[20,window.innerHeight-102-this.searchBarSize],classes:["abcButton"],properties:{backgroundColor:"blue",zIndex:2}}),this.abcMod=new l({transform:c.translate(0,30),origin:[1,0]}),this.title='<button class="left edit-button"></button><div>All Contacts</div><button class="right add-contact"><i class="fa fa-plus"></i></button>',this.navigation={caption:"Contacts",icon:'<i class="fa fa-users"></i>'},this.collection=t.collection,this.scrollview=new a({direction:s.Direction.Y,margin:1e4}),this.headerFooterLayout.id.header.link(this.searchSurface),this.headerFooterLayout.id.content.link(this.scrollview),this.pipe(this.scrollview),this._add(this.abcMod).link(this.abcSurface),this._add(this.headerFooterLayout),this.collection.on("all",function(t){switch(t){case"remove":case"sync":this.loadContacts()}}.bind(this))}var o=t("famous/View"),s=t("famous/Utility"),r=t("famous/Surface"),a=t("famous-views/Scrollview"),u=t("views/contact/ContactItemView"),c=t("famous/Matrix"),h=t("famous-views/HeaderFooterLayout"),l=(t("famous/Utility"),t("famous/ContainerSurface"),t("famous/Modifier"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.loadContacts=function(){var t;this.scrollview.sequenceFrom(this.collection.map(function(e){var i=!1;e.get("lastname")&&t!=e.get("lastname")[0].toUpperCase()&&(t=e.get("lastname")[0].toUpperCase(),i=t);var n=new u({model:e},i);return n.pipe(this.eventOutput),n}.bind(this)))},i.exports=n}),define("views/favorite/AddFavoriteView",["require","exports","module","famous-views/HeaderFooterLayout","famous/Surface","famous/EventHandler","famous/Matrix","famous-animation/Easing","app/custom/UpDownTransform"],function(t,e,i){function n(t){o.call(this);var e=new a;void 0===t.inTransform&&(this.options.inTransform=e.options.inTransform),void 0===t.outTransform&&(this.options.outTransform=e.options.outTransform),void 0===t.inTransition&&(this.options.inTransition=e.options.inTransition),void 0===t.outTransition&&(this.options.outTransition=e.options.outTransition),void 0===t.inOpacity&&(this.options.inOpacity=e.options.inOpacity),void 0===t.outOpacity&&(this.options.outOpacity=e.options.outOpacity),this.model=t.model,this.eventInput=new r,r.setInputHandler(this,this.eventInput),this.eventOutput=new r,r.setOutputHandler(this,this.eventOutput),this.header=new s({classes:["header"],size:[void 0,50],properties:{},content:'<button class="left close-button cancel-favorite">Cancel</button><div>Add to Favor</div><button class="right close-button done-favorite">Done</button>'}),this.content=new s({classes:["surface","add-favorite-view"],size:[void 0,void 0],properties:{backgroundColor:"transparent"}}),this.id.header.link(this.header),this.id.content.link(this.content),this.content.on("click",function(){}.bind(this)),this.template(),this.content.pipe(this.eventOutput),this.header.pipe(this.eventOutput),this.header.on("click",function(){target.hasClass("close-button")&&this.eventOutput.emit("showApp")}.bind(this))}var o=t("famous-views/HeaderFooterLayout"),s=t("famous/Surface"),r=t("famous/EventHandler"),a=(t("famous/Matrix"),t("famous-animation/Easing"),t("app/custom/UpDownTransform"));n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.template=function(){var t='<form role="form">';t+='<div class="form-group small">',t+='<input type="text" class="form-control" id="input-first-name" placeholder="First">',t+="</div>",t+='<div class="form-group small">',t+='<input type="text" class="form-control" id="input-last-name" placeholder="Last">',t+="</div>",t+='<div class="form-group">',t+='<input type="email" class="form-control" id="input-email" placeholder="Email">',t+="</div>",t+="</form>",this.content.setContent(t)},i.exports=n}),define("main",["require","exports","module","app/custom/ConversationSurface","app/custom/InComingTransform","app/custom/LightBox","app/custom/MouseSync","app/custom/Surface","app/custom/Templates","app/custom/TouchSync","app/custom/UpDownTransform","app/custom/contactItemWidget","app/models/Call","app/models/CallCollection","app/models/Contact","app/models/ContactCollection","app/models/Conversation","app/models/ConversationCollection","app/models/Settings","app/models/SocialContactCollection","app/App","app/MainController","app/config","famous/CanvasSurface","famous/ContainerSurface","famous/Context","famous/ElementAllocator","famous/Engine","famous/Entity","famous/EventArbiter","famous/EventHandler","famous/Group","famous/ImageSurface","famous/Matrix","famous/Modifier","famous/MultipleTransition","famous/OptionsManager","famous/RenderNode","famous/Scene","famous/SceneCompiler","famous/SpecParser","famous/Surface","famous/Timer","famous/Transitionable","famous/TweenTransition","famous/Utility","famous/VideoSurface","famous/View","famous/ViewSequence","famous/WebGLSurface","famous-animation/Animation","famous-animation/AnimationEngine","famous-animation/CubicBezier","famous-animation/Easing","famous-animation/GenericAnimation","famous-animation/Idle","famous-animation/PiecewiseCubicBezier","famous-animation/RegisterEasing","famous-animation/Sequence","famous-animation/Timer","famous-audio/BufferLoader","famous-audio/SoundPlayer","famous-color/Color","famous-color/ColorPalette","famous-color/ColorPalettes","famous-math/Quaternion","famous-math/Vector","famous-modifiers/Camera","famous-modifiers/Draggable","famous-physics/bodies/Body","famous-physics/bodies/Circle","famous-physics/bodies/Particle","famous-physics/bodies/Rectangle","famous-physics/constraints/Collision","famous-physics/constraints/CollisionJacobian","famous-physics/constraints/Constraint","famous-physics/constraints/Curve","famous-physics/constraints/Distance","famous-physics/constraints/Distance1D","famous-physics/constraints/Rod","famous-physics/constraints/Rope","famous-physics/constraints/StiffSpring","famous-physics/constraints/Surface","famous-physics/constraints/Wall","famous-physics/constraints/Walls","famous-physics/constraints/joint","famous-physics/forces/Drag","famous-physics/forces/Force","famous-physics/forces/Repulsion","famous-physics/forces/Spring","famous-physics/forces/TorqueSpring","famous-physics/forces/VectorField","famous-physics/forces/rotationalDrag","famous-physics/integrator/SymplecticEuler","famous-physics/integrator/verlet","famous-physics/math/GaussSeidel","famous-physics/math/Quaternion","famous-physics/math/Random","famous-physics/math/Vector","famous-physics/math/matrix","famous-physics/utils/PhysicsTransition","famous-physics/utils/PhysicsTransition2","famous-physics/utils/SpringTransition","famous-physics/utils/StiffSpringTransition","famous-physics/utils/WallTransition","famous-physics/PhysicsEngine","famous-sync/FastClick","famous-sync/GenericSync","famous-sync/MouseSync","famous-sync/PinchSync","famous-sync/RotateSync","famous-sync/ScaleSync","famous-sync/ScrollSync","famous-sync/TouchSync","famous-sync/TouchTracker","famous-sync/TwoFingerSync","famous-utils/FormatTime","famous-utils/KeyCodes","famous-utils/NoiseImage","famous-utils/Time","famous-utils/TimeAgo","famous-utils/Utils","famous-views/Accordion","famous-views/ControlSet","famous-views/EnergyHelper","famous-views/Flip","famous-views/LightBox","famous-views/ScrollContainer","famous-views/Scrollview","famous-views/SequentialLayout","famous-views/Shaper","famous-views/Swappable","famous-widgets/FeedItem","famous-widgets/FeedStream","famous-widgets/IconBar","famous-widgets/InfoBox","famous-widgets/NavMenu","famous-widgets/NavigationBar","famous-widgets/ScrollContainer","famous-widgets/ShrinkContainer","famous-widgets/Slider","famous-widgets/TitleBar","famous-widgets/ToggleButton","views/Conversation/ConversationItemView","views/Conversation/ConversationView","views/call/ConnectedCallView","views/call/IncomingCallView","views/call/OutgoingCallView","views/contact/AddContactView","views/contact/ContactItemView","views/contact/ContactsSectionView","views/contact/ImportContactView","views/contact/SocialItemView","views/contact/SocialView","views/contact/test","views/favorite/AddFavoriteView","views/favorite/FavoriteItemView","views/favorite/FavoritesSectionView","views/recent/RecentItemView","views/recent/RecentsSectionView","views/setting/SettingsSectionView","views/AlertView","views/CameraView"],function(t,e,i){var n=function(e){e.call(this,t)};n.App={},n.App.Custom_ConversationSurface=t("app/custom/ConversationSurface"),n.App.Custom_InComingTransform=t("app/custom/InComingTransform"),n.App.Custom_LightBox=t("app/custom/LightBox"),n.App.Custom_MouseSync=t("app/custom/MouseSync"),n.App.Custom_Surface=t("app/custom/Surface"),n.App.Custom_Templates=t("app/custom/Templates"),n.App.Custom_TouchSync=t("app/custom/TouchSync"),n.App.Custom_UpDownTransform=t("app/custom/UpDownTransform"),n.App.Custom_contactItemWidget=t("app/custom/contactItemWidget"),n.App.Models_Call=t("app/models/Call"),n.App.Models_CallCollection=t("app/models/CallCollection"),n.App.Models_Contact=t("app/models/Contact"),n.App.Models_ContactCollection=t("app/models/ContactCollection"),n.App.Models_Conversation=t("app/models/Conversation"),n.App.Models_ConversationCollection=t("app/models/ConversationCollection"),n.App.Models_Settings=t("app/models/Settings"),n.App.Models_SocialContactCollection=t("app/models/SocialContactCollection"),n.App.App=t("app/App"),n.App.MainController=t("app/MainController"),n.App.Config=t("app/config"),n.Famous={},n.Famous.CanvasSurface=t("famous/CanvasSurface"),n.Famous.ContainerSurface=t("famous/ContainerSurface"),n.Famous.Context=t("famous/Context"),n.Famous.ElementAllocator=t("famous/ElementAllocator"),n.Famous.Engine=t("famous/Engine"),n.Famous.Entity=t("famous/Entity"),n.Famous.EventArbiter=t("famous/EventArbiter"),n.Famous.EventHandler=t("famous/EventHandler"),n.Famous.Group=t("famous/Group"),n.Famous.ImageSurface=t("famous/ImageSurface"),n.Famous.Matrix=t("famous/Matrix"),n.Famous.Modifier=t("famous/Modifier"),n.Famous.MultipleTransition=t("famous/MultipleTransition"),n.Famous.OptionsManager=t("famous/OptionsManager"),n.Famous.RenderNode=t("famous/RenderNode"),n.Famous.Scene=t("famous/Scene"),n.Famous.SceneCompiler=t("famous/SceneCompiler"),n.Famous.SpecParser=t("famous/SpecParser"),n.Famous.Surface=t("famous/Surface"),n.Famous.Timer=t("famous/Timer"),n.Famous.Transitionable=t("famous/Transitionable"),n.Famous.TweenTransition=t("famous/TweenTransition"),n.Famous.Utility=t("famous/Utility"),n.Famous.VideoSurface=t("famous/VideoSurface"),n.Famous.View=t("famous/View"),n.Famous.ViewSequence=t("famous/ViewSequence"),n.Famous.WebGLSurface=t("famous/WebGLSurface"),n.FamousAnimation={},n.FamousAnimation.Animation=t("famous-animation/Animation"),n.FamousAnimation.AnimationEngine=t("famous-animation/AnimationEngine"),n.FamousAnimation.CubicBezier=t("famous-animation/CubicBezier"),n.FamousAnimation.Easing=t("famous-animation/Easing"),n.FamousAnimation.GenericAnimation=t("famous-animation/GenericAnimation"),n.FamousAnimation.Idle=t("famous-animation/Idle"),n.FamousAnimation.PiecewiseCubicBezier=t("famous-animation/PiecewiseCubicBezier"),n.FamousAnimation.RegisterEasing=t("famous-animation/RegisterEasing"),n.FamousAnimation.Sequence=t("famous-animation/Sequence"),n.FamousAnimation.Timer=t("famous-animation/Timer"),n.FamousAudio={},n.FamousAudio.BufferLoader=t("famous-audio/BufferLoader"),n.FamousAudio.SoundPlayer=t("famous-audio/SoundPlayer"),n.FamousColor={},n.FamousColor.Color=t("famous-color/Color"),n.FamousColor.ColorPalette=t("famous-color/ColorPalette"),n.FamousColor.ColorPalettes=t("famous-color/ColorPalettes"),n.FamousMath={},n.FamousMath.Quaternion=t("famous-math/Quaternion"),n.FamousMath.Vector=t("famous-math/Vector"),n.FamousModifiers={},n.FamousModifiers.Camera=t("famous-modifiers/Camera"),n.FamousModifiers.Draggable=t("famous-modifiers/Draggable"),n.FamousPhysics={},n.FamousPhysics.Bodies_Body=t("famous-physics/bodies/Body"),n.FamousPhysics.Bodies_Circle=t("famous-physics/bodies/Circle"),n.FamousPhysics.Bodies_Particle=t("famous-physics/bodies/Particle"),n.FamousPhysics.Bodies_Rectangle=t("famous-physics/bodies/Rectangle"),n.FamousPhysics.Constraints_Collision=t("famous-physics/constraints/Collision"),n.FamousPhysics.Constraints_CollisionJacobian=t("famous-physics/constraints/CollisionJacobian"),n.FamousPhysics.Constraints_Constraint=t("famous-physics/constraints/Constraint"),n.FamousPhysics.Constraints_Curve=t("famous-physics/constraints/Curve"),n.FamousPhysics.Constraints_Distance=t("famous-physics/constraints/Distance"),n.FamousPhysics.Constraints_Distance1D=t("famous-physics/constraints/Distance1D"),n.FamousPhysics.Constraints_Rod=t("famous-physics/constraints/Rod"),n.FamousPhysics.Constraints_Rope=t("famous-physics/constraints/Rope"),n.FamousPhysics.Constraints_StiffSpring=t("famous-physics/constraints/StiffSpring"),n.FamousPhysics.Constraints_Surface=t("famous-physics/constraints/Surface"),n.FamousPhysics.Constraints_Wall=t("famous-physics/constraints/Wall"),n.FamousPhysics.Constraints_Walls=t("famous-physics/constraints/Walls"),n.FamousPhysics.Constraints_joint=t("famous-physics/constraints/joint"),n.FamousPhysics.Forces_Drag=t("famous-physics/forces/Drag"),n.FamousPhysics.Forces_Force=t("famous-physics/forces/Force"),n.FamousPhysics.Forces_Repulsion=t("famous-physics/forces/Repulsion"),n.FamousPhysics.Forces_Spring=t("famous-physics/forces/Spring"),n.FamousPhysics.Forces_TorqueSpring=t("famous-physics/forces/TorqueSpring"),n.FamousPhysics.Forces_VectorField=t("famous-physics/forces/VectorField"),n.FamousPhysics.Forces_rotationalDrag=t("famous-physics/forces/rotationalDrag"),n.FamousPhysics.Integrator_SymplecticEuler=t("famous-physics/integrator/SymplecticEuler"),n.FamousPhysics.Integrator_verlet=t("famous-physics/integrator/verlet"),n.FamousPhysics.Math_GaussSeidel=t("famous-physics/math/GaussSeidel"),n.FamousPhysics.Math_Quaternion=t("famous-physics/math/Quaternion"),n.FamousPhysics.Math_Random=t("famous-physics/math/Random"),n.FamousPhysics.Math_Vector=t("famous-physics/math/Vector"),n.FamousPhysics.Math_matrix=t("famous-physics/math/matrix"),n.FamousPhysics.Utils_PhysicsTransition=t("famous-physics/utils/PhysicsTransition"),n.FamousPhysics.Utils_PhysicsTransition2=t("famous-physics/utils/PhysicsTransition2"),n.FamousPhysics.Utils_SpringTransition=t("famous-physics/utils/SpringTransition"),n.FamousPhysics.Utils_StiffSpringTransition=t("famous-physics/utils/StiffSpringTransition"),n.FamousPhysics.Utils_WallTransition=t("famous-physics/utils/WallTransition"),n.FamousPhysics.PhysicsEngine=t("famous-physics/PhysicsEngine"),n.FamousSync={},n.FamousSync.FastClick=t("famous-sync/FastClick"),n.FamousSync.GenericSync=t("famous-sync/GenericSync"),n.FamousSync.MouseSync=t("famous-sync/MouseSync"),n.FamousSync.PinchSync=t("famous-sync/PinchSync"),n.FamousSync.RotateSync=t("famous-sync/RotateSync"),n.FamousSync.ScaleSync=t("famous-sync/ScaleSync"),n.FamousSync.ScrollSync=t("famous-sync/ScrollSync"),n.FamousSync.TouchSync=t("famous-sync/TouchSync"),n.FamousSync.TouchTracker=t("famous-sync/TouchTracker"),n.FamousSync.TwoFingerSync=t("famous-sync/TwoFingerSync"),n.FamousUtils={},n.FamousUtils.FormatTime=t("famous-utils/FormatTime"),n.FamousUtils.KeyCodes=t("famous-utils/KeyCodes"),n.FamousUtils.NoiseImage=t("famous-utils/NoiseImage"),n.FamousUtils.Time=t("famous-utils/Time"),n.FamousUtils.TimeAgo=t("famous-utils/TimeAgo"),n.FamousUtils.Utils=t("famous-utils/Utils"),n.FamousViews={},n.FamousViews.Accordion=t("famous-views/Accordion"),n.FamousViews.ControlSet=t("famous-views/ControlSet"),n.FamousViews.EnergyHelper=t("famous-views/EnergyHelper"),n.FamousViews.Flip=t("famous-views/Flip"),n.FamousViews.LightBox=t("famous-views/LightBox"),n.FamousViews.ScrollContainer=t("famous-views/ScrollContainer"),n.FamousViews.Scrollview=t("famous-views/Scrollview"),n.FamousViews.SequentialLayout=t("famous-views/SequentialLayout"),n.FamousViews.Shaper=t("famous-views/Shaper"),n.FamousViews.Swappable=t("famous-views/Swappable"),n.FamousWidgets={},n.FamousWidgets.FeedItem=t("famous-widgets/FeedItem"),n.FamousWidgets.FeedStream=t("famous-widgets/FeedStream"),n.FamousWidgets.IconBar=t("famous-widgets/IconBar"),n.FamousWidgets.InfoBox=t("famous-widgets/InfoBox"),n.FamousWidgets.NavMenu=t("famous-widgets/NavMenu"),n.FamousWidgets.NavigationBar=t("famous-widgets/NavigationBar"),n.FamousWidgets.ScrollContainer=t("famous-widgets/ScrollContainer"),n.FamousWidgets.ShrinkContainer=t("famous-widgets/ShrinkContainer"),n.FamousWidgets.Slider=t("famous-widgets/Slider"),n.FamousWidgets.TitleBar=t("famous-widgets/TitleBar"),n.FamousWidgets.ToggleButton=t("famous-widgets/ToggleButton"),n.Views={},n.Views.Conversation_ConversationItemView=t("views/Conversation/ConversationItemView"),n.Views.Conversation_ConversationView=t("views/Conversation/ConversationView"),n.Views.Call_ConnectedCallView=t("views/call/ConnectedCallView"),n.Views.Call_IncomingCallView=t("views/call/IncomingCallView"),n.Views.Call_OutgoingCallView=t("views/call/OutgoingCallView"),n.Views.Contact_AddContactView=t("views/contact/AddContactView"),n.Views.Contact_ContactItemView=t("views/contact/ContactItemView"),n.Views.Contact_ContactsSectionView=t("views/contact/ContactsSectionView"),n.Views.Contact_ImportContactView=t("views/contact/ImportContactView"),n.Views.Contact_SocialItemView=t("views/contact/SocialItemView"),n.Views.Contact_SocialView=t("views/contact/SocialView"),n.Views.Contact_test=t("views/contact/test"),n.Views.Favorite_AddFavoriteView=t("views/favorite/AddFavoriteView"),n.Views.Favorite_FavoriteItemView=t("views/favorite/FavoriteItemView"),n.Views.Favorite_FavoritesSectionView=t("views/favorite/FavoritesSectionView"),n.Views.Recent_RecentItemView=t("views/recent/RecentItemView"),n.Views.Recent_RecentsSectionView=t("views/recent/RecentsSectionView"),n.Views.Setting_SettingsSectionView=t("views/setting/SettingsSectionView"),n.Views.AlertView=t("views/AlertView"),n.Views.CameraView=t("views/CameraView"),i.exports=n
}),require(["lib/functionPrototypeBind","lib/classList","lib/requestAnimationFrame","lib/zepto.min","../bower_components/underscore/underscore-min","../bower_components/backbone/backbone-min","../bower_components/handlebars/handlebars.runtime.min","lib/backboneLocalStorage","lib/firebase","lib/backboneFirebase","lib/peer.min","lib/notify","lib/oauthpopup","main"]),require("main")});